import{c as j,r as f,ag as k,ah as N,ai as _,j as t,A as F,m as x,X as C,C as T,ae as M,af as L}from"./index-D-l1rzy_-1765554650217.js";const B=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],D=j("grid-3x3",B);function E({isOpen:l,onClose:s,userId:d,currentUserId:o,type:i,onUserClick:c}){const[m,r]=f.useState([]),[v,g]=f.useState(!0);f.useEffect(()=>{l&&u()},[l,d,i]);const u=async()=>{g(!0);const e=i==="followers"?await k(d,200):await N(d,200),h=await Promise.all(e.map(async n=>{if(n.telegram_id===o)return{...n,isFollowedByMe:!1};const a=await _(o,n.telegram_id);return{...n,isFollowedByMe:a}}));r(h),g(!1)},b=async(e,h)=>{h.stopPropagation(),r(n=>n.map(a=>a.telegram_id===e.telegram_id?{...a,followLoading:!0}:a));try{e.isFollowedByMe?(await M(o,e.telegram_id),r(n=>n.map(a=>a.telegram_id===e.telegram_id?{...a,isFollowedByMe:!1,followLoading:!1}:a))):(await L(o,e.telegram_id),r(n=>n.map(a=>a.telegram_id===e.telegram_id?{...a,isFollowedByMe:!0,followLoading:!1}:a)))}catch(n){console.error("Follow/unfollow error:",n),r(a=>a.map(p=>p.telegram_id===e.telegram_id?{...p,followLoading:!1}:p))}},y=e=>{c&&(c(e),s())};return t.jsx(F,{children:l&&t.jsxs(t.Fragment,{children:[t.jsx(x.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"fixed inset-0 bg-black/70 backdrop-blur-sm z-[100]",onClick:s}),t.jsx(x.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{type:"spring",damping:25,stiffness:350},className:"fixed inset-0 z-[101] flex items-center justify-center p-4",onClick:s,children:t.jsxs("div",{className:"bg-[#1a1a1f] rounded-2xl w-full max-w-md overflow-hidden shadow-2xl border border-white/10",onClick:e=>e.stopPropagation(),children:[t.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b border-white/10",children:[t.jsx("span",{className:"text-lg font-semibold text-white capitalize",children:i}),t.jsx(x.button,{whileTap:{scale:.9},onClick:s,className:"w-9 h-9 flex items-center justify-center rounded-full bg-white/10 hover:bg-white/15 transition-colors",children:t.jsx(C,{className:"w-5 h-5 text-white"})})]}),t.jsx("div",{className:"overflow-y-auto max-h-[70vh] min-h-[200px]",children:v?t.jsx("div",{className:"p-4 space-y-3",children:[1,2,3,4,5].map(e=>t.jsxs("div",{className:"flex items-center gap-3 animate-pulse",children:[t.jsx("div",{className:"w-12 h-12 bg-white/10 rounded-full shrink-0"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"h-4 bg-white/10 rounded w-28 mb-1.5"}),t.jsx("div",{className:"h-3 bg-white/10 rounded w-20"})]}),t.jsx("div",{className:"w-20 h-8 bg-white/10 rounded-lg"})]},e))}):m.length===0?t.jsx("div",{className:"py-20 text-center",children:t.jsx("p",{className:"text-white/40 text-sm",children:i==="followers"?"No followers yet":"Not following anyone"})}):t.jsx("div",{className:"p-3 space-y-1",children:m.map(e=>t.jsxs("div",{className:"w-full flex items-center gap-3 px-3 py-3 rounded-xl hover:bg-white/5 active:bg-white/10 transition-colors cursor-pointer",onClick:()=>y(e),children:[t.jsx("img",{src:e.avatar_url||`https://i.pravatar.cc/150?u=${e.telegram_id}`,alt:e.first_name||"User",className:"w-12 h-12 rounded-full object-cover border border-white/10 shrink-0"}),t.jsxs("div",{className:"flex-1 text-left min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsxs("span",{className:"font-semibold text-white text-[15px] truncate",children:[e.first_name," ",e.last_name]}),e.is_verified&&t.jsx(T,{className:"w-4 h-4 text-blue-400 fill-blue-400 shrink-0"})]}),t.jsx("div",{className:"text-sm text-white/50 truncate",children:e.username?`@${e.username}`:e.is_creator?"Creator":"User"})]}),e.telegram_id!==o&&t.jsx(x.button,{whileTap:{scale:.95},onClick:h=>b(e,h),disabled:e.followLoading,className:`px-4 py-1.5 rounded-lg text-sm font-semibold transition-colors shrink-0 min-w-[90px] ${e.followLoading?"bg-white/10 text-white/50":e.isFollowedByMe?"bg-white/10 text-white hover:bg-white/15":"bg-blue-500 text-white hover:bg-blue-600"}`,children:e.followLoading?t.jsx("span",{className:"inline-block w-4 h-4 border-2 border-white/30 border-t-white/70 rounded-full animate-spin"}):e.isFollowedByMe?"Following":"Follow"})]},e.telegram_id))})})]})})]})})}function z(l){f.useEffect(()=>{if(typeof window>"u"||!l)return;const s=typeof window.requestIdleCallback=="function"?window.requestIdleCallback.bind(window):void 0,d=typeof window.cancelIdleCallback=="function"?window.cancelIdleCallback.bind(window):void 0;let o=!1,i=null,c=null;const m=()=>{if(o)return;const r=new Image;r.src=l};return s?i=s(()=>m()):c=window.setTimeout(m,250),()=>{o=!0,i!==null&&d&&d(i),c!==null&&window.clearTimeout(c)}},[l])}const w={effectiveType:"4g",saveData:!1,downlink:10};function P(){const[l,s]=f.useState(()=>{if(typeof navigator>"u")return w;const i=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return i?{effectiveType:i.effectiveType||w.effectiveType,saveData:i.saveData||!1,downlink:i.downlink||w.downlink}:w});f.useEffect(()=>{const i=navigator?.connection||navigator?.mozConnection||navigator?.webkitConnection;if(!i)return;const c=()=>{s({effectiveType:i.effectiveType||w.effectiveType,saveData:!!i.saveData,downlink:i.downlink||w.downlink})};return i.addEventListener?.("change",c),()=>i.removeEventListener?.("change",c)},[]);const d=l.effectiveType==="slow-2g"||l.effectiveType==="2g",o=l.saveData;return{...l,isSlow:d,isDataSaver:o}}export{E as F,D as G,z as a,P as u};
