import{c as re,r as a,j as e,m as b,M as G,a1 as De,a2 as Fe,a3 as Te,a4 as Ee,a5 as Ue,A as ae,a6 as Ve,a7 as Ie,a8 as Me,a9 as Ae}from"./index-kqTXZbKV-1765577543234.js";import{g as Oe,P as We}from"./PostDetail-CNTnhmVP-1765577543234.js";import{g as Ge,a as ze,b as Be,c as He,s as Qe,d as Xe,f as y,e as Ye,S as oe,G as Ke,F as Ze,u as qe,h as Je}from"./analyticsApi-D_yyqvVb-1765577543234.js";import{u as et}from"./useInViewport-BQ4H17xA-1765577543234.js";import{g as tt,S as st,c as at}from"./storyApi-BscPr8v--1765577543234.js";import{A as lt}from"./arrow-left-SBEw4UTy-1765577543234.js";import{R as it,T as rt,S as ot}from"./trending-up-BFJlA6z1-1765577543234.js";import{E as ne}from"./eye-CyAyecKR-1765577543234.js";import{U as nt}from"./users-CzQQCm4p-1765577543234.js";import{D as ct}from"./dollar-sign-BMLvVRiG-1765577543234.js";import{H as z}from"./heart-D2rxwRwi-1765577543234.js";import{U as ce}from"./user-plus-Fs6tDrz8-1765577543234.js";import{u as dt}from"./useTranslation-nDYEboeG-1765577543234.js";import{S as mt}from"./star-DQ4J3hxv-1765577543234.js";import{C as xt}from"./chevron-down-ArXIGdeG-1765577543234.js";import{L as E}from"./lock-DZQ9rAcr-1765577543234.js";import{R as le}from"./repeat-2-B7VBstr5-1765577543234.js";import{C as ht}from"./chart-column-DDQjCrsT-1765577543234.js";import{V as pt}from"./video-CY-tXc18-1765577543234.js";import{I as ut}from"./image-DLtgogdH-1765577543234.js";import{P as ft}from"./play-BU7c2pFM-1765577543234.js";import"./PixelIcons-B-nYC6h0-1765577543234.js";import"./CommentsSheet-CgGeP6hk-1765577543234.js";import"./loader-circle-DRSHJuPd-1765577543234.js";import"./x-mQahLwGG-1765577543234.js";import"./trash-2-DAweNTbD-1765577543234.js";import"./flag-CsH1vmVm-1765577543234.js";import"./volume-2-DKoYe9d4-1765577543234.js";import"./chevron-left-2NrJeBXU-1765577543234.js";const wt=[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]],ie=re("bookmark",wt);const jt=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],bt=re("menu",jt),gt=({data:t,height:r=60})=>{if(!t.length)return null;const c=Math.max(...t,1),i=Math.min(...t,0),p=c-i||1,l=100,m=t.map((n,u)=>{const j=u/(t.length-1||1)*l,k=r-(n-i)/p*(r-8)-4;return{x:j,y:k,value:n}}),f=m.map((n,u)=>`${u===0?"M":"L"} ${n.x} ${n.y}`).join(" "),w=`${f} L ${l} ${r} L 0 ${r} Z`;return e.jsxs("svg",{viewBox:`0 0 ${l} ${r}`,className:"w-full",style:{height:r},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"chartGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:"white",stopOpacity:"0.15"}),e.jsx("stop",{offset:"100%",stopColor:"white",stopOpacity:"0"})]})}),e.jsx(b.path,{d:w,fill:"url(#chartGradient)",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5}}),e.jsx(b.path,{d:f,fill:"none",stroke:"rgba(255,255,255,0.4)",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:.8,ease:"easeOut"}}),m.map((n,u)=>e.jsx(b.circle,{cx:n.x,cy:n.y,r:"2",fill:"white",initial:{scale:0},animate:{scale:1},transition:{delay:.1*u,duration:.2}},u))]})},Nt=({data:t})=>{if(!t.length)return null;const r=Math.max(...t.map(c=>c.value),1);return e.jsx("div",{className:"flex items-end gap-[3px] h-10",children:t.map((c,i)=>e.jsxs(b.div,{className:"flex-1 flex flex-col items-center",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:i*.05},children:[e.jsx(b.div,{className:"w-full bg-white/30 rounded-[2px]",initial:{height:0},animate:{height:`${c.value/r*100}%`},transition:{delay:i*.05,duration:.3},style:{minHeight:c.value>0?2:0}}),e.jsx("span",{className:"text-[7px] text-white/30 mt-1",children:c.label})]},i))})},U=({icon:t,label:r,value:c,sub:i})=>e.jsxs("div",{className:"bg-white/[0.03] rounded-lg p-2.5 border border-white/[0.04]",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[e.jsx(t,{className:"w-3 h-3 text-white/30"}),e.jsx("span",{className:"text-white/40 text-[10px]",children:r})]}),e.jsx("p",{className:"text-white text-base font-semibold leading-none",children:c}),i&&e.jsx("p",{className:"text-white/25 text-[9px] mt-0.5",children:i})]}),V=({icon:t,label:r,value:c})=>e.jsxs("div",{className:"flex items-center justify-between py-1.5 border-b border-white/[0.03] last:border-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(t,{className:"w-3 h-3 text-white/25"}),e.jsx("span",{className:"text-white/50 text-[11px]",children:r})]}),e.jsx("span",{className:"text-white/80 text-[11px] font-medium",children:c})]}),vt=({visitor:t,onClick:r})=>e.jsxs("button",{onClick:r,className:"flex items-center gap-2 py-1.5 w-full text-left",children:[e.jsx("img",{src:t.avatar_url||`https://ui-avatars.com/api/?name=${t.first_name||"U"}&background=222&color=666&size=24`,alt:"",className:"w-6 h-6 rounded-full object-cover"}),e.jsx("span",{className:"text-white/60 text-[11px] truncate flex-1",children:t.first_name||t.username||"User"}),e.jsx("span",{className:"text-white/25 text-[9px]",children:new Date(t.viewed_at).toLocaleDateString("en",{month:"short",day:"numeric"})})]}),yt=({post:t,rank:r})=>e.jsxs("div",{className:"flex items-center gap-2 py-1.5",children:[e.jsx("span",{className:"text-white/20 text-[10px] w-3",children:r}),e.jsx("div",{className:"w-7 h-7 rounded bg-white/5 overflow-hidden flex-shrink-0",children:t.media_url?e.jsx("img",{src:t.media_url,alt:"",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(G,{className:"w-3 h-3 text-white/15"})})}),e.jsxs("div",{className:"flex-1 flex gap-3 text-[10px]",children:[e.jsxs("span",{className:"text-white/50",children:[e.jsx(z,{className:"w-2.5 h-2.5 inline mr-0.5"}),y(t.like_count)]}),e.jsxs("span",{className:"text-white/50",children:[e.jsx(G,{className:"w-2.5 h-2.5 inline mr-0.5"}),y(t.comment_count)]}),e.jsxs("span",{className:"text-white/50",children:[e.jsx(ne,{className:"w-2.5 h-2.5 inline mr-0.5"}),y(t.view_count||0)]})]})]});function _t({user:t,onClose:r,onCreatorClick:c}){const[i,p]=a.useState(null),[l,m]=a.useState([]),[f,w]=a.useState([]),[n,u]=a.useState([]),[j,k]=a.useState(!0),[C,P]=a.useState(!1),g=a.useCallback(async(o=!1)=>{o?P(!0):k(!0);try{const[x,S,N,A]=await Promise.all([Ge(t.telegram_id),ze(t.telegram_id,7),Be(t.telegram_id,5),He(t.telegram_id,3)]);x&&p(x),m(S),w(N),u(A)}catch(x){console.error("Failed to load analytics:",x)}finally{k(!1),P(!1)}},[t.telegram_id]);a.useEffect(()=>(g(),Qe(t.telegram_id,()=>g(!0))),[g,t.telegram_id]);const L=i?Xe(i.total_likes,i.total_comments,i.total_shares,i.total_followers):0,_=[12,19,8,25,14,30,22],R=["M","T","W","T","F","S","S"],D=l.length>0?l.map(o=>o.views):_,F=l.length>0?l.map(o=>({label:new Date(o.date).toLocaleDateString("en",{weekday:"narrow"}),value:o.views})):R.map((o,x)=>({label:o,value:_[x]}));return e.jsxs(b.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-[#080808] z-50 flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between px-3 pt-14 pb-3",children:[e.jsx("button",{onClick:r,className:"w-8 h-8 rounded-full bg-white/5 flex items-center justify-center",children:e.jsx(lt,{className:"w-4 h-4 text-white/50"})}),e.jsx("span",{className:"text-white/80 text-sm font-medium",children:"Analytics"}),e.jsx("button",{onClick:()=>g(!0),disabled:C,className:"w-8 h-8 rounded-full bg-white/5 flex items-center justify-center",children:e.jsx(it,{className:`w-3.5 h-3.5 text-white/50 ${C?"animate-spin":""}`})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto px-3 pb-6",children:j?e.jsx("div",{className:"flex items-center justify-center h-40",children:e.jsx("div",{className:"w-5 h-5 border-2 border-white/10 border-t-white/40 rounded-full animate-spin"})}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(U,{icon:ne,label:"Views",value:y(i?.total_profile_views||0),sub:`+${i?.views_today||0} today`}),e.jsx(U,{icon:nt,label:"Followers",value:y(i?.total_followers||0),sub:`+${i?.followers_this_week||0} week`}),e.jsx(U,{icon:rt,label:"Engagement",value:`${L.toFixed(1)}%`,sub:"avg rate"}),e.jsx(U,{icon:ct,label:"Earnings",value:Ye(i?.total_earnings||0),sub:"lifetime"})]}),e.jsxs("div",{className:"bg-white/[0.03] rounded-lg p-3 border border-white/[0.04]",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-white/50 text-[11px]",children:"Profile Views"}),e.jsx("span",{className:"text-white/30 text-[10px]",children:"7 days"})]}),e.jsx(gt,{data:D,height:50}),e.jsx("div",{className:"flex justify-between mt-1",children:(l.length>0?l.map(o=>new Date(o.date).toLocaleDateString("en",{weekday:"narrow"})):R).map((o,x)=>e.jsx("span",{className:"text-[8px] text-white/20",children:o},x))})]}),e.jsxs("div",{className:"bg-white/[0.03] rounded-lg p-3 border border-white/[0.04]",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-white/50 text-[11px]",children:"Daily Views"}),e.jsxs("span",{className:"text-white/30 text-[10px]",children:[l.length>0?l.reduce((o,x)=>o+x.views,0):_.reduce((o,x)=>o+x,0)," total"]})]}),e.jsx(Nt,{data:F})]}),e.jsxs("div",{className:"bg-white/[0.03] rounded-lg p-2.5 border border-white/[0.04]",children:[e.jsx("span",{className:"text-white/40 text-[10px] font-medium",children:"Overview"}),e.jsxs("div",{className:"mt-1",children:[e.jsx(V,{icon:z,label:"Likes",value:y(i?.total_likes||0)}),e.jsx(V,{icon:G,label:"Comments",value:y(i?.total_comments||0)}),e.jsx(V,{icon:oe,label:"Shares",value:y(i?.total_shares||0)}),e.jsx(V,{icon:ce,label:"Subscribers",value:i?.total_subscribers||0})]})]}),f.length>0&&e.jsxs("div",{className:"bg-white/[0.03] rounded-lg p-2.5 border border-white/[0.04]",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-white/40 text-[10px] font-medium",children:"Recent Visitors"}),e.jsx("span",{className:"text-white/20 text-[9px]",children:f.length})]}),f.slice(0,4).map(o=>e.jsx(vt,{visitor:o,onClick:()=>c?.({telegram_id:o.viewer_id})},o.viewer_id))]}),n.length>0&&e.jsxs("div",{className:"bg-white/[0.03] rounded-lg p-2.5 border border-white/[0.04]",children:[e.jsx("span",{className:"text-white/40 text-[10px] font-medium",children:"Top Posts"}),e.jsx("div",{className:"mt-1",children:n.map((o,x)=>e.jsx(yt,{post:o,rank:x+1},o.id))})]})]})})]})}function M(t){return t>=1e6?(t/1e6).toFixed(1).replace(/\.0$/,"")+"M":t>=1e3?(t/1e3).toFixed(1).replace(/\.0$/,"")+"K":t.toString()}function ss({user:t,setUser:r,onSettingsClick:c,onViewProfile:i}){const{t:p}=dt(),[l,m]=a.useState("posts"),[f,w]=a.useState([]),[n,u]=a.useState([]),[j,k]=a.useState([]),[C,P]=a.useState(!0),[g,L]=a.useState(!1),[_,R]=a.useState(!1),[D,F]=a.useState(!1),[o,x]=a.useState(!1),[S,N]=a.useState(null),[A,de]=a.useState(null),[me,B]=a.useState(!1),H=a.useRef(null),xe=a.useRef(null),[,Q]=a.useState(!1),[,X]=a.useState(!1),[he,O]=a.useState(!1),[pe,Y]=a.useState("followers"),[ue,T]=a.useState(t.followers_count||0),[fe,we]=a.useState(t.following_count||0),[je,be]=a.useState(t.subscribers_count||0),[$,ge]=a.useState([]),[Ne,W]=a.useState(!1),[ve,K]=a.useState(!1);a.useEffect(()=>{Se(),ye(),J()},[t.telegram_id]);const ye=async()=>{const s=await De(t.telegram_id);T(s.followers),we(s.following)};a.useEffect(()=>{const s=Fe(t.telegram_id,{onNewFollower:()=>T(h=>h+1),onUnfollow:()=>T(h=>Math.max(0,h-1))}),d=Te(t.telegram_id,h=>{T(h.followers_count||0),be(h.subscribers_count||0)});return()=>{s(),d()}},[t.telegram_id]),a.useEffect(()=>{l==="saved"&&(!_&&!g&&Z(),!A&&!me&&_e())},[l]);const _e=async()=>{B(!0);try{const s=await Oe(t.telegram_id);s.wallet&&de(s.wallet)}catch(s){console.error("Failed to load wallet data:",s)}B(!1)},Se=async()=>{P(!0);const d=(await Ee(t.telegram_id,t.telegram_id))?.posts??[];w(d),P(!1)},Z=async()=>{if(!(_||g)){L(!0);try{const s=await Ue();u(s?.posts||[]),R(!0)}catch(s){console.error("[Profile] Failed to load saved posts:",s)}L(!1)}},ke=async()=>{if(!(o||D)){F(!0);try{const s=await Ve(t.telegram_id);k(s),x(!0)}catch(s){console.error("[Profile] Failed to load reposts:",s)}F(!1)}},Ce=()=>{S&&(w(f.filter(s=>s.id!==S.id)),u(n.filter(s=>s.id!==S.id)),N(null),t.is_creator&&r({...t,posts_count:Math.max(0,(t.posts_count||1)-1)}))},Pe=s=>{w(f.map(d=>d.id===s.id?{...s,can_view:!0}:d)),u(n.map(d=>d.id===s.id?{...s,can_view:!0}:d))},$e=()=>{H.current?.click()},Le=async()=>{const s=t.first_name||t.username||"User",d=t.username||`user_${t.telegram_id}`;try{const h=window.Telegram?.WebApp;if(h?.switchInlineQuery){h.switchInlineQuery(`@${d}`,["users","groups","channels"]);return}if(navigator.share){await navigator.share({title:`${s}'s Profile`,text:`Check out @${d} on Veronica!`});return}}catch{}try{await navigator.clipboard.writeText(`@${d}`),alert(p("profile.share.copied"))}catch{alert(p("profile.share.copyError"))}},q=(s,d)=>{const h=s.target.files?.[0];if(!h){s.target.value="";return}if(d==="profile"){(async()=>{X(!0);const v=await Ie(h,t.telegram_id);v.error||!v.url?alert(p("profile.upload.error")):await Me(t.telegram_id,{avatar_url:v.url})?(r({...t,avatar_url:v.url}),alert(p("profile.upload.avatarSuccess"))):alert(p("profile.upload.error")),X(!1),s.target.value=""})();return}(async()=>{Q(!0);const v=await Ae(h,t.telegram_id);if(v.error||!v.url)alert(p("profile.upload.error"));else{const se=h.type.startsWith("video/")?"video":"image",{error:Re}=await at(t.telegram_id,v.url,se);Re?alert(p("profile.upload.error")):(alert(p("profile.upload.storySuccess")),J())}Q(!1),s.target.value=""})()},J=async()=>{try{const{stories:s}=await tt(),d=(s||[]).filter(h=>h.user_id===t.telegram_id);ge(d)}catch(s){console.error("[Profile] loadStories failed",s)}},ee=f.filter(s=>s.visibility==="public"),te=f.filter(s=>s.visibility!=="public");return e.jsxs("div",{className:"bg-black min-h-screen text-white pb-20",children:[e.jsxs("div",{className:"flex items-center justify-between px-3 py-2",children:[e.jsx("button",{className:"p-1.5",children:e.jsx(ce,{className:"w-5 h-5 text-white"})}),$.length>0?e.jsxs("button",{onClick:()=>W(!0),className:"absolute left-1/2 -translate-x-1/2 top-16 bg-white text-black text-[11px] px-2.5 py-1 rounded-full font-medium shadow-lg",style:{transform:"translateX(-50%) translateY(-100%)"},children:["View Stories",e.jsx("div",{className:"absolute bottom-0 left-1/2 -translate-x-1/2 translate-y-full w-0 h-0 border-l-[5px] border-l-transparent border-r-[5px] border-r-transparent border-t-[5px] border-t-white"})]}):null,e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{className:"p-1.5",children:e.jsx(mt,{className:"w-5 h-5 text-white"})}),e.jsx("button",{className:"p-1.5",onClick:Le,children:e.jsx(oe,{className:"w-5 h-5 text-white"})}),e.jsx("button",{className:"p-1.5",onClick:c,children:e.jsx(bt,{className:"w-5 h-5 text-white"})})]})]}),e.jsxs("div",{className:"flex flex-col items-center px-4 pt-1 pb-3",children:[e.jsxs("div",{className:"relative mb-2",children:[e.jsx("div",{className:`w-18 h-18 rounded-full ${$.length>0?"p-[2px] bg-gradient-to-tr from-pink-500 via-red-500 to-yellow-500":""}`,style:{width:"72px",height:"72px"},children:e.jsx("div",{className:`w-full h-full rounded-full ${$.length>0?"p-[2px] bg-black":""}`,children:e.jsx("img",{src:t.avatar_url||`https://i.pravatar.cc/150?u=${t.telegram_id}`,alt:t.first_name,className:"w-full h-full rounded-full object-cover",onClick:()=>$.length>0&&W(!0)})})}),e.jsx("button",{onClick:$e,className:"absolute -bottom-1 left-1/2 -translate-x-1/2 w-5 h-5 bg-[#00D4FF] rounded-full flex items-center justify-center border-2 border-black",children:e.jsx("span",{className:"text-black text-sm font-bold leading-none",children:"+"})})]}),e.jsx("input",{ref:H,type:"file",accept:"image/*",className:"hidden",onChange:s=>q(s,"profile")}),e.jsx("input",{ref:xe,type:"file",accept:"image/*,video/*",className:"hidden",onChange:s=>q(s,"story")}),e.jsx("div",{className:"w-full flex justify-center mb-0.5",children:e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"text-base font-bold tracking-wide",children:t.first_name?.toUpperCase()||"USER"}),e.jsx("button",{onClick:c,className:"absolute -right-6 top-1/2 -translate-y-1/2 p-0.5",children:e.jsx(ot,{className:"w-4 h-4 text-white/70"})})]})}),e.jsxs("span",{className:"text-[12px] text-white/50 mb-3",children:["@",t.username||`user${t.telegram_id}`]}),e.jsxs("div",{className:"flex items-center justify-center gap-0 mb-3",children:[e.jsxs("button",{onClick:()=>{Y("following"),O(!0)},className:"flex flex-col items-center px-4",children:[e.jsx("span",{className:"text-base font-bold",children:M(fe)}),e.jsx("span",{className:"text-[11px] text-white/50",children:"Following"})]}),e.jsx("div",{className:"w-[1px] h-6 bg-white/10"}),e.jsxs("button",{onClick:()=>{Y("followers"),O(!0)},className:"flex flex-col items-center px-4",children:[e.jsx("span",{className:"text-base font-bold",children:M(ue)}),e.jsx("span",{className:"text-[11px] text-white/50",children:"Followers"})]}),e.jsx("div",{className:"w-[1px] h-6 bg-white/10"}),e.jsxs("div",{className:"flex flex-col items-center px-4",children:[e.jsx("span",{className:"text-base font-bold",children:M(je)}),e.jsx("span",{className:"text-[11px] text-white/50",children:"Subscribers"})]})]}),e.jsx("div",{className:"text-center px-6 mb-2",children:e.jsx("p",{className:"text-[13px] text-white/90 whitespace-pre-wrap",children:t.bio||"No bio yet"})})]}),e.jsxs("div",{className:"flex border-b border-white/10",children:[e.jsxs("button",{className:`flex-1 py-3 flex items-center justify-center gap-1 ${l==="posts"?"border-b-2 border-white":""}`,onClick:()=>m("posts"),children:[e.jsx(Ke,{className:`w-5 h-5 ${l==="posts"?"text-white":"text-white/40"}`}),e.jsx(xt,{className:`w-3 h-3 ${l==="posts"?"text-white":"text-white/40"}`})]}),t.is_creator&&e.jsx("button",{className:`flex-1 py-3 flex items-center justify-center ${l==="locked"?"border-b-2 border-white":""}`,onClick:()=>m("locked"),children:e.jsx(E,{className:`w-5 h-5 ${l==="locked"?"text-white":"text-white/40"}`})}),e.jsx("button",{className:`flex-1 py-3 flex items-center justify-center ${l==="reposts"?"border-b-2 border-white":""}`,onClick:()=>{m("reposts"),ke()},children:e.jsx(le,{className:`w-5 h-5 ${l==="reposts"?"text-white":"text-white/40"}`})}),e.jsx("button",{className:`flex-1 py-3 flex items-center justify-center ${l==="saved"?"border-b-2 border-white":""}`,onClick:()=>{m("saved"),Z()},children:e.jsx(ie,{className:`w-5 h-5 ${l==="saved"?"text-white":"text-white/40"}`})}),t.is_creator?e.jsx("button",{className:"flex-1 py-3 flex items-center justify-center",onClick:()=>K(!0),children:e.jsx(ht,{className:"w-5 h-5 text-white/40 hover:text-purple-400 transition-colors"})}):e.jsx("button",{className:`flex-1 py-3 flex items-center justify-center ${l==="liked"?"border-b-2 border-white":""}`,onClick:()=>m("liked"),children:e.jsx(z,{className:`w-5 h-5 ${l==="liked"?"text-white":"text-white/40"}`})})]}),e.jsxs("div",{className:"pb-20",children:[l==="posts"&&(C?e.jsx("div",{className:"grid grid-cols-3 gap-[1px]",children:[1,2,3,4,5,6].map(s=>e.jsx("div",{className:"aspect-[3/4] bg-white/5 animate-pulse"},s))}):ee.length===0?e.jsxs("div",{className:"py-20 text-center",children:[e.jsx("div",{className:"w-20 h-20 rounded-full border border-white/10 flex items-center justify-center mx-auto mb-4",children:e.jsx(pt,{className:"w-8 h-8 text-white/30"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"No posts yet"}),e.jsx("p",{className:"text-sm text-white/50",children:"Your posts will appear here"})]}):e.jsx("div",{className:"grid grid-cols-3 gap-[1px]",children:ee.map(s=>e.jsx(b.div,{className:"relative aspect-[3/4] cursor-pointer overflow-hidden bg-[#1a1a1a]",whileTap:{opacity:.9},onClick:()=>N(s),children:e.jsx(I,{post:s})},s.id))})),l==="locked"&&t.is_creator&&(C?e.jsx("div",{className:"grid grid-cols-3 gap-[1px]",children:[1,2,3].map(s=>e.jsx("div",{className:"aspect-[3/4] bg-white/5 animate-pulse"},s))}):te.length===0?e.jsxs("div",{className:"py-20 text-center",children:[e.jsx("div",{className:"w-20 h-20 rounded-full border border-white/10 flex items-center justify-center mx-auto mb-4",children:e.jsx(E,{className:"w-8 h-8 text-white/30"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"No locked content"}),e.jsx("p",{className:"text-sm text-white/50",children:"Private content will appear here"})]}):e.jsx("div",{className:"grid grid-cols-3 gap-[1px]",children:te.map(s=>e.jsxs(b.div,{className:"relative aspect-[3/4] cursor-pointer overflow-hidden bg-[#1a1a1a]",whileTap:{opacity:.9},onClick:()=>N(s),children:[e.jsx(I,{post:s}),e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx(E,{className:"w-4 h-4 text-white drop-shadow"})})]},s.id))})),l==="reposts"&&(D||!o&&!j.length?e.jsx("div",{className:"grid grid-cols-3 gap-[1px]",children:[1,2,3,4,5,6].map(s=>e.jsx("div",{className:"aspect-[3/4] bg-white/5 animate-pulse"},s))}):j.length===0?e.jsxs("div",{className:"py-20 text-center",children:[e.jsx("div",{className:"w-20 h-20 rounded-full border border-white/10 flex items-center justify-center mx-auto mb-4",children:e.jsx(le,{className:"w-8 h-8 text-white/30"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"No reposts yet"}),e.jsx("p",{className:"text-sm text-white/50",children:"Content you repost will appear here"})]}):e.jsx("div",{className:"grid grid-cols-3 gap-[1px]",children:j.map(s=>e.jsx(b.div,{className:"relative aspect-[3/4] cursor-pointer overflow-hidden bg-[#1a1a1a]",whileTap:{opacity:.9},onClick:()=>N(s),children:e.jsx(I,{post:s})},s.id))})),l==="saved"&&(g||!_&&!n.length?e.jsx("div",{className:"grid grid-cols-3 gap-[1px]",children:[1,2,3,4,5,6].map(s=>e.jsx("div",{className:"aspect-[3/4] bg-white/5 animate-pulse"},s))}):n.length===0?e.jsxs("div",{className:"py-20 text-center",children:[e.jsx("div",{className:"w-20 h-20 rounded-full border border-white/10 flex items-center justify-center mx-auto mb-4",children:e.jsx(ie,{className:"w-8 h-8 text-white/30"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"No saved posts"}),e.jsx("p",{className:"text-sm text-white/50 max-w-xs mx-auto",children:"Save posts to view them later"})]}):e.jsx("div",{className:"grid grid-cols-3 gap-[1px]",children:n.map(s=>e.jsx(b.div,{className:"relative aspect-[3/4] cursor-pointer overflow-hidden bg-[#1a1a1a]",whileTap:{opacity:.9},onClick:()=>N(s),children:e.jsx(I,{post:s})},s.id))})),l==="liked"&&e.jsxs("div",{className:"py-20 text-center",children:[e.jsx("div",{className:"w-20 h-20 rounded-full border border-white/10 flex items-center justify-center mx-auto mb-4",children:e.jsx(E,{className:"w-8 h-8 text-white/30"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Liked posts are private"}),e.jsx("p",{className:"text-sm text-white/50 max-w-xs mx-auto",children:"Only you can see what you've liked"})]})]}),e.jsx(ae,{children:S&&e.jsx(We,{post:S,user:t,onBack:()=>N(null),onDeleted:Ce,onUpdated:Pe})}),Ne&&e.jsx(st,{stories:$,startIndex:0,onClose:()=>W(!1)}),e.jsx(ae,{children:ve&&e.jsx(_t,{user:t,onClose:()=>K(!1),onCreatorClick:i})}),e.jsx(Ze,{isOpen:he,onClose:()=>O(!1),userId:t.telegram_id,currentUserId:t.telegram_id,type:pe,onUserClick:i})]})}const St=/\.(mp4|webm|mov|m4v)(\?|$)/i;function kt(t){return t.media_url?t.media_type&&t.media_type.toLowerCase().includes("video")?!0:St.test(t.media_url):!1}function I({post:t}){const r=a.useRef(null),[c,i]=a.useState(!1),[p,l]=a.useState(!1),[m,f]=a.useState(!1),w=et(r,{minimumRatio:.25}),n=t.media_thumbnail||t.media_url,{isDataSaver:u}=qe();Je(u?null:n);const j=kt(t);return a.useEffect(()=>{w&&i(!0)},[w]),t.media_url?p?e.jsx("div",{ref:r,className:"w-full h-full flex items-center justify-center bg-[#1a1a1a]",children:e.jsx(ut,{className:"w-8 h-8 text-white/20"})}):e.jsxs("div",{ref:r,className:"w-full h-full relative",children:[(!c||!m)&&e.jsx("div",{className:"absolute inset-0 bg-[#1a1a1a] animate-pulse"}),c&&e.jsxs(e.Fragment,{children:[e.jsx("img",{src:n||t.media_url,alt:"",className:`w-full h-full object-cover transition-opacity duration-200 ${m?"opacity-100":"opacity-0"}`,loading:"lazy",onLoad:()=>f(!0),onError:()=>l(!0)}),m&&j&&e.jsx("div",{className:"absolute inset-x-0 bottom-0 h-12 bg-gradient-to-t from-black/60 to-transparent"}),m&&j&&e.jsxs("div",{className:"absolute bottom-1.5 left-1.5 flex items-center gap-0.5",children:[e.jsx(ft,{className:"w-3 h-3 text-white fill-white"}),e.jsx("span",{className:"text-white text-[11px] font-medium",children:M(t.view_count||0)})]}),m&&t.media_urls&&t.media_urls.length>1&&e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx("div",{className:"bg-black/50 rounded px-1.5 py-0.5",children:e.jsx("span",{className:"text-[11px] text-white font-medium",children:t.media_urls.length})})})]})]}):e.jsx("div",{ref:r,className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-purple-900/50 to-pink-900/50 p-4",children:e.jsx("p",{className:"text-[13px] text-white text-center line-clamp-5",children:t.content})})}export{ss as default};
