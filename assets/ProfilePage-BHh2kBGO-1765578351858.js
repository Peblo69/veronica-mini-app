import{c as G,r as a,j as e,m as w,M as J,a1 as qe,a2 as Je,a3 as et,a4 as tt,a5 as st,a6 as be,t as $,a7 as je,A as q,a8 as at,a9 as lt}from"./index-BYJsDqLy-1765578351858.js";import{g as it,P as rt}from"./PostDetail-o4d-oNDS-1765578351858.js";import{g as ot,a as nt,b as ct,c as dt,s as xt,d as mt,f as y,e as ht,S as ye,G as ut,F as pt,u as ft,h as wt}from"./analyticsApi-Bvwdwmzk-1765578351858.js";import{u as bt}from"./useInViewport-BFWvFeAj-1765578351858.js";import{g as jt,S as gt,c as vt}from"./storyApi-Dhbaessb-1765578351858.js";import{A as Nt}from"./arrow-left-4uSuI4xt-1765578351858.js";import{R as yt,T as _t,S as kt}from"./trending-up-BqDj9T_3-1765578351858.js";import{E as _e}from"./eye-C4ZtdHTC-1765578351858.js";import{U as St}from"./users-CgfP2Qzw-1765578351858.js";import{D as Ct}from"./dollar-sign-C9e706Zh-1765578351858.js";import{H as ee}from"./heart-C3FesWSF-1765578351858.js";import{U as ke}from"./user-plus-2ZrKXH5b-1765578351858.js";import{u as Pt}from"./useTranslation-YSsd23cC-1765578351858.js";import{S as $t}from"./star-DeFAHRXR-1765578351858.js";import{C as ge}from"./camera-_W2D3zTh-1765578351858.js";import{C as Rt}from"./chevron-down-CL21w40z-1765578351858.js";import{L as V}from"./lock-Cz6EirAa-1765578351858.js";import{R as ve}from"./repeat-2-BnepUL40-1765578351858.js";import{C as Lt}from"./chart-column-b3yb_4XJ-1765578351858.js";import{V as Dt}from"./video-DRK06zxf-1765578351858.js";import{X as Ft}from"./x-DuWwNxmO-1765578351858.js";import{I as Et}from"./image-o3TPlQY0-1765578351858.js";import{P as At}from"./play-CK1mpCfN-1765578351858.js";import"./PixelIcons-Q_Ixja4X-1765578351858.js";import"./CommentsSheet-BP09sLBN-1765578351858.js";import"./loader-circle-Dh4HF4Ow-1765578351858.js";import"./trash-2-DV8Z0NwH-1765578351858.js";import"./flag-C1K1b9vf-1765578351858.js";import"./volume-2-CFNekxPO-1765578351858.js";import"./chevron-left-BpFVQsUF-1765578351858.js";const Tt=[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]],Ne=G("bookmark",Tt);const Ut=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],Mt=G("menu",Ut);const Vt=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],It=G("zoom-in",Vt);const Ot=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],Wt=G("zoom-out",Ot),zt=({data:t,height:i=60})=>{if(!t.length)return null;const d=Math.max(...t,1),r=Math.min(...t,0),u=d-r||1,l=100,m=t.map((c,p)=>{const j=p/(t.length-1||1)*l,S=i-(c-r)/u*(i-8)-4;return{x:j,y:S,value:c}}),f=m.map((c,p)=>`${p===0?"M":"L"} ${c.x} ${c.y}`).join(" "),b=`${f} L ${l} ${i} L 0 ${i} Z`;return e.jsxs("svg",{viewBox:`0 0 ${l} ${i}`,className:"w-full",style:{height:i},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"chartGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:"white",stopOpacity:"0.15"}),e.jsx("stop",{offset:"100%",stopColor:"white",stopOpacity:"0"})]})}),e.jsx(w.path,{d:b,fill:"url(#chartGradient)",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5}}),e.jsx(w.path,{d:f,fill:"none",stroke:"rgba(255,255,255,0.4)",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:.8,ease:"easeOut"}}),m.map((c,p)=>e.jsx(w.circle,{cx:c.x,cy:c.y,r:"2",fill:"white",initial:{scale:0},animate:{scale:1},transition:{delay:.1*p,duration:.2}},p))]})},Gt=({data:t})=>{if(!t.length)return null;const i=Math.max(...t.map(d=>d.value),1);return e.jsx("div",{className:"flex items-end gap-[3px] h-10",children:t.map((d,r)=>e.jsxs(w.div,{className:"flex-1 flex flex-col items-center",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:r*.05},children:[e.jsx(w.div,{className:"w-full bg-white/30 rounded-[2px]",initial:{height:0},animate:{height:`${d.value/i*100}%`},transition:{delay:r*.05,duration:.3},style:{minHeight:d.value>0?2:0}}),e.jsx("span",{className:"text-[7px] text-white/30 mt-1",children:d.label})]},r))})},I=({icon:t,label:i,value:d,sub:r})=>e.jsxs("div",{className:"bg-white/[0.03] rounded-lg p-2.5 border border-white/[0.04]",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[e.jsx(t,{className:"w-3 h-3 text-white/30"}),e.jsx("span",{className:"text-white/40 text-[10px]",children:i})]}),e.jsx("p",{className:"text-white text-base font-semibold leading-none",children:d}),r&&e.jsx("p",{className:"text-white/25 text-[9px] mt-0.5",children:r})]}),O=({icon:t,label:i,value:d})=>e.jsxs("div",{className:"flex items-center justify-between py-1.5 border-b border-white/[0.03] last:border-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(t,{className:"w-3 h-3 text-white/25"}),e.jsx("span",{className:"text-white/50 text-[11px]",children:i})]}),e.jsx("span",{className:"text-white/80 text-[11px] font-medium",children:d})]}),Zt=({visitor:t,onClick:i})=>e.jsxs("button",{onClick:i,className:"flex items-center gap-2 py-1.5 w-full text-left",children:[e.jsx("img",{src:t.avatar_url||`https://ui-avatars.com/api/?name=${t.first_name||"U"}&background=222&color=666&size=24`,alt:"",className:"w-6 h-6 rounded-full object-cover"}),e.jsx("span",{className:"text-white/60 text-[11px] truncate flex-1",children:t.first_name||t.username||"User"}),e.jsx("span",{className:"text-white/25 text-[9px]",children:new Date(t.viewed_at).toLocaleDateString("en",{month:"short",day:"numeric"})})]}),Bt=({post:t,rank:i})=>e.jsxs("div",{className:"flex items-center gap-2 py-1.5",children:[e.jsx("span",{className:"text-white/20 text-[10px] w-3",children:i}),e.jsx("div",{className:"w-7 h-7 rounded bg-white/5 overflow-hidden flex-shrink-0",children:t.media_url?e.jsx("img",{src:t.media_url,alt:"",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(J,{className:"w-3 h-3 text-white/15"})})}),e.jsxs("div",{className:"flex-1 flex gap-3 text-[10px]",children:[e.jsxs("span",{className:"text-white/50",children:[e.jsx(ee,{className:"w-2.5 h-2.5 inline mr-0.5"}),y(t.like_count)]}),e.jsxs("span",{className:"text-white/50",children:[e.jsx(J,{className:"w-2.5 h-2.5 inline mr-0.5"}),y(t.comment_count)]}),e.jsxs("span",{className:"text-white/50",children:[e.jsx(_e,{className:"w-2.5 h-2.5 inline mr-0.5"}),y(t.view_count||0)]})]})]});function Ht({user:t,onClose:i,onCreatorClick:d}){const[r,u]=a.useState(null),[l,m]=a.useState([]),[f,b]=a.useState([]),[c,p]=a.useState([]),[j,S]=a.useState(!0),[C,P]=a.useState(!1),g=a.useCallback(async(o=!1)=>{o?P(!0):S(!0);try{const[h,k,v,Z]=await Promise.all([ot(t.telegram_id),nt(t.telegram_id,7),ct(t.telegram_id,5),dt(t.telegram_id,3)]);h&&u(h),m(k),b(v),p(Z)}catch(h){console.error("Failed to load analytics:",h)}finally{S(!1),P(!1)}},[t.telegram_id]);a.useEffect(()=>(g(),xt(t.telegram_id,()=>g(!0))),[g,t.telegram_id]);const R=r?mt(r.total_likes,r.total_comments,r.total_shares,r.total_followers):0,_=[12,19,8,25,14,30,22],L=["M","T","W","T","F","S","S"],D=l.length>0?l.map(o=>o.views):_,F=l.length>0?l.map(o=>({label:new Date(o.date).toLocaleDateString("en",{weekday:"narrow"}),value:o.views})):L.map((o,h)=>({label:o,value:_[h]}));return e.jsxs(w.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-[#080808] z-50 flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between px-3 pt-14 pb-3",children:[e.jsx("button",{onClick:i,className:"w-8 h-8 rounded-full bg-white/5 flex items-center justify-center",children:e.jsx(Nt,{className:"w-4 h-4 text-white/50"})}),e.jsx("span",{className:"text-white/80 text-sm font-medium",children:"Analytics"}),e.jsx("button",{onClick:()=>g(!0),disabled:C,className:"w-8 h-8 rounded-full bg-white/5 flex items-center justify-center",children:e.jsx(yt,{className:`w-3.5 h-3.5 text-white/50 ${C?"animate-spin":""}`})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto px-3 pb-6",children:j?e.jsx("div",{className:"flex items-center justify-center h-40",children:e.jsx("div",{className:"w-5 h-5 border-2 border-white/10 border-t-white/40 rounded-full animate-spin"})}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(I,{icon:_e,label:"Views",value:y(r?.total_profile_views||0),sub:`+${r?.views_today||0} today`}),e.jsx(I,{icon:St,label:"Followers",value:y(r?.total_followers||0),sub:`+${r?.followers_this_week||0} week`}),e.jsx(I,{icon:_t,label:"Engagement",value:`${R.toFixed(1)}%`,sub:"avg rate"}),e.jsx(I,{icon:Ct,label:"Earnings",value:ht(r?.total_earnings||0),sub:"lifetime"})]}),e.jsxs("div",{className:"bg-white/[0.03] rounded-lg p-3 border border-white/[0.04]",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-white/50 text-[11px]",children:"Profile Views"}),e.jsx("span",{className:"text-white/30 text-[10px]",children:"7 days"})]}),e.jsx(zt,{data:D,height:50}),e.jsx("div",{className:"flex justify-between mt-1",children:(l.length>0?l.map(o=>new Date(o.date).toLocaleDateString("en",{weekday:"narrow"})):L).map((o,h)=>e.jsx("span",{className:"text-[8px] text-white/20",children:o},h))})]}),e.jsxs("div",{className:"bg-white/[0.03] rounded-lg p-3 border border-white/[0.04]",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-white/50 text-[11px]",children:"Daily Views"}),e.jsxs("span",{className:"text-white/30 text-[10px]",children:[l.length>0?l.reduce((o,h)=>o+h.views,0):_.reduce((o,h)=>o+h,0)," total"]})]}),e.jsx(Gt,{data:F})]}),e.jsxs("div",{className:"bg-white/[0.03] rounded-lg p-2.5 border border-white/[0.04]",children:[e.jsx("span",{className:"text-white/40 text-[10px] font-medium",children:"Overview"}),e.jsxs("div",{className:"mt-1",children:[e.jsx(O,{icon:ee,label:"Likes",value:y(r?.total_likes||0)}),e.jsx(O,{icon:J,label:"Comments",value:y(r?.total_comments||0)}),e.jsx(O,{icon:ye,label:"Shares",value:y(r?.total_shares||0)}),e.jsx(O,{icon:ke,label:"Subscribers",value:r?.total_subscribers||0})]})]}),f.length>0&&e.jsxs("div",{className:"bg-white/[0.03] rounded-lg p-2.5 border border-white/[0.04]",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-white/40 text-[10px] font-medium",children:"Recent Visitors"}),e.jsx("span",{className:"text-white/20 text-[9px]",children:f.length})]}),f.slice(0,4).map(o=>e.jsx(Zt,{visitor:o,onClick:()=>d?.({telegram_id:o.viewer_id})},o.viewer_id))]}),c.length>0&&e.jsxs("div",{className:"bg-white/[0.03] rounded-lg p-2.5 border border-white/[0.04]",children:[e.jsx("span",{className:"text-white/40 text-[10px] font-medium",children:"Top Posts"}),e.jsx("div",{className:"mt-1",children:c.map((o,h)=>e.jsx(Bt,{post:o,rank:h+1},o.id))})]})]})})]})}function z(t){return t>=1e6?(t/1e6).toFixed(1).replace(/\.0$/,"")+"M":t>=1e3?(t/1e3).toFixed(1).replace(/\.0$/,"")+"K":t.toString()}function Ss({user:t,setUser:i,onSettingsClick:d,onViewProfile:r}){const{t:u}=Pt(),[l,m]=a.useState("posts"),[f,b]=a.useState([]),[c,p]=a.useState([]),[j,S]=a.useState([]),[C,P]=a.useState(!0),[g,R]=a.useState(!1),[_,L]=a.useState(!1),[D,F]=a.useState(!1),[o,h]=a.useState(!1),[k,v]=a.useState(null),[Z,Se]=a.useState(null),[Ce,te]=a.useState(!1),Pe=a.useRef(null),$e=a.useRef(null),[,se]=a.useState(!1),[,ae]=a.useState(!1),[Re,B]=a.useState(!1),[Le,le]=a.useState("followers"),[De,E]=a.useState(t.followers_count||0),[Fe,Ee]=a.useState(t.following_count||0),[Ae,Te]=a.useState(t.subscribers_count||0),[A,Ue]=a.useState([]),[Me,ie]=a.useState(!1),[Ve,re]=a.useState(!1),[Ie,oe]=a.useState(!1),[T,ne]=a.useState(null),[H,ce]=a.useState(null),[de,Q]=a.useState(1),[U,X]=a.useState({x:0,y:0}),[M,Y]=a.useState(!1),xe=a.useRef(null);a.useEffect(()=>{ze(),Oe(),ue()},[t.telegram_id]);const Oe=async()=>{const s=await qe(t.telegram_id);E(s.followers),Ee(s.following)};a.useEffect(()=>{const s=Je(t.telegram_id,{onNewFollower:()=>E(x=>x+1),onUnfollow:()=>E(x=>Math.max(0,x-1))}),n=et(t.telegram_id,x=>{E(x.followers_count||0),Te(x.subscribers_count||0)});return()=>{s(),n()}},[t.telegram_id]),a.useEffect(()=>{l==="saved"&&(!_&&!g&&me(),!Z&&!Ce&&We())},[l]);const We=async()=>{te(!0);try{const s=await it(t.telegram_id);s.wallet&&Se(s.wallet)}catch(s){console.error("Failed to load wallet data:",s)}te(!1)},ze=async()=>{P(!0);const n=(await tt(t.telegram_id,t.telegram_id))?.posts??[];b(n),P(!1)},me=async()=>{if(!(_||g)){R(!0);try{const s=await st();p(s?.posts||[]),L(!0)}catch(s){console.error("[Profile] Failed to load saved posts:",s)}R(!1)}},Ge=async()=>{if(!(o||D)){F(!0);try{const s=await at(t.telegram_id);S(s),h(!0)}catch(s){console.error("[Profile] Failed to load reposts:",s)}F(!1)}},Ze=()=>{k&&(b(f.filter(s=>s.id!==k.id)),p(c.filter(s=>s.id!==k.id)),v(null),t.is_creator&&i({...t,posts_count:Math.max(0,(t.posts_count||1)-1)}))},Be=s=>{b(f.map(n=>n.id===s.id?{...s,can_view:!0}:n)),p(c.map(n=>n.id===s.id?{...s,can_view:!0}:n))},He=()=>{xe.current?.click()},Qe=s=>{const n=s.target.files?.[0];if(!n)return;if(!n.type.startsWith("image/")){$.error("Please select an image file");return}const x=URL.createObjectURL(n);ce(n),ne(x),Q(1),X({x:0,y:0}),oe(!0),s.target.value=""},K=()=>{oe(!1),T&&URL.revokeObjectURL(T),ne(null),ce(null),Q(1),X({x:0,y:0})},Xe=a.useCallback(async()=>{if(H){Y(!0);try{const s=await be(H,t.telegram_id);if(s.error||!s.url){$.error("Failed to upload image"),Y(!1);return}await je(t.telegram_id,{avatar_url:s.url})?(i({...t,avatar_url:s.url}),$.success("Profile photo updated!"),K()):$.error("Failed to save profile photo")}catch(s){console.error("Avatar save error:",s),$.error("Something went wrong")}Y(!1)}},[H,t,i]),Ye=async()=>{const s=t.first_name||t.username||"User",n=t.username||`user_${t.telegram_id}`;try{const x=window.Telegram?.WebApp;if(x?.switchInlineQuery){x.switchInlineQuery(`@${n}`,["users","groups","channels"]);return}if(navigator.share){await navigator.share({title:`${s}'s Profile`,text:`Check out @${n} on Veronica!`});return}}catch{}try{await navigator.clipboard.writeText(`@${n}`),alert(u("profile.share.copied"))}catch{alert(u("profile.share.copyError"))}},he=(s,n)=>{const x=s.target.files?.[0];if(!x){s.target.value="";return}if(n==="profile"){(async()=>{ae(!0);const N=await be(x,t.telegram_id);N.error||!N.url?alert(u("profile.upload.error")):await je(t.telegram_id,{avatar_url:N.url})?(i({...t,avatar_url:N.url}),alert(u("profile.upload.avatarSuccess"))):alert(u("profile.upload.error")),ae(!1),s.target.value=""})();return}(async()=>{se(!0);const N=await lt(x,t.telegram_id);if(N.error||!N.url)alert(u("profile.upload.error"));else{const we=x.type.startsWith("video/")?"video":"image",{error:Ke}=await vt(t.telegram_id,N.url,we);Ke?alert(u("profile.upload.error")):(alert(u("profile.upload.storySuccess")),ue())}se(!1),s.target.value=""})()},ue=async()=>{try{const{stories:s}=await jt(),n=(s||[]).filter(x=>x.user_id===t.telegram_id);Ue(n)}catch(s){console.error("[Profile] loadStories failed",s)}},pe=f.filter(s=>s.visibility==="public"),fe=f.filter(s=>s.visibility!=="public");return e.jsxs("div",{className:"bg-black min-h-screen text-white pb-20",children:[e.jsxs("div",{className:"flex items-center justify-between px-3 py-2",children:[e.jsx("button",{className:"p-1.5",children:e.jsx(ke,{className:"w-5 h-5 text-white"})}),A.length>0?e.jsxs("button",{onClick:()=>ie(!0),className:"absolute left-1/2 -translate-x-1/2 top-16 bg-white text-black text-[11px] px-2.5 py-1 rounded-full font-medium shadow-lg",style:{transform:"translateX(-50%) translateY(-100%)"},children:["View Stories",e.jsx("div",{className:"absolute bottom-0 left-1/2 -translate-x-1/2 translate-y-full w-0 h-0 border-l-[5px] border-l-transparent border-r-[5px] border-r-transparent border-t-[5px] border-t-white"})]}):null,e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{className:"p-1.5",children:e.jsx($t,{className:"w-5 h-5 text-white"})}),e.jsx("button",{className:"p-1.5",onClick:Ye,children:e.jsx(ye,{className:"w-5 h-5 text-white"})}),e.jsx("button",{className:"p-1.5",onClick:d,children:e.jsx(Mt,{className:"w-5 h-5 text-white"})})]})]}),e.jsxs("div",{className:"flex flex-col items-center px-4 pt-1 pb-3",children:[e.jsxs("div",{className:"relative mb-2",children:[e.jsxs("button",{onClick:He,className:`w-18 h-18 rounded-full ${A.length>0?"p-[2px] bg-gradient-to-tr from-pink-500 via-red-500 to-yellow-500":""} relative group`,style:{width:"72px",height:"72px"},children:[e.jsx("div",{className:`w-full h-full rounded-full ${A.length>0?"p-[2px] bg-black":""}`,children:e.jsx("img",{src:t.avatar_url||`https://i.pravatar.cc/150?u=${t.telegram_id}`,alt:t.first_name,className:"w-full h-full rounded-full object-cover"})}),e.jsx("div",{className:"absolute inset-0 rounded-full bg-black/40 flex items-center justify-center opacity-0 group-active:opacity-100 transition-opacity",children:e.jsx(ge,{className:"w-5 h-5 text-white"})})]}),e.jsx("div",{className:"absolute -bottom-1 left-1/2 -translate-x-1/2 w-5 h-5 bg-[#00D4FF] rounded-full flex items-center justify-center border-2 border-black",children:e.jsx(ge,{className:"w-2.5 h-2.5 text-black"})})]}),e.jsx("input",{ref:Pe,type:"file",accept:"image/*",className:"hidden",onChange:s=>he(s,"profile")}),e.jsx("input",{ref:$e,type:"file",accept:"image/*,video/*",className:"hidden",onChange:s=>he(s,"story")}),e.jsx("input",{ref:xe,type:"file",accept:"image/*",className:"hidden",onChange:Qe}),e.jsx("div",{className:"w-full flex justify-center mb-0.5",children:e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"text-base font-bold tracking-wide",children:t.first_name?.toUpperCase()||"USER"}),e.jsx("button",{onClick:d,className:"absolute -right-6 top-1/2 -translate-y-1/2 p-0.5",children:e.jsx(kt,{className:"w-4 h-4 text-white/70"})})]})}),e.jsxs("span",{className:"text-[12px] text-white/50 mb-3",children:["@",t.username||`user${t.telegram_id}`]}),e.jsxs("div",{className:"flex items-center justify-center gap-0 mb-3",children:[e.jsxs("button",{onClick:()=>{le("following"),B(!0)},className:"flex flex-col items-center px-4",children:[e.jsx("span",{className:"text-base font-bold",children:z(Fe)}),e.jsx("span",{className:"text-[11px] text-white/50",children:"Following"})]}),e.jsx("div",{className:"w-[1px] h-6 bg-white/10"}),e.jsxs("button",{onClick:()=>{le("followers"),B(!0)},className:"flex flex-col items-center px-4",children:[e.jsx("span",{className:"text-base font-bold",children:z(De)}),e.jsx("span",{className:"text-[11px] text-white/50",children:"Followers"})]}),e.jsx("div",{className:"w-[1px] h-6 bg-white/10"}),e.jsxs("div",{className:"flex flex-col items-center px-4",children:[e.jsx("span",{className:"text-base font-bold",children:z(Ae)}),e.jsx("span",{className:"text-[11px] text-white/50",children:"Subscribers"})]})]}),e.jsx("div",{className:"text-center px-6 mb-2",children:e.jsx("p",{className:"text-[13px] text-white/90 whitespace-pre-wrap",children:t.bio||"No bio yet"})})]}),e.jsxs("div",{className:"flex border-b border-white/10",children:[e.jsxs("button",{className:`flex-1 py-3 flex items-center justify-center gap-1 ${l==="posts"?"border-b-2 border-white":""}`,onClick:()=>m("posts"),children:[e.jsx(ut,{className:`w-5 h-5 ${l==="posts"?"text-white":"text-white/40"}`}),e.jsx(Rt,{className:`w-3 h-3 ${l==="posts"?"text-white":"text-white/40"}`})]}),t.is_creator&&e.jsx("button",{className:`flex-1 py-3 flex items-center justify-center ${l==="locked"?"border-b-2 border-white":""}`,onClick:()=>m("locked"),children:e.jsx(V,{className:`w-5 h-5 ${l==="locked"?"text-white":"text-white/40"}`})}),e.jsx("button",{className:`flex-1 py-3 flex items-center justify-center ${l==="reposts"?"border-b-2 border-white":""}`,onClick:()=>{m("reposts"),Ge()},children:e.jsx(ve,{className:`w-5 h-5 ${l==="reposts"?"text-white":"text-white/40"}`})}),e.jsx("button",{className:`flex-1 py-3 flex items-center justify-center ${l==="saved"?"border-b-2 border-white":""}`,onClick:()=>{m("saved"),me()},children:e.jsx(Ne,{className:`w-5 h-5 ${l==="saved"?"text-white":"text-white/40"}`})}),t.is_creator?e.jsx("button",{className:"flex-1 py-3 flex items-center justify-center",onClick:()=>re(!0),children:e.jsx(Lt,{className:"w-5 h-5 text-white/40 hover:text-purple-400 transition-colors"})}):e.jsx("button",{className:`flex-1 py-3 flex items-center justify-center ${l==="liked"?"border-b-2 border-white":""}`,onClick:()=>m("liked"),children:e.jsx(ee,{className:`w-5 h-5 ${l==="liked"?"text-white":"text-white/40"}`})})]}),e.jsxs("div",{className:"pb-20",children:[l==="posts"&&(C?e.jsx("div",{className:"grid grid-cols-3 gap-[1px]",children:[1,2,3,4,5,6].map(s=>e.jsx("div",{className:"aspect-[3/4] bg-white/5 animate-pulse"},s))}):pe.length===0?e.jsxs("div",{className:"py-20 text-center",children:[e.jsx("div",{className:"w-20 h-20 rounded-full border border-white/10 flex items-center justify-center mx-auto mb-4",children:e.jsx(Dt,{className:"w-8 h-8 text-white/30"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"No posts yet"}),e.jsx("p",{className:"text-sm text-white/50",children:"Your posts will appear here"})]}):e.jsx("div",{className:"grid grid-cols-3 gap-[1px]",children:pe.map(s=>e.jsx(w.div,{className:"relative aspect-[3/4] cursor-pointer overflow-hidden bg-[#1a1a1a]",whileTap:{opacity:.9},onClick:()=>v(s),children:e.jsx(W,{post:s})},s.id))})),l==="locked"&&t.is_creator&&(C?e.jsx("div",{className:"grid grid-cols-3 gap-[1px]",children:[1,2,3].map(s=>e.jsx("div",{className:"aspect-[3/4] bg-white/5 animate-pulse"},s))}):fe.length===0?e.jsxs("div",{className:"py-20 text-center",children:[e.jsx("div",{className:"w-20 h-20 rounded-full border border-white/10 flex items-center justify-center mx-auto mb-4",children:e.jsx(V,{className:"w-8 h-8 text-white/30"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"No locked content"}),e.jsx("p",{className:"text-sm text-white/50",children:"Private content will appear here"})]}):e.jsx("div",{className:"grid grid-cols-3 gap-[1px]",children:fe.map(s=>e.jsxs(w.div,{className:"relative aspect-[3/4] cursor-pointer overflow-hidden bg-[#1a1a1a]",whileTap:{opacity:.9},onClick:()=>v(s),children:[e.jsx(W,{post:s}),e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx(V,{className:"w-4 h-4 text-white drop-shadow"})})]},s.id))})),l==="reposts"&&(D||!o&&!j.length?e.jsx("div",{className:"grid grid-cols-3 gap-[1px]",children:[1,2,3,4,5,6].map(s=>e.jsx("div",{className:"aspect-[3/4] bg-white/5 animate-pulse"},s))}):j.length===0?e.jsxs("div",{className:"py-20 text-center",children:[e.jsx("div",{className:"w-20 h-20 rounded-full border border-white/10 flex items-center justify-center mx-auto mb-4",children:e.jsx(ve,{className:"w-8 h-8 text-white/30"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"No reposts yet"}),e.jsx("p",{className:"text-sm text-white/50",children:"Content you repost will appear here"})]}):e.jsx("div",{className:"grid grid-cols-3 gap-[1px]",children:j.map(s=>e.jsx(w.div,{className:"relative aspect-[3/4] cursor-pointer overflow-hidden bg-[#1a1a1a]",whileTap:{opacity:.9},onClick:()=>v(s),children:e.jsx(W,{post:s})},s.id))})),l==="saved"&&(g||!_&&!c.length?e.jsx("div",{className:"grid grid-cols-3 gap-[1px]",children:[1,2,3,4,5,6].map(s=>e.jsx("div",{className:"aspect-[3/4] bg-white/5 animate-pulse"},s))}):c.length===0?e.jsxs("div",{className:"py-20 text-center",children:[e.jsx("div",{className:"w-20 h-20 rounded-full border border-white/10 flex items-center justify-center mx-auto mb-4",children:e.jsx(Ne,{className:"w-8 h-8 text-white/30"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"No saved posts"}),e.jsx("p",{className:"text-sm text-white/50 max-w-xs mx-auto",children:"Save posts to view them later"})]}):e.jsx("div",{className:"grid grid-cols-3 gap-[1px]",children:c.map(s=>e.jsx(w.div,{className:"relative aspect-[3/4] cursor-pointer overflow-hidden bg-[#1a1a1a]",whileTap:{opacity:.9},onClick:()=>v(s),children:e.jsx(W,{post:s})},s.id))})),l==="liked"&&e.jsxs("div",{className:"py-20 text-center",children:[e.jsx("div",{className:"w-20 h-20 rounded-full border border-white/10 flex items-center justify-center mx-auto mb-4",children:e.jsx(V,{className:"w-8 h-8 text-white/30"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Liked posts are private"}),e.jsx("p",{className:"text-sm text-white/50 max-w-xs mx-auto",children:"Only you can see what you've liked"})]})]}),e.jsx(q,{children:k&&e.jsx(rt,{post:k,user:t,onBack:()=>v(null),onDeleted:Ze,onUpdated:Be})}),Me&&e.jsx(gt,{stories:A,startIndex:0,onClose:()=>ie(!1)}),e.jsx(q,{children:Ve&&e.jsx(Ht,{user:t,onClose:()=>re(!1),onCreatorClick:r})}),e.jsx(pt,{isOpen:Re,onClose:()=>B(!1),userId:t.telegram_id,currentUserId:t.telegram_id,type:Le,onUserClick:r}),e.jsx(q,{children:Ie&&T&&e.jsxs(w.div,{className:"fixed inset-0 bg-black z-[100] flex flex-col",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-white/10",children:[e.jsx("button",{onClick:K,disabled:M,className:"p-2 -m-2 text-white/70 hover:text-white transition-colors",children:e.jsx(Ft,{className:"w-6 h-6"})}),e.jsx("span",{className:"text-white font-semibold text-base",children:"Edit Photo"}),e.jsx("button",{onClick:Xe,disabled:M,className:"px-4 py-1.5 bg-[#00D4FF] rounded-full text-black font-semibold text-sm disabled:opacity-50",children:M?e.jsx("div",{className:"w-4 h-4 border-2 border-black/30 border-t-black rounded-full animate-spin"}):"Save"})]}),e.jsx("div",{className:"flex-1 flex items-center justify-center p-8",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"relative overflow-hidden rounded-full border-2 border-white/20",style:{width:"280px",height:"280px"},children:e.jsx(w.img,{src:T,alt:"Preview",className:"absolute w-full h-full object-cover",style:{scale:de,x:U.x,y:U.y},drag:!0,dragConstraints:{left:-50,right:50,top:-50,bottom:50},dragElastic:.1,onDragEnd:(s,n)=>{X({x:Math.max(-50,Math.min(50,U.x+n.offset.x)),y:Math.max(-50,Math.min(50,U.y+n.offset.y))})}})}),e.jsx("div",{className:"absolute -top-1 -left-1 w-4 h-4 border-l-2 border-t-2 border-white/40 rounded-tl-lg"}),e.jsx("div",{className:"absolute -top-1 -right-1 w-4 h-4 border-r-2 border-t-2 border-white/40 rounded-tr-lg"}),e.jsx("div",{className:"absolute -bottom-1 -left-1 w-4 h-4 border-l-2 border-b-2 border-white/40 rounded-bl-lg"}),e.jsx("div",{className:"absolute -bottom-1 -right-1 w-4 h-4 border-r-2 border-b-2 border-white/40 rounded-br-lg"})]})}),e.jsxs("div",{className:"px-8 pb-8",children:[e.jsxs("div",{className:"flex items-center gap-4 bg-white/5 rounded-2xl p-4",children:[e.jsx(Wt,{className:"w-5 h-5 text-white/50"}),e.jsx("input",{type:"range",min:"1",max:"2",step:"0.01",value:de,onChange:s=>Q(parseFloat(s.target.value)),className:"flex-1 h-1 bg-white/20 rounded-full appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-4 [&::-webkit-slider-thumb]:h-4 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-white [&::-webkit-slider-thumb]:shadow-lg"}),e.jsx(It,{className:"w-5 h-5 text-white/50"})]}),e.jsx("p",{className:"text-center text-white/30 text-xs mt-3",children:"Drag to reposition â€¢ Slide to zoom"})]}),e.jsx("div",{className:"px-8 pb-8",children:e.jsx("button",{onClick:K,disabled:M,className:"w-full py-3 bg-white/10 rounded-xl text-white font-medium disabled:opacity-50",children:"Cancel"})})]})})]})}const Qt=/\.(mp4|webm|mov|m4v)(\?|$)/i;function Xt(t){return t.media_url?t.media_type&&t.media_type.toLowerCase().includes("video")?!0:Qt.test(t.media_url):!1}function W({post:t}){const i=a.useRef(null),[d,r]=a.useState(!1),[u,l]=a.useState(!1),[m,f]=a.useState(!1),b=bt(i,{minimumRatio:.25}),c=t.media_thumbnail||t.media_url,{isDataSaver:p}=ft();wt(p?null:c);const j=Xt(t);return a.useEffect(()=>{b&&r(!0)},[b]),t.media_url?u?e.jsx("div",{ref:i,className:"w-full h-full flex items-center justify-center bg-[#1a1a1a]",children:e.jsx(Et,{className:"w-8 h-8 text-white/20"})}):e.jsxs("div",{ref:i,className:"w-full h-full relative",children:[(!d||!m)&&e.jsx("div",{className:"absolute inset-0 bg-[#1a1a1a] animate-pulse"}),d&&e.jsxs(e.Fragment,{children:[e.jsx("img",{src:c||t.media_url,alt:"",className:`w-full h-full object-cover transition-opacity duration-200 ${m?"opacity-100":"opacity-0"}`,loading:"lazy",onLoad:()=>f(!0),onError:()=>l(!0)}),m&&j&&e.jsx("div",{className:"absolute inset-x-0 bottom-0 h-12 bg-gradient-to-t from-black/60 to-transparent"}),m&&j&&e.jsxs("div",{className:"absolute bottom-1.5 left-1.5 flex items-center gap-0.5",children:[e.jsx(At,{className:"w-3 h-3 text-white fill-white"}),e.jsx("span",{className:"text-white text-[11px] font-medium",children:z(t.view_count||0)})]}),m&&t.media_urls&&t.media_urls.length>1&&e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx("div",{className:"bg-black/50 rounded px-1.5 py-0.5",children:e.jsx("span",{className:"text-[11px] text-white font-medium",children:t.media_urls.length})})})]})]}):e.jsx("div",{ref:i,className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-purple-900/50 to-pink-900/50 p-4",children:e.jsx("p",{className:"text-[13px] text-white text-center line-clamp-5",children:t.content})})}export{Ss as default};
