import{c as v,r,j as e,T as C,S,X as N,A as ae,m as te}from"./index-C4ggKbPK-1765320789792.js";import{S as le}from"./shield-COG9dvUo-1765320789792.js";import{A as ne}from"./arrow-left-DpOAHz6N-1765320789792.js";import{C as ie}from"./chart-column-lZabNSLh-1765320789792.js";import{U as P}from"./users-BJisSbRE-1765320789792.js";import{F as b}from"./file-text-CdGKcR05-1765320789792.js";import{C as re}from"./chevron-right-rUAS60Ro-1765320789792.js";import{E as ce}from"./eye-B6w-xk1l-1765320789792.js";import{C as U}from"./check-DxO9epBj-1765320789792.js";import{L as de}from"./lock-Cz0dMjQv-1765320789792.js";import{T as oe}from"./trash-2-BzSzMYZa-1765320789792.js";import{B as xe}from"./ban-BD89siIQ-1765320789792.js";const me=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],he=v("refresh-cw",me);const pe=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],ge=v("settings",pe);const ue=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],T=v("user-check",ue),je="https://eigfbxjheuwxmtdfnvqc.supabase.co/functions/v1/admin-api",fe="10326296114e8840474f677a04a7f275347e4f44f7d0ed51b539049d28f51925";async function c(t){const l=await fetch(je,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${fe}`},body:JSON.stringify(t),credentials:"include"});if(l.status===204)return null;if(!l.ok){const a=await l.text();throw new Error(`Admin API (${l.status}): ${a||"Unknown error"}`)}return await l.json()}async function ye(t){return c({action:"check_admin",data:{telegramId:t}})}async function Ne(t=1,l=20,a){return c({action:"list_users",data:{page:t,limit:l,search:a}})}async function be(t){return c({action:"user_details",data:{telegramId:t}})}async function ve(t,l){return await c({action:"update_user",data:{telegramId:t,updates:l}}),!0}async function we(t,l,a){return await c({action:"ban_user",data:{telegramId:t,reason:l,adminId:a}}),!0}async function _e(t=1,l=20,a){return c({action:"list_posts",data:{page:t,limit:l,filters:a}})}async function ke(t,l,a){return await c({action:"hide_post",data:{postId:t,reason:l,adminId:a}}),!0}async function Ae(t){return await c({action:"delete_post",data:{postId:t}}),!0}async function Ce(t){return c({action:"list_applications",data:{status:t}})}async function Se(t,l){return await c({action:"approve_application",data:{applicationId:t,userId:l}}),!0}async function Pe(t,l,a){return await c({action:"reject_application",data:{applicationId:t,userId:l,reason:a}}),!0}async function Ue(){return c({action:"platform_stats"})}function Ye({telegramId:t,onExit:l}){const[a,D]=r.useState(null),[L,$]=r.useState(!0),[d,w]=r.useState("dashboard"),[o,I]=r.useState(null),[E,R]=r.useState([]),[j,B]=r.useState(0),[x,M]=r.useState(1),[m,F]=r.useState(""),[i,g]=r.useState(null),[_,q]=r.useState([]),[p,O]=r.useState("pending"),[Y,H]=r.useState([]),[V,z]=r.useState(0),[k,K]=r.useState(1);r.useEffect(()=>{G()},[]);const G=async()=>{const s=await ye(t);s&&(D(s),A()),$(!1)},A=async()=>{const s=await Ue();I(s)},h=async(s=1,n)=>{const{users:y,total:se}=await Ne(s,20,n);R(y),B(se),M(s)},u=async s=>{const n=await Ce(s);q(n)},f=async(s=1)=>{const{posts:n,total:y}=await _e(s);H(n),z(y),K(s)},J=async s=>{const n=await be(s.telegram_id);g(n)},W=async(s,n)=>{a&&(await we(s,n,a.id),h(x,m),g(null))},X=async s=>{await Se(s.id,s.user_id),u(p)},Q=async(s,n)=>{await Pe(s.id,s.user_id,n),u(p)},Z=async(s,n)=>{a&&(await ke(s,n,a.id),f(k))},ee=async s=>{confirm("Permanently delete this post? This cannot be undone.")&&(await Ae(s),f(k))};return r.useEffect(()=>{a&&(d==="users"&&h(),d==="applications"&&u(p),d==="posts"&&f())},[d,a]),L?e.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:e.jsxs("div",{className:"text-white text-center",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{children:"Verifying admin access..."})]})}):a?e.jsxs("div",{className:"min-h-screen bg-gray-900 text-white",children:[e.jsxs("header",{className:"bg-gray-800 border-b border-gray-700 px-4 py-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:l,className:"p-2 hover:bg-gray-700 rounded-lg",children:e.jsx(ne,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"font-bold text-lg",children:"Admin Panel"}),e.jsxs("p",{className:"text-xs text-gray-400",children:["Logged in as ",a.username," (",a.role,")"]})]})]}),e.jsx("button",{onClick:A,className:"p-2 hover:bg-gray-700 rounded-lg",children:e.jsx(he,{className:"w-5 h-5"})})]}),e.jsx("nav",{className:"bg-gray-800 px-2 py-2 flex gap-1 overflow-x-auto border-b border-gray-700",children:[{id:"dashboard",label:"Dashboard",icon:ie},{id:"users",label:"Users",icon:P},{id:"applications",label:"Applications",icon:b},{id:"posts",label:"Posts",icon:b},{id:"settings",label:"Settings",icon:ge}].map(s=>e.jsxs("button",{onClick:()=>w(s.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium whitespace-nowrap transition-colors ${d===s.id?"bg-blue-600 text-white":"text-gray-400 hover:bg-gray-700"}`,children:[e.jsx(s.icon,{className:"w-4 h-4"}),s.label]},s.id))}),e.jsxs("main",{className:"p-4",children:[d==="dashboard"&&o&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Platform Overview"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-gray-800 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-400 text-sm mb-1",children:[e.jsx(P,{className:"w-4 h-4"}),"Total Users"]}),e.jsx("div",{className:"text-2xl font-bold",children:o.total_users}),e.jsxs("div",{className:"text-xs text-green-400",children:["+",o.new_users_today," today"]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-400 text-sm mb-1",children:[e.jsx(T,{className:"w-4 h-4"}),"Creators"]}),e.jsx("div",{className:"text-2xl font-bold",children:o.total_creators})]}),e.jsxs("div",{className:"bg-gray-800 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-400 text-sm mb-1",children:[e.jsx(b,{className:"w-4 h-4"}),"Total Posts"]}),e.jsx("div",{className:"text-2xl font-bold",children:o.total_posts})]}),e.jsxs("div",{className:"bg-gray-800 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-400 text-sm mb-1",children:[e.jsx(C,{className:"w-4 h-4"}),"Pending"]}),e.jsx("div",{className:"text-2xl font-bold text-yellow-400",children:o.pending_applications}),e.jsx("div",{className:"text-xs text-gray-400",children:"applications"})]})]}),o.pending_applications>0&&e.jsxs("button",{onClick:()=>w("applications"),className:"w-full p-4 bg-yellow-500/20 border border-yellow-500/30 rounded-xl flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(C,{className:"w-5 h-5 text-yellow-400"}),e.jsxs("span",{children:[o.pending_applications," pending application(s) need review"]})]}),e.jsx(re,{className:"w-5 h-5"})]})]}),d==="users"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(S,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",value:m,onChange:s=>F(s.target.value),onKeyDown:s=>s.key==="Enter"&&h(1,m),placeholder:"Search users...",className:"w-full pl-10 pr-4 py-3 bg-gray-800 rounded-xl border border-gray-700 focus:border-blue-500 outline-none"})]}),e.jsx("button",{onClick:()=>h(1,m),className:"px-4 py-3 bg-blue-600 rounded-xl",children:e.jsx(S,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"text-sm text-gray-400",children:[j," users total"]}),e.jsx("div",{className:"space-y-2",children:E.map(s=>e.jsxs("div",{className:"bg-gray-800 rounded-xl p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:s.avatar_url||`https://i.pravatar.cc/150?u=${s.telegram_id}`,alt:"",className:"w-10 h-10 rounded-full object-cover"}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold flex items-center gap-2",children:[s.first_name,s.is_creator&&e.jsx("span",{className:"text-xs bg-purple-500 px-2 py-0.5 rounded",children:"Creator"}),s.is_verified&&e.jsx("span",{className:"text-xs bg-blue-500 px-2 py-0.5 rounded",children:"Verified"})]}),e.jsxs("div",{className:"text-sm text-gray-400",children:["@",s.username||s.telegram_id]})]})]}),e.jsx("button",{onClick:()=>J(s),className:"p-2 hover:bg-gray-700 rounded-lg",children:e.jsx(ce,{className:"w-5 h-5"})})]},s.telegram_id))}),j>20&&e.jsxs("div",{className:"flex justify-center gap-2",children:[e.jsx("button",{onClick:()=>h(x-1,m),disabled:x===1,className:"px-4 py-2 bg-gray-800 rounded-lg disabled:opacity-50",children:"Previous"}),e.jsxs("span",{className:"px-4 py-2",children:["Page ",x]}),e.jsx("button",{onClick:()=>h(x+1,m),disabled:x*20>=j,className:"px-4 py-2 bg-gray-800 rounded-lg disabled:opacity-50",children:"Next"})]})]}),d==="applications"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex gap-2 overflow-x-auto",children:["pending","approved","rejected","all"].map(s=>e.jsx("button",{onClick:()=>{O(s==="all"?"":s),u(s==="all"?void 0:s)},className:`px-4 py-2 rounded-lg text-sm font-medium whitespace-nowrap ${p===s||p===""&&s==="all"?"bg-blue-600 text-white":"bg-gray-800 text-gray-400"}`,children:s.charAt(0).toUpperCase()+s.slice(1)},s))}),e.jsxs("div",{className:"space-y-3",children:[_.map(s=>e.jsxs("div",{className:"bg-gray-800 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:s.user?.avatar_url||`https://i.pravatar.cc/150?u=${s.user_id}`,alt:"",className:"w-10 h-10 rounded-full object-cover"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:s.legal_name}),e.jsxs("div",{className:"text-sm text-gray-400",children:["@",s.user?.username||s.user_id]})]})]}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${s.status==="pending"?"bg-yellow-500/20 text-yellow-400":s.status==="approved"?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:s.status})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm mb-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Type:"})," ",e.jsx("span",{className:s.content_type==="nsfw"?"text-red-400":"",children:s.content_type.toUpperCase()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"AI:"})," ",e.jsx("span",{children:s.is_ai_generated?"Yes":"No"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Country:"})," ",s.country]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Email:"})," ",s.email]})]}),e.jsxs("div",{className:"text-sm text-gray-400 mb-3",children:["Categories: ",s.content_categories?.join(", ")||"None"]}),s.status==="pending"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>X(s),className:"flex-1 py-2 bg-green-600 rounded-lg font-semibold flex items-center justify-center gap-2",children:[e.jsx(U,{className:"w-4 h-4"}),"Approve"]}),e.jsxs("button",{onClick:()=>{const n=prompt("Rejection reason:");n&&Q(s,n)},className:"flex-1 py-2 bg-red-600 rounded-lg font-semibold flex items-center justify-center gap-2",children:[e.jsx(N,{className:"w-4 h-4"}),"Reject"]})]})]},s.id)),_.length===0&&e.jsx("div",{className:"text-center text-gray-400 py-8",children:"No applications found"})]})]}),d==="posts"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-sm text-gray-400",children:[V," posts total"]}),e.jsx("div",{className:"space-y-3",children:Y.map(s=>e.jsxs("div",{className:"bg-gray-800 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:s.creator?.avatar_url||`https://i.pravatar.cc/150?u=${s.creator_id}`,alt:"",className:"w-8 h-8 rounded-full object-cover"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-sm",children:s.creator?.first_name||"Unknown"}),e.jsx("div",{className:"text-xs text-gray-400",children:new Date(s.created_at).toLocaleDateString()})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.is_nsfw&&e.jsx("span",{className:"text-xs bg-red-500 px-2 py-0.5 rounded",children:"NSFW"}),s.visibility!=="public"&&e.jsx("span",{className:"text-xs bg-purple-500 px-2 py-0.5 rounded",children:s.visibility})]})]}),s.content&&e.jsx("p",{className:"text-sm mb-3 line-clamp-3",children:s.content}),s.media_url&&e.jsx("img",{src:s.media_url,alt:"",className:"w-full h-32 object-cover rounded-lg mb-3"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>{const n=prompt("Reason for hiding:");n&&Z(s.id,n)},className:"flex-1 py-2 bg-yellow-600 rounded-lg text-sm font-medium flex items-center justify-center gap-2",children:[e.jsx(de,{className:"w-4 h-4"}),"Hide"]}),e.jsxs("button",{onClick:()=>ee(s.id),className:"flex-1 py-2 bg-red-600 rounded-lg text-sm font-medium flex items-center justify-center gap-2",children:[e.jsx(oe,{className:"w-4 h-4"}),"Delete"]})]})]},s.id))})]}),d==="settings"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Admin Settings"}),e.jsxs("div",{className:"bg-gray-800 rounded-xl p-4",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Your Permissions"}),e.jsx("div",{className:"grid grid-cols-2 gap-2 text-sm",children:Object.entries(a.permissions).map(([s,n])=>e.jsxs("div",{className:"flex items-center gap-2",children:[n?e.jsx(U,{className:"w-4 h-4 text-green-400"}):e.jsx(N,{className:"w-4 h-4 text-red-400"}),e.jsx("span",{className:"text-gray-400",children:s.replace(/_/g," ")})]},s))})]}),e.jsxs("div",{className:"bg-gray-800 rounded-xl p-4",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Session Info"}),e.jsxs("div",{className:"text-sm text-gray-400 space-y-1",children:[e.jsxs("p",{children:["Telegram ID: ",a.telegram_id]}),e.jsxs("p",{children:["Role: ",a.role]}),e.jsxs("p",{children:["Last Login: ",a.last_login?new Date(a.last_login).toLocaleString():"First login"]})]})]})]})]}),e.jsx(ae,{children:i&&e.jsx(te.div,{className:"fixed inset-0 bg-black/80 z-50 overflow-y-auto",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:e.jsx("div",{className:"min-h-screen p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-2xl max-w-lg mx-auto",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[e.jsx("h3",{className:"font-bold text-lg",children:"User Details"}),e.jsx("button",{onClick:()=>g(null),className:"p-2 hover:bg-gray-700 rounded-lg",children:e.jsx(N,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("img",{src:i.user.avatar_url||`https://i.pravatar.cc/150?u=${i.user.telegram_id}`,alt:"",className:"w-16 h-16 rounded-full object-cover"}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-bold text-lg",children:[i.user.first_name," ",i.user.last_name]}),e.jsxs("p",{className:"text-gray-400",children:["@",i.user.username||i.user.telegram_id]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["ID: ",i.user.telegram_id]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[e.jsxs("div",{className:"bg-gray-700 rounded-lg p-3",children:[e.jsx("div",{className:"text-xl font-bold",children:i.posts?.length||0}),e.jsx("div",{className:"text-xs text-gray-400",children:"Posts"})]}),e.jsxs("div",{className:"bg-gray-700 rounded-lg p-3",children:[e.jsx("div",{className:"text-xl font-bold",children:i.followers?.length||0}),e.jsx("div",{className:"text-xs text-gray-400",children:"Followers"})]}),e.jsxs("div",{className:"bg-gray-700 rounded-lg p-3",children:[e.jsx("div",{className:"text-xl font-bold",children:i.following?.length||0}),e.jsx("div",{className:"text-xs text-gray-400",children:"Following"})]})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Balance"}),e.jsxs("span",{children:[i.user.balance," tokens"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Creator"}),e.jsx("span",{children:i.user.is_creator?"Yes":"No"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Verified"}),e.jsx("span",{children:i.user.is_verified?"Yes":"No"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Subscription Price"}),e.jsxs("span",{children:["$",i.user.subscription_price||0,"/mo"]})]})]}),e.jsxs("div",{className:"flex gap-2 pt-4 border-t border-gray-700",children:[e.jsxs("button",{onClick:()=>{const s=prompt("Ban reason:");s&&W(i.user.telegram_id,s)},className:"flex-1 py-3 bg-red-600 rounded-xl font-semibold flex items-center justify-center gap-2",children:[e.jsx(xe,{className:"w-4 h-4"}),"Ban User"]}),e.jsxs("button",{onClick:()=>{ve(i.user.telegram_id,{is_creator:!0,is_verified:!0}),alert("User is now a verified creator"),g(null),h(x,m)},className:"flex-1 py-3 bg-green-600 rounded-xl font-semibold flex items-center justify-center gap-2",children:[e.jsx(T,{className:"w-4 h-4"}),"Make Creator"]})]})]})]})})})})]}):e.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-2xl p-8 max-w-md w-full text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-500/20 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(le,{className:"w-8 h-8 text-red-500"})}),e.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:"Access Denied"}),e.jsx("p",{className:"text-gray-400 mb-6",children:"You don't have admin privileges."}),e.jsx("button",{onClick:l,className:"px-6 py-3 bg-gray-700 text-white rounded-xl font-semibold",children:"Go Back"})]})})}export{Ye as default};
