import{c as q,d as j,r as i,j as e,m as g,M as G,a1 as De,a2 as Fe,a3 as Te,a4 as Ae,a5 as Ve,A as le,a6 as Me,a7 as Ue,a8 as Ie,a9 as Oe}from"./index-CyafJy3t-1765573344145.js";import{g as We,P as Ge}from"./PostDetail-YJqMWCYa-1765573344145.js";import{G as qe,F as ze,u as Be,a as He}from"./useConnectionQuality-NZyPZtt9-1765573344145.js";import{u as Ke}from"./useInViewport-D2wikE-G-1765573344145.js";import{g as Qe,S as Xe,c as Ye}from"./storyApi-CGR2qXBO-1765573344145.js";import{A as Ze}from"./arrow-left-CwlleiRr-1765573344145.js";import{R as Je,T as et,S as tt}from"./trending-up-C7GBqp63-1765573344145.js";import{E as oe}from"./eye-G4lE2tUk-1765573344145.js";import{U as st}from"./users-B8tAmQ-E-1765573344145.js";import{D as at}from"./dollar-sign-Pl6_mzUL-1765573344145.js";import{H as z}from"./heart-CDH3i1r0-1765573344145.js";import{U as ne}from"./user-plus-Du-XPtKS-1765573344145.js";import{u as lt}from"./useTranslation-CsctKHmh-1765573344145.js";import{S as it}from"./star-ecdQ5X-3-1765573344145.js";import{C as rt}from"./chevron-down-DQw5w09V-1765573344145.js";import{L as T}from"./lock-ZF1pNyOI-1765573344145.js";import{R as ie}from"./repeat-2-CPj7Cp2D-1765573344145.js";import{C as ot}from"./chart-column-mLP6olTZ-1765573344145.js";import{V as nt}from"./video-C10z-N8C-1765573344145.js";import{I as ct}from"./image-BK1GFEya-1765573344145.js";import{P as dt}from"./play-eeFLyhwf-1765573344145.js";import"./PixelIcons-MUCrvDXD-1765573344145.js";import"./CommentsSheet-CgDER6fw-1765573344145.js";import"./loader-circle-BciBdSMF-1765573344145.js";import"./x-ClFESedx-1765573344145.js";import"./trash-2-BChAWF1--1765573344145.js";import"./flag-C60_F9eq-1765573344145.js";import"./volume-2-Rzz8xuhy-1765573344145.js";import"./chevron-left-Cf7ym0tP-1765573344145.js";const xt=[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]],re=q("bookmark",xt);const mt=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],ht=q("menu",mt);const pt=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],ce=q("share-2",pt);async function ut(t){try{const{data:a,error:r}=await j.rpc("get_creator_analytics",{p_user_id:t});return r?(console.error("[Analytics] Error fetching analytics:",r),null):a}catch(a){return console.error("[Analytics] Exception:",a),null}}async function ft(t,a=7){try{const{data:r,error:l}=await j.rpc("get_profile_views_chart",{p_user_id:t,p_days:a});return l?(console.error("[Analytics] Error fetching chart data:",l),[]):r||[]}catch(r){return console.error("[Analytics] Exception:",r),[]}}async function wt(t,a=10){try{const{data:r,error:l}=await j.rpc("get_recent_visitors",{p_user_id:t,p_limit:a});return l?(console.error("[Analytics] Error fetching visitors:",l),[]):r||[]}catch(r){return console.error("[Analytics] Exception:",r),[]}}async function bt(t,a=5){try{const{data:r,error:l}=await j.rpc("get_top_posts_analytics",{p_user_id:t,p_limit:a});return l?(console.error("[Analytics] Error fetching top posts:",l),[]):r||[]}catch(r){return console.error("[Analytics] Exception:",r),[]}}function jt(t,a){const r=j.channel(`profile_views_${t}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"profile_views",filter:`profile_id=eq.${t}`},()=>a("view")).subscribe(),l=j.channel(`follows_${t}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"follows",filter:`following_id=eq.${t}`},()=>a("follow")).subscribe(),d=j.channel(`likes_${t}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"likes"},()=>a("like")).subscribe();return()=>{j.removeChannel(r),j.removeChannel(l),j.removeChannel(d)}}function gt(t,a,r,l){if(l===0)return 0;const d=t+a*2+r*3;return Math.min(100,d/l*100)}function y(t){return t>=1e6?(t/1e6).toFixed(1).replace(/\.0$/,"")+"M":t>=1e3?(t/1e3).toFixed(1).replace(/\.0$/,"")+"K":t.toString()}function vt(t){return t>=1e3?"$"+(t/1e3).toFixed(1).replace(/\.0$/,"")+"K":"$"+t.toFixed(2)}const Nt=({data:t,height:a=60})=>{if(!t.length)return null;const r=Math.max(...t,1),l=Math.min(...t,0),d=r-l||1,o=100,m=t.map((c,p)=>{const b=p/(t.length-1||1)*o,k=a-(c-l)/d*(a-8)-4;return{x:b,y:k,value:c}}),u=m.map((c,p)=>`${p===0?"M":"L"} ${c.x} ${c.y}`).join(" "),w=`${u} L ${o} ${a} L 0 ${a} Z`;return e.jsxs("svg",{viewBox:`0 0 ${o} ${a}`,className:"w-full",style:{height:a},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"chartGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:"white",stopOpacity:"0.15"}),e.jsx("stop",{offset:"100%",stopColor:"white",stopOpacity:"0"})]})}),e.jsx(g.path,{d:w,fill:"url(#chartGradient)",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5}}),e.jsx(g.path,{d:u,fill:"none",stroke:"rgba(255,255,255,0.4)",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:.8,ease:"easeOut"}}),m.map((c,p)=>e.jsx(g.circle,{cx:c.x,cy:c.y,r:"2",fill:"white",initial:{scale:0},animate:{scale:1},transition:{delay:.1*p,duration:.2}},p))]})},yt=({data:t})=>{if(!t.length)return null;const a=Math.max(...t.map(r=>r.value),1);return e.jsx("div",{className:"flex items-end gap-[3px] h-10",children:t.map((r,l)=>e.jsxs(g.div,{className:"flex-1 flex flex-col items-center",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:l*.05},children:[e.jsx(g.div,{className:"w-full bg-white/30 rounded-[2px]",initial:{height:0},animate:{height:`${r.value/a*100}%`},transition:{delay:l*.05,duration:.3},style:{minHeight:r.value>0?2:0}}),e.jsx("span",{className:"text-[7px] text-white/30 mt-1",children:r.label})]},l))})},A=({icon:t,label:a,value:r,sub:l})=>e.jsxs("div",{className:"bg-white/[0.03] rounded-lg p-2.5 border border-white/[0.04]",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[e.jsx(t,{className:"w-3 h-3 text-white/30"}),e.jsx("span",{className:"text-white/40 text-[10px]",children:a})]}),e.jsx("p",{className:"text-white text-base font-semibold leading-none",children:r}),l&&e.jsx("p",{className:"text-white/25 text-[9px] mt-0.5",children:l})]}),V=({icon:t,label:a,value:r})=>e.jsxs("div",{className:"flex items-center justify-between py-1.5 border-b border-white/[0.03] last:border-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(t,{className:"w-3 h-3 text-white/25"}),e.jsx("span",{className:"text-white/50 text-[11px]",children:a})]}),e.jsx("span",{className:"text-white/80 text-[11px] font-medium",children:r})]}),_t=({visitor:t,onClick:a})=>e.jsxs("button",{onClick:a,className:"flex items-center gap-2 py-1.5 w-full text-left",children:[e.jsx("img",{src:t.avatar_url||`https://ui-avatars.com/api/?name=${t.first_name||"U"}&background=222&color=666&size=24`,alt:"",className:"w-6 h-6 rounded-full object-cover"}),e.jsx("span",{className:"text-white/60 text-[11px] truncate flex-1",children:t.first_name||t.username||"User"}),e.jsx("span",{className:"text-white/25 text-[9px]",children:new Date(t.viewed_at).toLocaleDateString("en",{month:"short",day:"numeric"})})]}),kt=({post:t,rank:a})=>e.jsxs("div",{className:"flex items-center gap-2 py-1.5",children:[e.jsx("span",{className:"text-white/20 text-[10px] w-3",children:a}),e.jsx("div",{className:"w-7 h-7 rounded bg-white/5 overflow-hidden flex-shrink-0",children:t.media_url?e.jsx("img",{src:t.media_url,alt:"",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(G,{className:"w-3 h-3 text-white/15"})})}),e.jsxs("div",{className:"flex-1 flex gap-3 text-[10px]",children:[e.jsxs("span",{className:"text-white/50",children:[e.jsx(z,{className:"w-2.5 h-2.5 inline mr-0.5"}),y(t.like_count)]}),e.jsxs("span",{className:"text-white/50",children:[e.jsx(G,{className:"w-2.5 h-2.5 inline mr-0.5"}),y(t.comment_count)]}),e.jsxs("span",{className:"text-white/50",children:[e.jsx(oe,{className:"w-2.5 h-2.5 inline mr-0.5"}),y(t.view_count||0)]})]})]});function St({user:t,onClose:a,onCreatorClick:r}){const[l,d]=i.useState(null),[o,m]=i.useState([]),[u,w]=i.useState([]),[c,p]=i.useState([]),[b,k]=i.useState(!0),[$,P]=i.useState(!1),v=i.useCallback(async(n=!1)=>{n?P(!0):k(!0);try{const[f,D,I,_]=await Promise.all([ut(t.telegram_id),ft(t.telegram_id,7),wt(t.telegram_id,5),bt(t.telegram_id,3)]);f&&d(f),m(D),w(I),p(_)}catch(f){console.error("Failed to load analytics:",f)}finally{k(!1),P(!1)}},[t.telegram_id]);i.useEffect(()=>(v(),jt(t.telegram_id,()=>v(!0))),[v,t.telegram_id]);const L=l?gt(l.total_likes,l.total_comments,l.total_shares,l.total_followers):0,S=o.map(n=>n.views),E=o.map(n=>({label:new Date(n.date).toLocaleDateString("en",{weekday:"narrow"}),value:n.views}));return e.jsxs(g.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-[#080808] z-50 flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between px-3 pt-10 pb-2",children:[e.jsx("button",{onClick:a,className:"w-8 h-8 rounded-full bg-white/5 flex items-center justify-center",children:e.jsx(Ze,{className:"w-4 h-4 text-white/50"})}),e.jsx("span",{className:"text-white/80 text-sm font-medium",children:"Analytics"}),e.jsx("button",{onClick:()=>v(!0),disabled:$,className:"w-8 h-8 rounded-full bg-white/5 flex items-center justify-center",children:e.jsx(Je,{className:`w-3.5 h-3.5 text-white/50 ${$?"animate-spin":""}`})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto px-3 pb-6",children:b?e.jsx("div",{className:"flex items-center justify-center h-40",children:e.jsx("div",{className:"w-5 h-5 border-2 border-white/10 border-t-white/40 rounded-full animate-spin"})}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(A,{icon:oe,label:"Views",value:y(l?.total_profile_views||0),sub:`+${l?.views_today||0} today`}),e.jsx(A,{icon:st,label:"Followers",value:y(l?.total_followers||0),sub:`+${l?.followers_this_week||0} week`}),e.jsx(A,{icon:et,label:"Engagement",value:`${L.toFixed(1)}%`,sub:"avg rate"}),e.jsx(A,{icon:at,label:"Earnings",value:vt(l?.total_earnings||0),sub:"lifetime"})]}),S.length>0&&e.jsxs("div",{className:"bg-white/[0.03] rounded-lg p-3 border border-white/[0.04]",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-white/50 text-[11px]",children:"Profile Views"}),e.jsx("span",{className:"text-white/30 text-[10px]",children:"7 days"})]}),e.jsx(Nt,{data:S,height:50}),e.jsx("div",{className:"flex justify-between mt-1",children:o.map((n,f)=>e.jsx("span",{className:"text-[8px] text-white/20",children:new Date(n.date).toLocaleDateString("en",{weekday:"narrow"})},f))})]}),E.length>0&&e.jsxs("div",{className:"bg-white/[0.03] rounded-lg p-3 border border-white/[0.04]",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-white/50 text-[11px]",children:"Daily Views"}),e.jsxs("span",{className:"text-white/30 text-[10px]",children:[o.reduce((n,f)=>n+f.views,0)," total"]})]}),e.jsx(yt,{data:E})]}),e.jsxs("div",{className:"bg-white/[0.03] rounded-lg p-2.5 border border-white/[0.04]",children:[e.jsx("span",{className:"text-white/40 text-[10px] font-medium",children:"Overview"}),e.jsxs("div",{className:"mt-1",children:[e.jsx(V,{icon:z,label:"Likes",value:y(l?.total_likes||0)}),e.jsx(V,{icon:G,label:"Comments",value:y(l?.total_comments||0)}),e.jsx(V,{icon:ce,label:"Shares",value:y(l?.total_shares||0)}),e.jsx(V,{icon:ne,label:"Subscribers",value:l?.total_subscribers||0})]})]}),u.length>0&&e.jsxs("div",{className:"bg-white/[0.03] rounded-lg p-2.5 border border-white/[0.04]",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-white/40 text-[10px] font-medium",children:"Recent Visitors"}),e.jsx("span",{className:"text-white/20 text-[9px]",children:u.length})]}),u.slice(0,4).map(n=>e.jsx(_t,{visitor:n,onClick:()=>r?.({telegram_id:n.viewer_id})},n.viewer_id))]}),c.length>0&&e.jsxs("div",{className:"bg-white/[0.03] rounded-lg p-2.5 border border-white/[0.04]",children:[e.jsx("span",{className:"text-white/40 text-[10px] font-medium",children:"Top Posts"}),e.jsx("div",{className:"mt-1",children:c.map((n,f)=>e.jsx(kt,{post:n,rank:f+1},n.id))})]})]})})]})}function U(t){return t>=1e6?(t/1e6).toFixed(1).replace(/\.0$/,"")+"M":t>=1e3?(t/1e3).toFixed(1).replace(/\.0$/,"")+"K":t.toString()}function ls({user:t,setUser:a,onSettingsClick:r,onViewProfile:l}){const{t:d}=lt(),[o,m]=i.useState("posts"),[u,w]=i.useState([]),[c,p]=i.useState([]),[b,k]=i.useState([]),[$,P]=i.useState(!0),[v,L]=i.useState(!1),[S,E]=i.useState(!1),[n,f]=i.useState(!1),[D,I]=i.useState(!1),[_,C]=i.useState(null),[de,xe]=i.useState(null),[me,B]=i.useState(!1),H=i.useRef(null),he=i.useRef(null),[,K]=i.useState(!1),[,Q]=i.useState(!1),[pe,O]=i.useState(!1),[ue,X]=i.useState("followers"),[fe,F]=i.useState(t.followers_count||0),[we,be]=i.useState(t.following_count||0),[je,ge]=i.useState(t.subscribers_count||0),[R,ve]=i.useState([]),[Ne,W]=i.useState(!1),[ye,Y]=i.useState(!1);i.useEffect(()=>{Se(),_e(),ee()},[t.telegram_id]);const _e=async()=>{const s=await De(t.telegram_id);F(s.followers),be(s.following)};i.useEffect(()=>{const s=Fe(t.telegram_id,{onNewFollower:()=>F(h=>h+1),onUnfollow:()=>F(h=>Math.max(0,h-1))}),x=Te(t.telegram_id,h=>{F(h.followers_count||0),ge(h.subscribers_count||0)});return()=>{s(),x()}},[t.telegram_id]),i.useEffect(()=>{o==="saved"&&(!S&&!v&&Z(),!de&&!me&&ke())},[o]);const ke=async()=>{B(!0);try{const s=await We(t.telegram_id);s.wallet&&xe(s.wallet)}catch(s){console.error("Failed to load wallet data:",s)}B(!1)},Se=async()=>{P(!0);const x=(await Ae(t.telegram_id,t.telegram_id))?.posts??[];w(x),P(!1)},Z=async()=>{if(!(S||v)){L(!0);try{const s=await Ve();p(s?.posts||[]),E(!0)}catch(s){console.error("[Profile] Failed to load saved posts:",s)}L(!1)}},Ce=async()=>{if(!(D||n)){f(!0);try{const s=await Me(t.telegram_id);k(s),I(!0)}catch(s){console.error("[Profile] Failed to load reposts:",s)}f(!1)}},$e=()=>{_&&(w(u.filter(s=>s.id!==_.id)),p(c.filter(s=>s.id!==_.id)),C(null),t.is_creator&&a({...t,posts_count:Math.max(0,(t.posts_count||1)-1)}))},Pe=s=>{w(u.map(x=>x.id===s.id?{...s,can_view:!0}:x)),p(c.map(x=>x.id===s.id?{...s,can_view:!0}:x))},Re=()=>{H.current?.click()},Le=async()=>{const s=t.first_name||t.username||"User",x=t.username||`user_${t.telegram_id}`;try{const h=window.Telegram?.WebApp;if(h?.switchInlineQuery){h.switchInlineQuery(`@${x}`,["users","groups","channels"]);return}if(navigator.share){await navigator.share({title:`${s}'s Profile`,text:`Check out @${x} on Veronica!`});return}}catch{}try{await navigator.clipboard.writeText(`@${x}`),alert(d("profile.share.copied"))}catch{alert(d("profile.share.copyError"))}},J=(s,x)=>{const h=s.target.files?.[0];if(!h){s.target.value="";return}if(x==="profile"){(async()=>{Q(!0);const N=await Ue(h,t.telegram_id);N.error||!N.url?alert(d("profile.upload.error")):await Ie(t.telegram_id,{avatar_url:N.url})?(a({...t,avatar_url:N.url}),alert(d("profile.upload.avatarSuccess"))):alert(d("profile.upload.error")),Q(!1),s.target.value=""})();return}(async()=>{K(!0);const N=await Oe(h,t.telegram_id);if(N.error||!N.url)alert(d("profile.upload.error"));else{const ae=h.type.startsWith("video/")?"video":"image",{error:Ee}=await Ye(t.telegram_id,N.url,ae);Ee?alert(d("profile.upload.error")):(alert(d("profile.upload.storySuccess")),ee())}K(!1),s.target.value=""})()},ee=async()=>{try{const{stories:s}=await Qe(),x=(s||[]).filter(h=>h.user_id===t.telegram_id);ve(x)}catch(s){console.error("[Profile] loadStories failed",s)}},te=u.filter(s=>s.visibility==="public"),se=u.filter(s=>s.visibility!=="public");return e.jsxs("div",{className:"bg-black min-h-screen text-white pb-20",children:[e.jsxs("div",{className:"flex items-center justify-between px-3 py-2",children:[e.jsx("button",{className:"p-1.5",children:e.jsx(ne,{className:"w-5 h-5 text-white"})}),R.length>0?e.jsxs("button",{onClick:()=>W(!0),className:"absolute left-1/2 -translate-x-1/2 top-16 bg-white text-black text-[11px] px-2.5 py-1 rounded-full font-medium shadow-lg",style:{transform:"translateX(-50%) translateY(-100%)"},children:["View Stories",e.jsx("div",{className:"absolute bottom-0 left-1/2 -translate-x-1/2 translate-y-full w-0 h-0 border-l-[5px] border-l-transparent border-r-[5px] border-r-transparent border-t-[5px] border-t-white"})]}):null,e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{className:"p-1.5",children:e.jsx(it,{className:"w-5 h-5 text-white"})}),e.jsx("button",{className:"p-1.5",onClick:Le,children:e.jsx(ce,{className:"w-5 h-5 text-white"})}),e.jsx("button",{className:"p-1.5",onClick:r,children:e.jsx(ht,{className:"w-5 h-5 text-white"})})]})]}),e.jsxs("div",{className:"flex flex-col items-center px-4 pt-1 pb-3",children:[e.jsxs("div",{className:"relative mb-2",children:[e.jsx("div",{className:`w-18 h-18 rounded-full ${R.length>0?"p-[2px] bg-gradient-to-tr from-pink-500 via-red-500 to-yellow-500":""}`,style:{width:"72px",height:"72px"},children:e.jsx("div",{className:`w-full h-full rounded-full ${R.length>0?"p-[2px] bg-black":""}`,children:e.jsx("img",{src:t.avatar_url||`https://i.pravatar.cc/150?u=${t.telegram_id}`,alt:t.first_name,className:"w-full h-full rounded-full object-cover",onClick:()=>R.length>0&&W(!0)})})}),e.jsx("button",{onClick:Re,className:"absolute -bottom-1 left-1/2 -translate-x-1/2 w-5 h-5 bg-[#00D4FF] rounded-full flex items-center justify-center border-2 border-black",children:e.jsx("span",{className:"text-black text-sm font-bold leading-none",children:"+"})})]}),e.jsx("input",{ref:H,type:"file",accept:"image/*",className:"hidden",onChange:s=>J(s,"profile")}),e.jsx("input",{ref:he,type:"file",accept:"image/*,video/*",className:"hidden",onChange:s=>J(s,"story")}),e.jsx("div",{className:"w-full flex justify-center mb-0.5",children:e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"text-base font-bold tracking-wide",children:t.first_name?.toUpperCase()||"USER"}),e.jsx("button",{onClick:r,className:"absolute -right-6 top-1/2 -translate-y-1/2 p-0.5",children:e.jsx(tt,{className:"w-4 h-4 text-white/70"})})]})}),e.jsxs("span",{className:"text-[12px] text-white/50 mb-3",children:["@",t.username||`user${t.telegram_id}`]}),e.jsxs("div",{className:"flex items-center justify-center gap-0 mb-3",children:[e.jsxs("button",{onClick:()=>{X("following"),O(!0)},className:"flex flex-col items-center px-4",children:[e.jsx("span",{className:"text-base font-bold",children:U(we)}),e.jsx("span",{className:"text-[11px] text-white/50",children:"Following"})]}),e.jsx("div",{className:"w-[1px] h-6 bg-white/10"}),e.jsxs("button",{onClick:()=>{X("followers"),O(!0)},className:"flex flex-col items-center px-4",children:[e.jsx("span",{className:"text-base font-bold",children:U(fe)}),e.jsx("span",{className:"text-[11px] text-white/50",children:"Followers"})]}),e.jsx("div",{className:"w-[1px] h-6 bg-white/10"}),e.jsxs("div",{className:"flex flex-col items-center px-4",children:[e.jsx("span",{className:"text-base font-bold",children:U(je)}),e.jsx("span",{className:"text-[11px] text-white/50",children:"Subscribers"})]})]}),e.jsx("div",{className:"text-center px-6 mb-2",children:e.jsx("p",{className:"text-[13px] text-white/90 whitespace-pre-wrap",children:t.bio||"No bio yet"})})]}),e.jsxs("div",{className:"flex border-b border-white/10",children:[e.jsxs("button",{className:`flex-1 py-3 flex items-center justify-center gap-1 ${o==="posts"?"border-b-2 border-white":""}`,onClick:()=>m("posts"),children:[e.jsx(qe,{className:`w-5 h-5 ${o==="posts"?"text-white":"text-white/40"}`}),e.jsx(rt,{className:`w-3 h-3 ${o==="posts"?"text-white":"text-white/40"}`})]}),t.is_creator&&e.jsx("button",{className:`flex-1 py-3 flex items-center justify-center ${o==="locked"?"border-b-2 border-white":""}`,onClick:()=>m("locked"),children:e.jsx(T,{className:`w-5 h-5 ${o==="locked"?"text-white":"text-white/40"}`})}),e.jsx("button",{className:`flex-1 py-3 flex items-center justify-center ${o==="reposts"?"border-b-2 border-white":""}`,onClick:()=>{m("reposts"),Ce()},children:e.jsx(ie,{className:`w-5 h-5 ${o==="reposts"?"text-white":"text-white/40"}`})}),e.jsx("button",{className:`flex-1 py-3 flex items-center justify-center ${o==="saved"?"border-b-2 border-white":""}`,onClick:()=>{m("saved"),Z()},children:e.jsx(re,{className:`w-5 h-5 ${o==="saved"?"text-white":"text-white/40"}`})}),t.is_creator?e.jsx("button",{className:"flex-1 py-3 flex items-center justify-center",onClick:()=>Y(!0),children:e.jsx(ot,{className:"w-5 h-5 text-white/40 hover:text-purple-400 transition-colors"})}):e.jsx("button",{className:`flex-1 py-3 flex items-center justify-center ${o==="liked"?"border-b-2 border-white":""}`,onClick:()=>m("liked"),children:e.jsx(z,{className:`w-5 h-5 ${o==="liked"?"text-white":"text-white/40"}`})})]}),e.jsxs("div",{className:"pb-20",children:[o==="posts"&&($?e.jsx("div",{className:"grid grid-cols-3 gap-[1px]",children:[1,2,3,4,5,6].map(s=>e.jsx("div",{className:"aspect-[3/4] bg-white/5 animate-pulse"},s))}):te.length===0?e.jsxs("div",{className:"py-20 text-center",children:[e.jsx("div",{className:"w-20 h-20 rounded-full border border-white/10 flex items-center justify-center mx-auto mb-4",children:e.jsx(nt,{className:"w-8 h-8 text-white/30"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"No posts yet"}),e.jsx("p",{className:"text-sm text-white/50",children:"Your posts will appear here"})]}):e.jsx("div",{className:"grid grid-cols-3 gap-[1px]",children:te.map(s=>e.jsx(g.div,{className:"relative aspect-[3/4] cursor-pointer overflow-hidden bg-[#1a1a1a]",whileTap:{opacity:.9},onClick:()=>C(s),children:e.jsx(M,{post:s})},s.id))})),o==="locked"&&t.is_creator&&($?e.jsx("div",{className:"grid grid-cols-3 gap-[1px]",children:[1,2,3].map(s=>e.jsx("div",{className:"aspect-[3/4] bg-white/5 animate-pulse"},s))}):se.length===0?e.jsxs("div",{className:"py-20 text-center",children:[e.jsx("div",{className:"w-20 h-20 rounded-full border border-white/10 flex items-center justify-center mx-auto mb-4",children:e.jsx(T,{className:"w-8 h-8 text-white/30"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"No locked content"}),e.jsx("p",{className:"text-sm text-white/50",children:"Private content will appear here"})]}):e.jsx("div",{className:"grid grid-cols-3 gap-[1px]",children:se.map(s=>e.jsxs(g.div,{className:"relative aspect-[3/4] cursor-pointer overflow-hidden bg-[#1a1a1a]",whileTap:{opacity:.9},onClick:()=>C(s),children:[e.jsx(M,{post:s}),e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx(T,{className:"w-4 h-4 text-white drop-shadow"})})]},s.id))})),o==="reposts"&&(n||!D&&!b.length?e.jsx("div",{className:"grid grid-cols-3 gap-[1px]",children:[1,2,3,4,5,6].map(s=>e.jsx("div",{className:"aspect-[3/4] bg-white/5 animate-pulse"},s))}):b.length===0?e.jsxs("div",{className:"py-20 text-center",children:[e.jsx("div",{className:"w-20 h-20 rounded-full border border-white/10 flex items-center justify-center mx-auto mb-4",children:e.jsx(ie,{className:"w-8 h-8 text-white/30"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"No reposts yet"}),e.jsx("p",{className:"text-sm text-white/50",children:"Content you repost will appear here"})]}):e.jsx("div",{className:"grid grid-cols-3 gap-[1px]",children:b.map(s=>e.jsx(g.div,{className:"relative aspect-[3/4] cursor-pointer overflow-hidden bg-[#1a1a1a]",whileTap:{opacity:.9},onClick:()=>C(s),children:e.jsx(M,{post:s})},s.id))})),o==="saved"&&(v||!S&&!c.length?e.jsx("div",{className:"grid grid-cols-3 gap-[1px]",children:[1,2,3,4,5,6].map(s=>e.jsx("div",{className:"aspect-[3/4] bg-white/5 animate-pulse"},s))}):c.length===0?e.jsxs("div",{className:"py-20 text-center",children:[e.jsx("div",{className:"w-20 h-20 rounded-full border border-white/10 flex items-center justify-center mx-auto mb-4",children:e.jsx(re,{className:"w-8 h-8 text-white/30"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"No saved posts"}),e.jsx("p",{className:"text-sm text-white/50 max-w-xs mx-auto",children:"Save posts to view them later"})]}):e.jsx("div",{className:"grid grid-cols-3 gap-[1px]",children:c.map(s=>e.jsx(g.div,{className:"relative aspect-[3/4] cursor-pointer overflow-hidden bg-[#1a1a1a]",whileTap:{opacity:.9},onClick:()=>C(s),children:e.jsx(M,{post:s})},s.id))})),o==="liked"&&e.jsxs("div",{className:"py-20 text-center",children:[e.jsx("div",{className:"w-20 h-20 rounded-full border border-white/10 flex items-center justify-center mx-auto mb-4",children:e.jsx(T,{className:"w-8 h-8 text-white/30"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Liked posts are private"}),e.jsx("p",{className:"text-sm text-white/50 max-w-xs mx-auto",children:"Only you can see what you've liked"})]})]}),e.jsx(le,{children:_&&e.jsx(Ge,{post:_,user:t,onBack:()=>C(null),onDeleted:$e,onUpdated:Pe})}),Ne&&e.jsx(Xe,{stories:R,startIndex:0,onClose:()=>W(!1)}),e.jsx(le,{children:ye&&e.jsx(St,{user:t,onClose:()=>Y(!1),onCreatorClick:l})}),e.jsx(ze,{isOpen:pe,onClose:()=>O(!1),userId:t.telegram_id,currentUserId:t.telegram_id,type:ue,onUserClick:l})]})}const Ct=/\.(mp4|webm|mov|m4v)(\?|$)/i;function $t(t){return t.media_url?t.media_type&&t.media_type.toLowerCase().includes("video")?!0:Ct.test(t.media_url):!1}function M({post:t}){const a=i.useRef(null),[r,l]=i.useState(!1),[d,o]=i.useState(!1),[m,u]=i.useState(!1),w=Ke(a,{minimumRatio:.25}),c=t.media_thumbnail||t.media_url,{isDataSaver:p}=Be();He(p?null:c);const b=$t(t);return i.useEffect(()=>{w&&l(!0)},[w]),t.media_url?d?e.jsx("div",{ref:a,className:"w-full h-full flex items-center justify-center bg-[#1a1a1a]",children:e.jsx(ct,{className:"w-8 h-8 text-white/20"})}):e.jsxs("div",{ref:a,className:"w-full h-full relative",children:[(!r||!m)&&e.jsx("div",{className:"absolute inset-0 bg-[#1a1a1a] animate-pulse"}),r&&e.jsxs(e.Fragment,{children:[e.jsx("img",{src:c||t.media_url,alt:"",className:`w-full h-full object-cover transition-opacity duration-200 ${m?"opacity-100":"opacity-0"}`,loading:"lazy",onLoad:()=>u(!0),onError:()=>o(!0)}),m&&b&&e.jsx("div",{className:"absolute inset-x-0 bottom-0 h-12 bg-gradient-to-t from-black/60 to-transparent"}),m&&b&&e.jsxs("div",{className:"absolute bottom-1.5 left-1.5 flex items-center gap-0.5",children:[e.jsx(dt,{className:"w-3 h-3 text-white fill-white"}),e.jsx("span",{className:"text-white text-[11px] font-medium",children:U(t.view_count||0)})]}),m&&t.media_urls&&t.media_urls.length>1&&e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx("div",{className:"bg-black/50 rounded px-1.5 py-0.5",children:e.jsx("span",{className:"text-[11px] text-white font-medium",children:t.media_urls.length})})})]})]}):e.jsx("div",{ref:a,className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-purple-900/50 to-pink-900/50 p-4",children:e.jsx("p",{className:"text-[13px] text-white text-center line-clamp-5",children:t.content})})}export{ls as default};
