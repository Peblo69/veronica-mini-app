import{c as R,d as f,r as l,j as e,m as $,M as ie,a1 as Fe,a2 as Le,a3 as De,a4 as Ae,a5 as Ve,A as te,a6 as Me,a7 as Ie,a8 as Ue,a9 as We}from"./index-BJiOEdd2-1765570304309.js";import{g as Oe,P as ze}from"./PostDetail-BAUMC9D2-1765570304309.js";import{G as qe,F as Be,u as Ge,a as He}from"./useConnectionQuality-D1mTOEeq-1765570304309.js";import{u as Ke}from"./useInViewport-Bx-32sCd-1765570304309.js";import{g as Qe,S as Xe,c as Ye}from"./storyApi-BeE38keL-1765570304309.js";import{A as Je}from"./arrow-left-Sp0xn_Hx-1765570304309.js";import{R as Ze,T as et,S as tt}from"./trending-up-DK72CFE6-1765570304309.js";import{E as st}from"./eye-DRxL2Ym3-1765570304309.js";import{U as at}from"./users-CEolm2Om-1765570304309.js";import{D as lt}from"./dollar-sign-CApk9pbu-1765570304309.js";import{H as re}from"./heart-Cax_kdmn-1765570304309.js";import{U as oe}from"./user-plus-C2DVd5zO-1765570304309.js";import{C as O}from"./clock-CeLi8Ibj-1765570304309.js";import{u as it}from"./useTranslation-B80FW95I-1765570304309.js";import{S as rt}from"./star-DP68xp0P-1765570304309.js";import{C as ot}from"./chevron-down-c40yytfM-1765570304309.js";import{L as V}from"./lock-CV53hTWJ-1765570304309.js";import{R as se}from"./repeat-2-6phORjTR-1765570304309.js";import{C as nt}from"./chart-column-z8yDJ65p-1765570304309.js";import{V as ct}from"./video-Ddxz2b2B-1765570304309.js";import{I as dt}from"./image-iSRD5ocd-1765570304309.js";import{P as xt}from"./play-DCHMmPLf-1765570304309.js";import"./PixelIcons-CzMJ4xcW-1765570304309.js";import"./CommentsSheet-3-t0mQKI-1765570304309.js";import"./loader-circle-5PlvWZlx-1765570304309.js";import"./x-BDHshRI--1765570304309.js";import"./trash-2-C9UABq1q-1765570304309.js";import"./flag-VWpgqc1L-1765570304309.js";import"./volume-2-kXI0kc4o-1765570304309.js";import"./chevron-left-DusbBxYh-1765570304309.js";const mt=[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]],ae=R("bookmark",mt);const ht=[["path",{d:"M5 21v-6",key:"1hz6c0"}],["path",{d:"M12 21V3",key:"1lcnhd"}],["path",{d:"M19 21V9",key:"unv183"}]],le=R("chart-no-axes-column",ht);const ut=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],pt=R("menu",ut);const ft=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],ne=R("share-2",ft);const wt=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],bt=R("trending-down",wt);async function jt(t){try{const{data:i,error:r}=await f.rpc("get_creator_analytics",{p_user_id:t});return r?(console.error("[Analytics] Error fetching analytics:",r),null):i}catch(i){return console.error("[Analytics] Exception:",i),null}}async function gt(t,i=7){try{const{data:r,error:a}=await f.rpc("get_profile_views_chart",{p_user_id:t,p_days:i});return a?(console.error("[Analytics] Error fetching chart data:",a),[]):r||[]}catch(r){return console.error("[Analytics] Exception:",r),[]}}async function Nt(t,i=10){try{const{data:r,error:a}=await f.rpc("get_recent_visitors",{p_user_id:t,p_limit:i});return a?(console.error("[Analytics] Error fetching visitors:",a),[]):r||[]}catch(r){return console.error("[Analytics] Exception:",r),[]}}async function vt(t,i=5){try{const{data:r,error:a}=await f.rpc("get_top_posts_analytics",{p_user_id:t,p_limit:i});return a?(console.error("[Analytics] Error fetching top posts:",a),[]):r||[]}catch(r){return console.error("[Analytics] Exception:",r),[]}}function yt(t,i){const r=f.channel(`profile_views_${t}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"profile_views",filter:`profile_id=eq.${t}`},()=>i("view")).subscribe(),a=f.channel(`follows_${t}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"follows",filter:`following_id=eq.${t}`},()=>i("follow")).subscribe(),n=f.channel(`likes_${t}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"likes"},()=>i("like")).subscribe();return()=>{f.removeChannel(r),f.removeChannel(a),f.removeChannel(n)}}function _t(t,i,r,a){if(a===0)return 0;const n=t+i*2+r*3;return Math.min(100,n/a*100)}function v(t){return t>=1e6?(t/1e6).toFixed(1).replace(/\.0$/,"")+"M":t>=1e3?(t/1e3).toFixed(1).replace(/\.0$/,"")+"K":t.toString()}function kt(t){return t>=1e3?"$"+(t/1e3).toFixed(1).replace(/\.0$/,"")+"K":"$"+t.toFixed(2)}const N=({icon:t,label:i,value:r,trend:a,suffix:n=""})=>e.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-white/5 last:border-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-white/5 flex items-center justify-center",children:e.jsx(t,{className:"w-4 h-4 text-white/50"})}),e.jsx("span",{className:"text-white/60 text-sm",children:i})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-white font-semibold text-sm",children:[r,n]}),a!==void 0&&a!==0&&e.jsxs("div",{className:`flex items-center gap-0.5 text-xs ${a>0?"text-white/40":"text-white/30"}`,children:[a>0?e.jsx(et,{className:"w-3 h-3"}):e.jsx(bt,{className:"w-3 h-3"}),e.jsxs("span",{children:[Math.abs(a),"%"]})]})]})]}),St=({data:t})=>{if(!t.length)return null;const i=Math.max(...t.map(r=>r.views),1);return e.jsx("div",{className:"flex items-end gap-1 h-16",children:t.map((r,a)=>e.jsxs("div",{className:"flex-1 flex flex-col items-center gap-1",children:[e.jsx("div",{className:"w-full bg-white/20 rounded-sm transition-all",style:{height:`${r.views/i*100}%`,minHeight:2}}),e.jsx("span",{className:"text-[8px] text-white/30",children:new Date(r.date).toLocaleDateString("en",{weekday:"narrow"})})]},a))})},Ct=({visitor:t,onClick:i})=>e.jsxs("button",{onClick:i,className:"flex items-center gap-3 py-2.5 border-b border-white/5 last:border-0 w-full text-left",children:[e.jsx("img",{src:t.avatar_url||`https://ui-avatars.com/api/?name=${t.first_name||"U"}&background=222&color=888&size=32`,alt:"",className:"w-8 h-8 rounded-full object-cover bg-white/5"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-white/80 text-sm truncate",children:t.first_name||t.username||"Anonymous"}),e.jsx("p",{className:"text-white/30 text-xs",children:new Date(t.viewed_at).toLocaleDateString("en",{month:"short",day:"numeric"})})]}),t.is_verified&&e.jsx("div",{className:"w-4 h-4 rounded-full bg-white/10 flex items-center justify-center",children:e.jsx("span",{className:"text-[8px]",children:"✓"})})]}),Pt=({post:t,rank:i})=>e.jsxs("div",{className:"flex items-center gap-3 py-2.5 border-b border-white/5 last:border-0",children:[e.jsx("div",{className:"w-6 h-6 rounded bg-white/5 flex items-center justify-center text-xs text-white/30 font-medium",children:i}),e.jsx("div",{className:"w-10 h-10 rounded bg-white/5 overflow-hidden flex-shrink-0",children:t.media_url?e.jsx("img",{src:t.media_url,alt:"",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(ie,{className:"w-4 h-4 text-white/20"})})}),e.jsxs("div",{className:"flex-1 min-w-0 grid grid-cols-3 gap-2",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-white/80 text-xs font-medium",children:v(t.like_count)}),e.jsx("p",{className:"text-white/30 text-[9px]",children:"likes"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-white/80 text-xs font-medium",children:v(t.comment_count)}),e.jsx("p",{className:"text-white/30 text-[9px]",children:"comments"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-white/80 text-xs font-medium",children:v(t.view_count||0)}),e.jsx("p",{className:"text-white/30 text-[9px]",children:"views"})]})]})]});function $t({user:t,onClose:i,onCreatorClick:r}){const[a,n]=l.useState(null),[o,m]=l.useState([]),[u,w]=l.useState([]),[h,y]=l.useState([]),[b,T]=l.useState(!0),[k,S]=l.useState(!1),j=l.useCallback(async(x=!1)=>{x?S(!0):T(!0);try{const[p,F,L,D]=await Promise.all([jt(t.telegram_id),gt(t.telegram_id,7),Nt(t.telegram_id,5),vt(t.telegram_id,3)]);p&&n(p),m(F),w(L),y(D)}catch(p){console.error("Failed to load analytics:",p)}finally{T(!1),S(!1)}},[t.telegram_id]);l.useEffect(()=>(j(),yt(t.telegram_id,()=>j(!0))),[j,t.telegram_id]);const E=a?_t(a.total_likes,a.total_comments,a.total_shares,a.total_followers):0;return e.jsxs($.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},className:"fixed inset-0 bg-[#0a0a0a] z-50 flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 pt-12 pb-4",children:[e.jsx("button",{onClick:i,className:"w-10 h-10 rounded-full bg-white/5 flex items-center justify-center",children:e.jsx(Je,{className:"w-5 h-5 text-white/60"})}),e.jsx("h1",{className:"text-white font-semibold text-base",children:"Analytics"}),e.jsx("button",{onClick:()=>j(!0),disabled:k,className:"w-10 h-10 rounded-full bg-white/5 flex items-center justify-center",children:e.jsx(Ze,{className:`w-4 h-4 text-white/60 ${k?"animate-spin":""}`})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto px-4 pb-8",children:b?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"w-6 h-6 border-2 border-white/20 border-t-white/60 rounded-full animate-spin"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-white/[0.03] rounded-xl p-4 border border-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(st,{className:"w-4 h-4 text-white/40"}),e.jsx("span",{className:"text-white/40 text-xs",children:"Profile Views"})]}),e.jsx("p",{className:"text-white text-2xl font-semibold",children:v(a?.total_profile_views||0)}),e.jsxs("p",{className:"text-white/30 text-xs mt-1",children:["+",a?.views_today||0," today"]})]}),e.jsxs("div",{className:"bg-white/[0.03] rounded-xl p-4 border border-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(at,{className:"w-4 h-4 text-white/40"}),e.jsx("span",{className:"text-white/40 text-xs",children:"Followers"})]}),e.jsx("p",{className:"text-white text-2xl font-semibold",children:v(a?.total_followers||0)}),e.jsxs("p",{className:"text-white/30 text-xs mt-1",children:["+",a?.followers_this_week||0," this week"]})]}),e.jsxs("div",{className:"bg-white/[0.03] rounded-xl p-4 border border-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(le,{className:"w-4 h-4 text-white/40"}),e.jsx("span",{className:"text-white/40 text-xs",children:"Engagement"})]}),e.jsxs("p",{className:"text-white text-2xl font-semibold",children:[E.toFixed(1),"%"]}),e.jsx("p",{className:"text-white/30 text-xs mt-1",children:"avg. rate"})]}),e.jsxs("div",{className:"bg-white/[0.03] rounded-xl p-4 border border-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(lt,{className:"w-4 h-4 text-white/40"}),e.jsx("span",{className:"text-white/40 text-xs",children:"Earnings"})]}),e.jsx("p",{className:"text-white text-2xl font-semibold",children:kt(a?.total_earnings||0)}),e.jsx("p",{className:"text-white/30 text-xs mt-1",children:"lifetime"})]})]}),o.length>0&&e.jsxs("div",{className:"bg-white/[0.03] rounded-xl p-4 border border-white/5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("span",{className:"text-white/60 text-sm font-medium",children:"Views · Last 7 days"}),e.jsxs("span",{className:"text-white/30 text-xs",children:[o.reduce((x,p)=>x+p.views,0)," total"]})]}),e.jsx(St,{data:o})]}),e.jsxs("div",{className:"bg-white/[0.03] rounded-xl p-4 border border-white/5",children:[e.jsx("h3",{className:"text-white/60 text-sm font-medium mb-2",children:"Overview"}),e.jsx(N,{icon:re,label:"Total Likes",value:v(a?.total_likes||0)}),e.jsx(N,{icon:ie,label:"Total Comments",value:v(a?.total_comments||0)}),e.jsx(N,{icon:ne,label:"Total Shares",value:v(a?.total_shares||0)}),e.jsx(N,{icon:le,label:"Total Posts",value:a?.total_posts||0}),e.jsx(N,{icon:oe,label:"Subscribers",value:a?.total_subscribers||0})]}),e.jsxs("div",{className:"bg-white/[0.03] rounded-xl p-4 border border-white/5",children:[e.jsx("h3",{className:"text-white/60 text-sm font-medium mb-2",children:"Views Breakdown"}),e.jsx(N,{icon:O,label:"Today",value:a?.views_today||0}),e.jsx(N,{icon:O,label:"This Week",value:a?.views_this_week||0}),e.jsx(N,{icon:O,label:"This Month",value:a?.views_this_month||0})]}),u.length>0&&e.jsxs("div",{className:"bg-white/[0.03] rounded-xl p-4 border border-white/5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-white/60 text-sm font-medium",children:"Recent Visitors"}),e.jsx("span",{className:"text-white/30 text-xs",children:u.length})]}),u.map(x=>e.jsx(Ct,{visitor:x,onClick:()=>r?.({telegram_id:x.viewer_id})},x.viewer_id))]}),h.length>0&&e.jsxs("div",{className:"bg-white/[0.03] rounded-xl p-4 border border-white/5",children:[e.jsx("h3",{className:"text-white/60 text-sm font-medium mb-2",children:"Top Performing Posts"}),h.map((x,p)=>e.jsx(Pt,{post:x,rank:p+1},x.id))]}),e.jsx("div",{className:"h-4"})]})})]})}function I(t){return t>=1e6?(t/1e6).toFixed(1).replace(/\.0$/,"")+"M":t>=1e3?(t/1e3).toFixed(1).replace(/\.0$/,"")+"K":t.toString()}function ns({user:t,setUser:i,onSettingsClick:r,onViewProfile:a}){const{t:n}=it(),[o,m]=l.useState("posts"),[u,w]=l.useState([]),[h,y]=l.useState([]),[b,T]=l.useState([]),[k,S]=l.useState(!0),[j,E]=l.useState(!1),[x,p]=l.useState(!1),[F,L]=l.useState(!1),[D,ce]=l.useState(!1),[C,_]=l.useState(null),[de,xe]=l.useState(null),[me,z]=l.useState(!1),q=l.useRef(null),he=l.useRef(null),[,B]=l.useState(!1),[,G]=l.useState(!1),[ue,U]=l.useState(!1),[pe,H]=l.useState("followers"),[fe,A]=l.useState(t.followers_count||0),[we,be]=l.useState(t.following_count||0),[je,ge]=l.useState(t.subscribers_count||0),[P,Ne]=l.useState([]),[ve,W]=l.useState(!1),[ye,K]=l.useState(!1);l.useEffect(()=>{Se(),_e(),Y()},[t.telegram_id]);const _e=async()=>{const s=await Fe(t.telegram_id);A(s.followers),be(s.following)};l.useEffect(()=>{const s=Le(t.telegram_id,{onNewFollower:()=>A(d=>d+1),onUnfollow:()=>A(d=>Math.max(0,d-1))}),c=De(t.telegram_id,d=>{A(d.followers_count||0),ge(d.subscribers_count||0)});return()=>{s(),c()}},[t.telegram_id]),l.useEffect(()=>{o==="saved"&&(!x&&!j&&Q(),!de&&!me&&ke())},[o]);const ke=async()=>{z(!0);try{const s=await Oe(t.telegram_id);s.wallet&&xe(s.wallet)}catch(s){console.error("Failed to load wallet data:",s)}z(!1)},Se=async()=>{S(!0);const c=(await Ae(t.telegram_id,t.telegram_id))?.posts??[];w(c),S(!1)},Q=async()=>{if(!(x||j)){E(!0);try{const s=await Ve();y(s?.posts||[]),p(!0)}catch(s){console.error("[Profile] Failed to load saved posts:",s)}E(!1)}},Ce=async()=>{if(!(D||F)){L(!0);try{const s=await Me(t.telegram_id);T(s),ce(!0)}catch(s){console.error("[Profile] Failed to load reposts:",s)}L(!1)}},Pe=()=>{C&&(w(u.filter(s=>s.id!==C.id)),y(h.filter(s=>s.id!==C.id)),_(null),t.is_creator&&i({...t,posts_count:Math.max(0,(t.posts_count||1)-1)}))},$e=s=>{w(u.map(c=>c.id===s.id?{...s,can_view:!0}:c)),y(h.map(c=>c.id===s.id?{...s,can_view:!0}:c))},Re=()=>{q.current?.click()},Te=async()=>{const s=t.first_name||t.username||"User",c=t.username||`user_${t.telegram_id}`;try{const d=window.Telegram?.WebApp;if(d?.switchInlineQuery){d.switchInlineQuery(`@${c}`,["users","groups","channels"]);return}if(navigator.share){await navigator.share({title:`${s}'s Profile`,text:`Check out @${c} on Veronica!`});return}}catch{}try{await navigator.clipboard.writeText(`@${c}`),alert(n("profile.share.copied"))}catch{alert(n("profile.share.copyError"))}},X=(s,c)=>{const d=s.target.files?.[0];if(!d){s.target.value="";return}if(c==="profile"){(async()=>{G(!0);const g=await Ie(d,t.telegram_id);g.error||!g.url?alert(n("profile.upload.error")):await Ue(t.telegram_id,{avatar_url:g.url})?(i({...t,avatar_url:g.url}),alert(n("profile.upload.avatarSuccess"))):alert(n("profile.upload.error")),G(!1),s.target.value=""})();return}(async()=>{B(!0);const g=await We(d,t.telegram_id);if(g.error||!g.url)alert(n("profile.upload.error"));else{const ee=d.type.startsWith("video/")?"video":"image",{error:Ee}=await Ye(t.telegram_id,g.url,ee);Ee?alert(n("profile.upload.error")):(alert(n("profile.upload.storySuccess")),Y())}B(!1),s.target.value=""})()},Y=async()=>{try{const{stories:s}=await Qe(),c=(s||[]).filter(d=>d.user_id===t.telegram_id);Ne(c)}catch(s){console.error("[Profile] loadStories failed",s)}},J=u.filter(s=>s.visibility==="public"),Z=u.filter(s=>s.visibility!=="public");return e.jsxs("div",{className:"bg-black min-h-screen text-white pb-20",children:[e.jsxs("div",{className:"flex items-center justify-between px-3 py-2",children:[e.jsx("button",{className:"p-1.5",children:e.jsx(oe,{className:"w-5 h-5 text-white"})}),P.length>0?e.jsxs("button",{onClick:()=>W(!0),className:"absolute left-1/2 -translate-x-1/2 top-16 bg-white text-black text-[11px] px-2.5 py-1 rounded-full font-medium shadow-lg",style:{transform:"translateX(-50%) translateY(-100%)"},children:["View Stories",e.jsx("div",{className:"absolute bottom-0 left-1/2 -translate-x-1/2 translate-y-full w-0 h-0 border-l-[5px] border-l-transparent border-r-[5px] border-r-transparent border-t-[5px] border-t-white"})]}):null,e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{className:"p-1.5",children:e.jsx(rt,{className:"w-5 h-5 text-white"})}),e.jsx("button",{className:"p-1.5",onClick:Te,children:e.jsx(ne,{className:"w-5 h-5 text-white"})}),e.jsx("button",{className:"p-1.5",onClick:r,children:e.jsx(pt,{className:"w-5 h-5 text-white"})})]})]}),e.jsxs("div",{className:"flex flex-col items-center px-4 pt-1 pb-3",children:[e.jsxs("div",{className:"relative mb-2",children:[e.jsx("div",{className:`w-18 h-18 rounded-full ${P.length>0?"p-[2px] bg-gradient-to-tr from-pink-500 via-red-500 to-yellow-500":""}`,style:{width:"72px",height:"72px"},children:e.jsx("div",{className:`w-full h-full rounded-full ${P.length>0?"p-[2px] bg-black":""}`,children:e.jsx("img",{src:t.avatar_url||`https://i.pravatar.cc/150?u=${t.telegram_id}`,alt:t.first_name,className:"w-full h-full rounded-full object-cover",onClick:()=>P.length>0&&W(!0)})})}),e.jsx("button",{onClick:Re,className:"absolute -bottom-1 left-1/2 -translate-x-1/2 w-5 h-5 bg-[#00D4FF] rounded-full flex items-center justify-center border-2 border-black",children:e.jsx("span",{className:"text-black text-sm font-bold leading-none",children:"+"})})]}),e.jsx("input",{ref:q,type:"file",accept:"image/*",className:"hidden",onChange:s=>X(s,"profile")}),e.jsx("input",{ref:he,type:"file",accept:"image/*,video/*",className:"hidden",onChange:s=>X(s,"story")}),e.jsx("div",{className:"w-full flex justify-center mb-0.5",children:e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"text-base font-bold tracking-wide",children:t.first_name?.toUpperCase()||"USER"}),e.jsx("button",{onClick:r,className:"absolute -right-6 top-1/2 -translate-y-1/2 p-0.5",children:e.jsx(tt,{className:"w-4 h-4 text-white/70"})})]})}),e.jsxs("span",{className:"text-[12px] text-white/50 mb-3",children:["@",t.username||`user${t.telegram_id}`]}),e.jsxs("div",{className:"flex items-center justify-center gap-0 mb-3",children:[e.jsxs("button",{onClick:()=>{H("following"),U(!0)},className:"flex flex-col items-center px-4",children:[e.jsx("span",{className:"text-base font-bold",children:I(we)}),e.jsx("span",{className:"text-[11px] text-white/50",children:"Following"})]}),e.jsx("div",{className:"w-[1px] h-6 bg-white/10"}),e.jsxs("button",{onClick:()=>{H("followers"),U(!0)},className:"flex flex-col items-center px-4",children:[e.jsx("span",{className:"text-base font-bold",children:I(fe)}),e.jsx("span",{className:"text-[11px] text-white/50",children:"Followers"})]}),e.jsx("div",{className:"w-[1px] h-6 bg-white/10"}),e.jsxs("div",{className:"flex flex-col items-center px-4",children:[e.jsx("span",{className:"text-base font-bold",children:I(je)}),e.jsx("span",{className:"text-[11px] text-white/50",children:"Subscribers"})]})]}),e.jsx("div",{className:"text-center px-6 mb-2",children:e.jsx("p",{className:"text-[13px] text-white/90 whitespace-pre-wrap",children:t.bio||"No bio yet"})})]}),e.jsxs("div",{className:"flex border-b border-white/10",children:[e.jsxs("button",{className:`flex-1 py-3 flex items-center justify-center gap-1 ${o==="posts"?"border-b-2 border-white":""}`,onClick:()=>m("posts"),children:[e.jsx(qe,{className:`w-5 h-5 ${o==="posts"?"text-white":"text-white/40"}`}),e.jsx(ot,{className:`w-3 h-3 ${o==="posts"?"text-white":"text-white/40"}`})]}),t.is_creator&&e.jsx("button",{className:`flex-1 py-3 flex items-center justify-center ${o==="locked"?"border-b-2 border-white":""}`,onClick:()=>m("locked"),children:e.jsx(V,{className:`w-5 h-5 ${o==="locked"?"text-white":"text-white/40"}`})}),e.jsx("button",{className:`flex-1 py-3 flex items-center justify-center ${o==="reposts"?"border-b-2 border-white":""}`,onClick:()=>{m("reposts"),Ce()},children:e.jsx(se,{className:`w-5 h-5 ${o==="reposts"?"text-white":"text-white/40"}`})}),e.jsx("button",{className:`flex-1 py-3 flex items-center justify-center ${o==="saved"?"border-b-2 border-white":""}`,onClick:()=>{m("saved"),Q()},children:e.jsx(ae,{className:`w-5 h-5 ${o==="saved"?"text-white":"text-white/40"}`})}),t.is_creator?e.jsx("button",{className:"flex-1 py-3 flex items-center justify-center",onClick:()=>K(!0),children:e.jsx(nt,{className:"w-5 h-5 text-white/40 hover:text-purple-400 transition-colors"})}):e.jsx("button",{className:`flex-1 py-3 flex items-center justify-center ${o==="liked"?"border-b-2 border-white":""}`,onClick:()=>m("liked"),children:e.jsx(re,{className:`w-5 h-5 ${o==="liked"?"text-white":"text-white/40"}`})})]}),e.jsxs("div",{className:"pb-20",children:[o==="posts"&&(k?e.jsx("div",{className:"grid grid-cols-3 gap-[1px]",children:[1,2,3,4,5,6].map(s=>e.jsx("div",{className:"aspect-[3/4] bg-white/5 animate-pulse"},s))}):J.length===0?e.jsxs("div",{className:"py-20 text-center",children:[e.jsx("div",{className:"w-20 h-20 rounded-full border border-white/10 flex items-center justify-center mx-auto mb-4",children:e.jsx(ct,{className:"w-8 h-8 text-white/30"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"No posts yet"}),e.jsx("p",{className:"text-sm text-white/50",children:"Your posts will appear here"})]}):e.jsx("div",{className:"grid grid-cols-3 gap-[1px]",children:J.map(s=>e.jsx($.div,{className:"relative aspect-[3/4] cursor-pointer overflow-hidden bg-[#1a1a1a]",whileTap:{opacity:.9},onClick:()=>_(s),children:e.jsx(M,{post:s})},s.id))})),o==="locked"&&t.is_creator&&(k?e.jsx("div",{className:"grid grid-cols-3 gap-[1px]",children:[1,2,3].map(s=>e.jsx("div",{className:"aspect-[3/4] bg-white/5 animate-pulse"},s))}):Z.length===0?e.jsxs("div",{className:"py-20 text-center",children:[e.jsx("div",{className:"w-20 h-20 rounded-full border border-white/10 flex items-center justify-center mx-auto mb-4",children:e.jsx(V,{className:"w-8 h-8 text-white/30"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"No locked content"}),e.jsx("p",{className:"text-sm text-white/50",children:"Private content will appear here"})]}):e.jsx("div",{className:"grid grid-cols-3 gap-[1px]",children:Z.map(s=>e.jsxs($.div,{className:"relative aspect-[3/4] cursor-pointer overflow-hidden bg-[#1a1a1a]",whileTap:{opacity:.9},onClick:()=>_(s),children:[e.jsx(M,{post:s}),e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx(V,{className:"w-4 h-4 text-white drop-shadow"})})]},s.id))})),o==="reposts"&&(F||!D&&!b.length?e.jsx("div",{className:"grid grid-cols-3 gap-[1px]",children:[1,2,3,4,5,6].map(s=>e.jsx("div",{className:"aspect-[3/4] bg-white/5 animate-pulse"},s))}):b.length===0?e.jsxs("div",{className:"py-20 text-center",children:[e.jsx("div",{className:"w-20 h-20 rounded-full border border-white/10 flex items-center justify-center mx-auto mb-4",children:e.jsx(se,{className:"w-8 h-8 text-white/30"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"No reposts yet"}),e.jsx("p",{className:"text-sm text-white/50",children:"Content you repost will appear here"})]}):e.jsx("div",{className:"grid grid-cols-3 gap-[1px]",children:b.map(s=>e.jsx($.div,{className:"relative aspect-[3/4] cursor-pointer overflow-hidden bg-[#1a1a1a]",whileTap:{opacity:.9},onClick:()=>_(s),children:e.jsx(M,{post:s})},s.id))})),o==="saved"&&(j||!x&&!h.length?e.jsx("div",{className:"grid grid-cols-3 gap-[1px]",children:[1,2,3,4,5,6].map(s=>e.jsx("div",{className:"aspect-[3/4] bg-white/5 animate-pulse"},s))}):h.length===0?e.jsxs("div",{className:"py-20 text-center",children:[e.jsx("div",{className:"w-20 h-20 rounded-full border border-white/10 flex items-center justify-center mx-auto mb-4",children:e.jsx(ae,{className:"w-8 h-8 text-white/30"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"No saved posts"}),e.jsx("p",{className:"text-sm text-white/50 max-w-xs mx-auto",children:"Save posts to view them later"})]}):e.jsx("div",{className:"grid grid-cols-3 gap-[1px]",children:h.map(s=>e.jsx($.div,{className:"relative aspect-[3/4] cursor-pointer overflow-hidden bg-[#1a1a1a]",whileTap:{opacity:.9},onClick:()=>_(s),children:e.jsx(M,{post:s})},s.id))})),o==="liked"&&e.jsxs("div",{className:"py-20 text-center",children:[e.jsx("div",{className:"w-20 h-20 rounded-full border border-white/10 flex items-center justify-center mx-auto mb-4",children:e.jsx(V,{className:"w-8 h-8 text-white/30"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Liked posts are private"}),e.jsx("p",{className:"text-sm text-white/50 max-w-xs mx-auto",children:"Only you can see what you've liked"})]})]}),e.jsx(te,{children:C&&e.jsx(ze,{post:C,user:t,onBack:()=>_(null),onDeleted:Pe,onUpdated:$e})}),ve&&e.jsx(Xe,{stories:P,startIndex:0,onClose:()=>W(!1)}),e.jsx(te,{children:ye&&e.jsx($t,{user:t,onClose:()=>K(!1),onCreatorClick:a})}),e.jsx(Be,{isOpen:ue,onClose:()=>U(!1),userId:t.telegram_id,currentUserId:t.telegram_id,type:pe,onUserClick:a})]})}const Rt=/\.(mp4|webm|mov|m4v)(\?|$)/i;function Tt(t){return t.media_url?t.media_type&&t.media_type.toLowerCase().includes("video")?!0:Rt.test(t.media_url):!1}function M({post:t}){const i=l.useRef(null),[r,a]=l.useState(!1),[n,o]=l.useState(!1),[m,u]=l.useState(!1),w=Ke(i,{minimumRatio:.25}),h=t.media_thumbnail||t.media_url,{isDataSaver:y}=Ge();He(y?null:h);const b=Tt(t);return l.useEffect(()=>{w&&a(!0)},[w]),t.media_url?n?e.jsx("div",{ref:i,className:"w-full h-full flex items-center justify-center bg-[#1a1a1a]",children:e.jsx(dt,{className:"w-8 h-8 text-white/20"})}):e.jsxs("div",{ref:i,className:"w-full h-full relative",children:[(!r||!m)&&e.jsx("div",{className:"absolute inset-0 bg-[#1a1a1a] animate-pulse"}),r&&e.jsxs(e.Fragment,{children:[e.jsx("img",{src:h||t.media_url,alt:"",className:`w-full h-full object-cover transition-opacity duration-200 ${m?"opacity-100":"opacity-0"}`,loading:"lazy",onLoad:()=>u(!0),onError:()=>o(!0)}),m&&b&&e.jsx("div",{className:"absolute inset-x-0 bottom-0 h-12 bg-gradient-to-t from-black/60 to-transparent"}),m&&b&&e.jsxs("div",{className:"absolute bottom-1.5 left-1.5 flex items-center gap-0.5",children:[e.jsx(xt,{className:"w-3 h-3 text-white fill-white"}),e.jsx("span",{className:"text-white text-[11px] font-medium",children:I(t.view_count||0)})]}),m&&t.media_urls&&t.media_urls.length>1&&e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx("div",{className:"bg-black/50 rounded px-1.5 py-0.5",children:e.jsx("span",{className:"text-[11px] text-white font-medium",children:t.media_urls.length})})})]})]}):e.jsx("div",{ref:i,className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-purple-900/50 to-pink-900/50 p-4",children:e.jsx("p",{className:"text-[13px] text-white text-center line-clamp-5",children:t.content})})}export{ns as default};
