import{r as l,Y as ve,Z as Ne,$ as ye,a0 as _e,j as e,m as n,A as O,X as Se,P as ke,a1 as Ce,a2 as Te,a3 as De,C as Pe}from"./index-BNIw4U_K-1765313534941.js";import{g as Ie,a as Ee,P as Le}from"./PostDetail-BxQ4HePG-1765313534941.js";import{G,B as H,W as X,A as Q,a as Y,T as Fe,F as Re}from"./FollowersSheet-F47LOhiQ-1765313534941.js";import{u as Ue}from"./useInViewport-D09fBv35-1765313534941.js";import{g as $e,S as Ae,c as ze}from"./storyApi-BW1jANjy-1765313534941.js";import{u as Ve}from"./useTranslation-CqUhk1i2-1765313534941.js";import{S as qe}from"./settings-os3Lz7D3-1765313534941.js";import{C as Me}from"./chart-column-ZoDYmYIS-1765313534941.js";import{L as Z}from"./lock-BJWSgDTZ-1765313534941.js";import{S as J}from"./star-D6DCwJwu-1765313534941.js";import{U as K}from"./users-BpokScDq-1765313534941.js";import{E as We}from"./eye-BQfwdXMH-1765313534941.js";import{C as Be}from"./camera--7C4--l9-1765313534941.js";import{I as te}from"./image-DXZsA-qS-1765313534941.js";import{V as se}from"./video-Dds6F04w-1765313534941.js";import{C as Oe}from"./clock-CcIZU813-1765313534941.js";import"./CommentsSheet-0FTfVv9C-1765313534941.js";import"./loader-circle-CMyo9YM1-1765313534941.js";import"./heart-CaEFW7r0-1765313534941.js";import"./arrow-left-BDP4KbSs-1765313534941.js";import"./ellipsis-BiUAYkM5-1765313534941.js";import"./trash-2-HfBji9tH-1765313534941.js";import"./volume-2-jmxy0QZi-1765313534941.js";import"./chevron-right-Ebc0-ocN-1765313534941.js";function Ge(s){l.useEffect(()=>{if(typeof window>"u"||!s)return;const d=typeof window.requestIdleCallback=="function"?window.requestIdleCallback.bind(window):void 0,c=typeof window.cancelIdleCallback=="function"?window.cancelIdleCallback.bind(window):void 0;let x=!1,i=null,t=null;const r=()=>{if(x)return;const m=new Image;m.src=s};return d?i=d(()=>r()):t=window.setTimeout(r,250),()=>{x=!0,i!==null&&c&&c(i),t!==null&&window.clearTimeout(t)}},[s])}const g={effectiveType:"4g",saveData:!1,downlink:10};function He(){const[s,d]=l.useState(()=>{if(typeof navigator>"u")return g;const i=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return i?{effectiveType:i.effectiveType||g.effectiveType,saveData:i.saveData||!1,downlink:i.downlink||g.downlink}:g});l.useEffect(()=>{const i=navigator?.connection||navigator?.mozConnection||navigator?.webkitConnection;if(!i)return;const t=()=>{d({effectiveType:i.effectiveType||g.effectiveType,saveData:!!i.saveData,downlink:i.downlink||g.downlink})};return i.addEventListener?.("change",t),()=>i.removeEventListener?.("change",t)},[]);const c=s.effectiveType==="slow-2g"||s.effectiveType==="2g",x=s.saveData;return{...s,isSlow:c,isDataSaver:x}}function jt({user:s,setUser:d,onBecomeCreator:c,onSettingsClick:x,onViewProfile:i}){const{t}=Ve(),[r,m]=l.useState("posts"),[f,u]=l.useState([]),[w,k]=l.useState([]),[P,I]=l.useState(!0),[j,_]=l.useState(null),[ae,v]=l.useState(!1),[S,le]=l.useState(null),[N,ie]=l.useState([]),[E,L]=l.useState(!1),F=l.useRef(null),R=l.useRef(null),[b,U]=l.useState(!1),[$,A]=l.useState(!1),[re,C]=l.useState(!1),[oe,z]=l.useState("followers"),[ne,T]=l.useState(s.followers_count||0),[de,ce]=l.useState(s.following_count||0),[y,xe]=l.useState([]),[me,V]=l.useState(!1);l.useEffect(()=>{fe(),pe(),M()},[s.telegram_id]);const pe=async()=>{const a=await ve(s.telegram_id);T(a.followers),ce(a.following)};l.useEffect(()=>{const a=Ne(s.telegram_id,{onNewFollower:()=>{T(o=>o+1)},onUnfollow:()=>{T(o=>Math.max(0,o-1))}});return()=>a()},[s.telegram_id]),l.useEffect(()=>{r==="wallet"&&!S&&!E&&he()},[r]);const he=async()=>{L(!0);try{const[a,o]=await Promise.all([Ie(s.telegram_id),Ee(s.telegram_id)]);a.wallet&&le(a.wallet),o.transactions&&ie(o.transactions)}catch(a){console.error("Failed to load wallet data:",a)}L(!1)},fe=async()=>{I(!0);const[a,o]=await Promise.all([ye(s.telegram_id,s.telegram_id),_e(s.telegram_id)]),p=a?.posts??[];u(p),k(o),I(!1)},ue=()=>{j&&(u(f.filter(a=>a.id!==j.id)),k(w.filter(a=>a.id!==j.id)),_(null),s.is_creator&&d({...s,posts_count:Math.max(0,(s.posts_count||1)-1)}))},we=a=>{u(f.map(o=>o.id===a.id?{...a,can_view:!0}:o)),k(w.map(o=>o.id===a.id?{...a,can_view:!0}:o))},be=()=>{v(!1),F.current?.click()},D=()=>{v(!1),R.current?.click()},ge=async()=>{const a=`${window.location.origin}/profile/${s.username||s.telegram_id}`;try{if(navigator.share){await navigator.share({url:a,title:s.username||t("profile.title")});return}}catch{}try{await navigator.clipboard.writeText(a),alert(t("profile.share.copied"))}catch{alert(t("profile.share.copyError"))}},q=(a,o)=>{const p=a.target.files?.[0];if(!p){a.target.value="";return}if(o==="profile"){(async()=>{A(!0);const h=await Ce(p,s.telegram_id);h.error||!h.url?alert(t("profile.upload.error")):await Te(s.telegram_id,{avatar_url:h.url})?(d({...s,avatar_url:h.url}),alert(t("profile.upload.avatarSuccess"))):alert(t("profile.upload.error")),A(!1),a.target.value=""})();return}(async()=>{U(!0);const h=await De(p,s.telegram_id);if(h.error||!h.url)alert(t("profile.upload.error"));else{const W=p.type.startsWith("video/")?"video":"image",{error:B}=await ze(s.telegram_id,h.url,W);B?(console.error("[Stories] insert error",B),alert(t("profile.upload.error"))):(alert(t("profile.upload.storySuccess")),M())}U(!1),a.target.value=""})()},M=async()=>{try{const{stories:a}=await $e(),o=(a||[]).filter(p=>p.user_id===s.telegram_id);xe(o)}catch(a){console.error("[Profile] loadStories failed",a)}},je=()=>{if(s.is_creator)return null;const a=s.application_status;return a==="pending"?e.jsx("div",{className:"mt-4 p-4 bg-yellow-500/10 border border-yellow-500/25 rounded-xl text-white",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Oe,{className:"w-6 h-6 text-yellow-300"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-white",children:t("profile.application.pendingTitle")}),e.jsx("div",{className:"text-sm text-yellow-100/80",children:t("profile.application.pendingDesc")})]})]})}):a==="approved"?e.jsx("div",{className:"mt-4 p-4 bg-emerald-500/10 border border-emerald-500/25 rounded-xl text-white",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Pe,{className:"w-6 h-6 text-emerald-300"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-white",children:t("profile.application.approvedTitle")}),e.jsx("div",{className:"text-sm text-emerald-100/80",children:t("profile.application.approvedDesc")})]})]})}):a==="rejected"?e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"p-4 bg-red-500/10 border border-red-500/25 rounded-xl mb-3",children:[e.jsx("div",{className:"font-semibold text-white",children:t("profile.application.rejectedTitle")}),e.jsx("div",{className:"text-sm text-red-100/80",children:t("profile.application.rejectedDesc")})]}),e.jsx(n.button,{className:"w-full py-2 bg-white/10 text-white font-bold rounded-lg text-sm border border-white/10",whileTap:{scale:.98},onClick:c,children:t("profile.application.reapply")})]}):e.jsx(n.button,{className:"w-full py-2 bg-white/10 border border-white/10 text-white font-bold rounded-lg text-sm mt-4",whileTap:{scale:.98},onClick:c,children:t("profile.application.becomeCreator")})};return e.jsxs("div",{className:"bg-[#050505] min-h-screen text-white pb-20 relative",children:[e.jsxs("div",{className:"px-4 pt-5 pb-4 relative overflow-hidden",children:[e.jsx("div",{className:"pointer-events-none absolute inset-0 opacity-25",style:{backgroundImage:"radial-gradient(1px 1px at 20% 30%, rgba(255,255,255,0.5), rgba(255,255,255,0)), radial-gradient(1px 1px at 70% 60%, rgba(255,255,255,0.4), rgba(255,255,255,0)), radial-gradient(1px 1px at 40% 80%, rgba(255,255,255,0.35), rgba(255,255,255,0))"}}),e.jsx("div",{className:"pointer-events-none absolute -left-10 -top-10 w-48 h-48 rounded-full bg-blue-500/10 blur-3xl"}),e.jsx("div",{className:"pointer-events-none absolute right-0 top-10 w-40 h-40 rounded-full bg-purple-500/10 blur-3xl"}),e.jsxs("div",{className:"flex items-center gap-5 mb-6 relative z-10",children:[e.jsx("div",{className:"relative shrink-0",children:e.jsx("div",{className:"w-[72px] h-[72px] rounded-full p-[2px] bg-gradient-to-tr from-[#1f6fff] via-[#7aa4ff] to-[#1f6fff]/40 shadow-[0_8px_28px_rgba(31,111,255,0.25)]",children:e.jsx("img",{src:s.avatar_url||"https://i.pravatar.cc/150?u="+s.telegram_id,alt:s.first_name,className:"w-full h-full rounded-full object-cover border border-white/15"})})}),e.jsx("input",{ref:F,type:"file",accept:"image/*",className:"hidden",onChange:a=>q(a,"profile")}),e.jsx("input",{ref:R,type:"file",accept:"image/*,video/*",className:"hidden",onChange:a=>q(a,"story")}),e.jsxs("div",{className:"flex-1 flex justify-around items-center",children:[e.jsxs("div",{className:"flex flex-col items-center gap-0.5",children:[e.jsx("span",{className:"font-semibold text-[18px] leading-tight text-white",children:s.posts_count||0}),e.jsx("span",{className:"text-[12px] text-white/60",children:t("profile.stats.posts")})]}),e.jsxs("button",{className:"flex flex-col items-center gap-0.5 active:opacity-70 transition-opacity",onClick:()=>{z("followers"),C(!0)},children:[e.jsx("span",{className:"font-semibold text-[18px] leading-tight text-white",children:ne}),e.jsx("span",{className:"text-[12px] text-white/60",children:t("profile.stats.followers")})]}),e.jsxs("button",{className:"flex flex-col items-center gap-0.5 active:opacity-70 transition-opacity",onClick:()=>{z("following"),C(!0)},children:[e.jsx("span",{className:"font-semibold text-[18px] leading-tight text-white",children:de}),e.jsx("span",{className:"text-[12px] text-white/60",children:t("profile.stats.following")})]})]})]}),e.jsxs("div",{className:"mb-5 relative z-10",children:[e.jsxs("div",{className:"font-bold text-sm mb-0.5 text-white flex items-center gap-2",children:[s.first_name," ",s.last_name]}),s.is_creator&&e.jsx("div",{className:"text-xs text-blue-300 mb-1",children:t("profile.creatorTag")}),e.jsx("div",{className:"text-sm whitespace-pre-wrap leading-snug text-white/80",children:s.bio||t("profile.noBio")})]}),y.length>0&&e.jsxs("div",{className:"mb-4 relative z-10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-[13px] font-semibold text-white",children:t("feed.stories.title")}),e.jsx("span",{className:"text-[12px] text-white/60",children:y.length})]}),e.jsxs("button",{onClick:()=>V(!0),className:"w-full flex items-center gap-3 p-3 rounded-2xl bg-white/5 border border-white/10 hover:bg-white/10 transition",children:[e.jsx("div",{className:"w-12 h-12 rounded-full p-[2px] bg-gradient-to-tr from-blue-500 via-purple-500 to-pink-500",children:e.jsx("div",{className:"w-full h-full rounded-full p-[2px] bg-black",children:e.jsx("img",{src:s.avatar_url||`https://i.pravatar.cc/150?u=${s.telegram_id}`,alt:"",className:"w-full h-full rounded-full object-cover"})})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("p",{className:"text-white font-semibold text-sm",children:t("feed.stories.title")}),e.jsxs("p",{className:"text-white/60 text-xs",children:[y.length," ",y.length===1?"story":"stories"]})]}),e.jsx("div",{className:"text-white/50 text-xs",children:"View"})]})]}),e.jsxs("div",{className:"flex gap-2 mb-5 relative z-10",children:[e.jsx("button",{className:"flex-1 bg-white/10 hover:bg-white/15 text-sm font-semibold py-2 rounded-lg transition-colors text-white border border-white/10",onClick:x,children:t("profile.actions.editProfile")}),e.jsx("button",{className:"flex-1 bg-white/10 hover:bg-white/15 text-sm font-semibold py-2 rounded-lg transition-colors text-white border border-white/10",onClick:ge,children:t("profile.actions.shareProfile")}),e.jsx("button",{className:"bg-white/10 hover:bg-white/15 p-2 rounded-lg transition-colors text-white border border-white/10",onClick:x,children:e.jsx(qe,{className:"w-4 h-4"})})]}),je()]}),e.jsxs("div",{className:"flex border-t border-white/5 bg-[#080808]",children:[e.jsx("button",{className:`flex-1 py-3 flex items-center justify-center border-b-[2px] transition-colors ${r==="posts"?"border-blue-500 text-white":"border-transparent text-white/50"}`,onClick:()=>m("posts"),children:e.jsx(G,{className:"w-5 h-5"})}),e.jsx("button",{className:`flex-1 py-3 flex items-center justify-center border-b-[2px] transition-colors ${r==="saved"?"border-blue-500 text-white":"border-transparent text-white/50"}`,onClick:()=>m("saved"),children:e.jsx(H,{className:"w-5 h-5"})}),e.jsx("button",{className:`flex-1 py-3 flex items-center justify-center border-b-[2px] transition-colors ${r==="wallet"?"border-blue-500 text-white":"border-transparent text-white/50"}`,onClick:()=>m("wallet"),children:e.jsx(X,{className:"w-5 h-5"})}),e.jsx("button",{className:`flex-1 py-3 flex items-center justify-center border-b-[2px] transition-colors ${r==="stats"?"border-blue-500 text-white":"border-transparent text-white/50"}`,onClick:()=>m("stats"),children:e.jsx(Me,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"pb-28 bg-[#050505]",children:[r==="posts"&&(P?e.jsx("div",{className:"grid grid-cols-3 gap-[2px] px-[2px]",children:[1,2,3,4,5,6].map(a=>e.jsx("div",{className:"aspect-square bg-white/5 animate-pulse rounded-sm"},a))}):f.length===0?e.jsxs("div",{className:"py-20 text-center text-white",children:[e.jsx("div",{className:"w-16 h-16 rounded-full border border-white/10 flex items-center justify-center mx-auto mb-4 bg-white/5",children:e.jsx(G,{className:"w-7 h-7 text-white/70"})}),e.jsx("h3",{className:"font-bold text-lg mb-2",children:t("profile.posts.emptyTitle")}),e.jsx("p",{className:"text-sm text-white/60",children:t("profile.posts.emptySubtitle")}),s.is_creator&&e.jsx("button",{className:"text-blue-400 font-semibold text-sm mt-4",children:t("profile.posts.emptyCta")})]}):e.jsx("div",{className:"grid grid-cols-3 gap-[2px] px-[2px]",children:f.map(a=>e.jsxs(n.div,{className:"relative aspect-square cursor-pointer overflow-hidden bg-white/5",whileTap:{opacity:.9},onClick:()=>_(a),children:[e.jsx(ee,{post:a}),a.visibility!=="public"&&e.jsx("div",{className:"absolute top-1 right-1 bg-black/50 rounded-full p-[2px]",children:e.jsx(Z,{className:"w-3 h-3 text-white"})})]},a.id))})),r==="saved"&&(P?e.jsx("div",{className:"grid grid-cols-3 gap-[2px] px-[2px]",children:[1,2,3,4,5,6].map(a=>e.jsx("div",{className:"aspect-square bg-white/5 animate-pulse rounded-sm"},a))}):w.length===0?e.jsxs("div",{className:"py-20 text-center text-white",children:[e.jsx("div",{className:"w-16 h-16 rounded-full border border-white/10 flex items-center justify-center mx-auto mb-4 bg-white/5",children:e.jsx(H,{className:"w-7 h-7 text-white/70"})}),e.jsx("h3",{className:"font-bold text-lg mb-2",children:t("profile.saved.emptyTitle")}),e.jsx("p",{className:"text-sm text-white/60 max-w-xs mx-auto",children:t("profile.saved.emptySubtitle")})]}):e.jsx("div",{className:"grid grid-cols-3 gap-[2px] px-[2px]",children:w.map(a=>e.jsx(n.div,{className:"relative aspect-square cursor-pointer overflow-hidden bg-white/5",whileTap:{opacity:.9},onClick:()=>_(a),children:e.jsx(ee,{post:a})},a.id))})),r==="wallet"&&(E?e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsx("div",{className:"h-32 bg-white/5 animate-pulse rounded-xl"}),e.jsx("div",{className:"h-20 bg-white/5 animate-pulse rounded-xl"}),e.jsx("div",{className:"h-20 bg-white/5 animate-pulse rounded-xl"})]}):e.jsxs("div",{className:"p-3 space-y-3 relative",children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute top-4 left-8 w-1 h-1 bg-yellow-400/40 rounded-full animate-pulse"}),e.jsx("div",{className:"absolute top-12 right-12 w-0.5 h-0.5 bg-yellow-300/30 rounded-full"}),e.jsx("div",{className:"absolute top-24 left-16 w-0.5 h-0.5 bg-white/20 rounded-full animate-pulse",style:{animationDelay:"0.5s"}}),e.jsx("div",{className:"absolute top-32 right-8 w-1 h-1 bg-yellow-400/25 rounded-full"}),e.jsx("div",{className:"absolute top-48 left-6 w-0.5 h-0.5 bg-yellow-300/35 rounded-full animate-pulse",style:{animationDelay:"1s"}}),e.jsx("div",{className:"absolute top-56 right-20 w-0.5 h-0.5 bg-white/15 rounded-full"})]}),e.jsxs("div",{className:"relative bg-[#0a0a0f] border border-white/5 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-white/50 text-xs font-medium uppercase tracking-wide",children:t("profile.wallet.balance")}),e.jsx(J,{className:"w-4 h-4 text-yellow-500/70"})]}),e.jsxs("div",{className:"flex items-baseline gap-1.5 mb-3",children:[e.jsx("span",{className:"text-3xl font-bold text-white",children:S?.stars_balance||0}),e.jsx("span",{className:"text-white/40 text-sm",children:t("profile.wallet.stars")})]}),e.jsx(n.button,{whileTap:{scale:.98},className:"w-full py-2 bg-white/10 hover:bg-white/15 text-white text-sm font-medium rounded-lg border border-white/5 transition-colors",children:t("profile.wallet.cashOut")})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"bg-[#0a0a0f] border border-white/5 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[e.jsx(Q,{className:"w-3 h-3 text-emerald-500/70"}),e.jsx("span",{className:"text-white/40 text-[10px] uppercase tracking-wide",children:t("profile.wallet.earned")})]}),e.jsx("span",{className:"text-lg font-semibold text-white",children:S?.total_earned||0})]}),e.jsxs("div",{className:"bg-[#0a0a0f] border border-white/5 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[e.jsx(Y,{className:"w-3 h-3 text-white/40"}),e.jsx("span",{className:"text-white/40 text-[10px] uppercase tracking-wide",children:t("profile.wallet.spent")})]}),e.jsx("span",{className:"text-lg font-semibold text-white",children:S?.total_spent||0})]})]}),e.jsxs("div",{className:"bg-[#0a0a0f] border border-white/5 rounded-xl overflow-hidden",children:[e.jsx("div",{className:"px-3 py-2 border-b border-white/5",children:e.jsx("h3",{className:"text-xs font-medium text-white/60 uppercase tracking-wide",children:t("profile.wallet.transactions")})}),N.length===0?e.jsxs("div",{className:"py-6 text-center",children:[e.jsx(X,{className:"w-6 h-6 text-white/20 mx-auto mb-1"}),e.jsx("p",{className:"text-white/30 text-xs",children:t("profile.wallet.noTransactions")})]}):e.jsx("div",{className:"divide-y divide-white/5",children:N.slice(0,5).map(a=>e.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center ${a.to_user_id===s.telegram_id?"bg-emerald-500/10":"bg-white/5"}`,children:a.to_user_id===s.telegram_id?e.jsx(Q,{className:"w-3 h-3 text-emerald-500/70"}):e.jsx(Y,{className:"w-3 h-3 text-white/40"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white text-xs font-medium capitalize",children:a.type}),e.jsx("p",{className:"text-white/30 text-[10px]",children:new Date(a.created_at).toLocaleDateString()})]})]}),e.jsxs("span",{className:`text-xs font-medium ${a.to_user_id===s.telegram_id?"text-emerald-500/80":"text-white/50"}`,children:[a.to_user_id===s.telegram_id?"+":"-",a.amount]})]},a.id))})]}),s.is_creator&&e.jsxs("div",{className:"bg-[#0a0a0f] border border-white/5 rounded-xl overflow-hidden",children:[e.jsxs("div",{className:"px-3 py-2 border-b border-white/5 flex items-center gap-1.5",children:[e.jsx(K,{className:"w-3 h-3 text-white/40"}),e.jsx("h3",{className:"text-xs font-medium text-white/60 uppercase tracking-wide",children:t("profile.wallet.supporters")})]}),N.filter(a=>a.to_user_id===s.telegram_id).length===0?e.jsx("div",{className:"py-5 text-center",children:e.jsx("p",{className:"text-white/30 text-xs",children:t("profile.wallet.noSupporters")})}):e.jsx("div",{className:"px-3 py-2",children:e.jsxs("p",{className:"text-white/50 text-xs",children:[N.filter(a=>a.to_user_id===s.telegram_id&&a.type==="subscription").length," ",t("profile.wallet.subscribersLabel"),", "," ",N.filter(a=>a.to_user_id===s.telegram_id&&a.type==="tip").length," ",t("profile.wallet.tipsLabel")]})})]})]})),r==="stats"&&e.jsxs("div",{className:"p-3 relative",children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute top-6 left-10 w-1 h-1 bg-purple-400/30 rounded-full animate-pulse"}),e.jsx("div",{className:"absolute top-16 right-8 w-0.5 h-0.5 bg-pink-300/25 rounded-full"}),e.jsx("div",{className:"absolute top-28 left-6 w-0.5 h-0.5 bg-white/15 rounded-full animate-pulse",style:{animationDelay:"0.5s"}}),e.jsx("div",{className:"absolute top-40 right-16 w-1 h-1 bg-purple-400/20 rounded-full"}),e.jsx("div",{className:"absolute top-52 left-20 w-0.5 h-0.5 bg-pink-300/30 rounded-full animate-pulse",style:{animationDelay:"1s"}})]}),e.jsxs("div",{className:"relative overflow-hidden rounded-xl bg-[#0a0a0f] border border-white/5",children:[e.jsx("div",{className:"absolute inset-0 opacity-20 blur-sm",children:e.jsxs("div",{className:"p-3 space-y-2",children:[e.jsx("div",{className:"h-20 bg-white/10 rounded-lg"}),e.jsxs("div",{className:"grid grid-cols-3 gap-1.5",children:[e.jsx("div",{className:"h-12 bg-white/10 rounded"}),e.jsx("div",{className:"h-12 bg-white/10 rounded"}),e.jsx("div",{className:"h-12 bg-white/10 rounded"})]})]})}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-center py-6 px-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-white/10 border border-white/10 flex items-center justify-center mb-3",children:e.jsx(Z,{className:"w-5 h-5 text-white/70"})}),e.jsx("h3",{className:"text-base font-semibold text-white mb-1",children:t("profile.stats.proTitle")}),e.jsx("p",{className:"text-white/40 text-xs text-center mb-4 max-w-[240px]",children:t("profile.stats.proSubtitle")}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-4 w-full max-w-[260px]",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(We,{className:"w-4 h-4 text-white/30 mx-auto mb-0.5"}),e.jsx("span",{className:"text-white/30 text-[10px]",children:t("profile.stats.views")})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(Fe,{className:"w-4 h-4 text-white/30 mx-auto mb-0.5"}),e.jsx("span",{className:"text-white/30 text-[10px]",children:t("profile.stats.reach")})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(K,{className:"w-4 h-4 text-white/30 mx-auto mb-0.5"}),e.jsx("span",{className:"text-white/30 text-[10px]",children:t("profile.stats.audience")})]})]}),e.jsxs(n.button,{whileTap:{scale:.98},className:"px-4 py-2 bg-white/10 hover:bg-white/15 text-white text-sm font-medium rounded-lg border border-white/5 flex items-center gap-1.5 transition-colors",children:[e.jsx(J,{className:"w-3.5 h-3.5 text-yellow-500/70"}),e.jsx("span",{children:t("profile.stats.upgrade")})]}),e.jsx("p",{className:"text-white/25 text-[10px] mt-2",children:t("profile.stats.price")})]})]})]})]}),e.jsx(O,{children:j&&e.jsx(Le,{post:j,user:s,onBack:()=>_(null),onDeleted:ue,onUpdated:we})}),me&&e.jsx(Ae,{stories:y,startIndex:0,onClose:()=>V(!1)}),e.jsx(O,{children:ae&&e.jsxs(e.Fragment,{children:[e.jsx(n.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"fixed inset-0 bg-black/50 z-[100]",onClick:()=>v(!1)}),e.jsxs(n.div,{initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:25,stiffness:300},className:"fixed bottom-0 left-0 right-0 bg-[#0c0c0f] text-white rounded-t-3xl z-[101] safe-area-bottom border border-white/5 border-b-0 shadow-[0_-14px_40px_rgba(0,0,0,0.4)]",children:[e.jsx("div",{className:"flex justify-center pt-3 pb-2",children:e.jsx("div",{className:"w-10 h-1 bg-white/15 rounded-full"})}),e.jsxs("div",{className:"flex items-center justify-between px-4 pb-3 border-b border-white/10",children:[e.jsx("span",{className:"text-lg font-bold",children:t("profile.upload.sheetTitle")}),e.jsx(n.button,{whileTap:{scale:.9},onClick:()=>v(!1),className:"p-1",children:e.jsx(Se,{className:"w-6 h-6 text-white/70"})})]}),e.jsxs("div",{className:"py-2",children:[e.jsxs(n.button,{whileTap:{scale:.98,backgroundColor:"#f3f4f6"},onClick:be,className:"w-full flex items-center gap-4 px-4 py-4 active:bg-white/5 transition-colors",disabled:$,children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-pink-500 to-orange-400 rounded-full flex items-center justify-center shadow-lg shadow-pink-500/20",children:e.jsx(Be,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-semibold text-white",children:t($?"profile.upload.uploading":"profile.upload.profileImage")}),e.jsx("div",{className:"text-sm text-white/60",children:t("profile.upload.profileImageDesc")})]})]}),e.jsxs(n.button,{whileTap:{scale:.98,backgroundColor:"#f3f4f6"},onClick:D,className:"w-full flex items-center gap-4 px-4 py-4 active:bg-white/5 transition-colors",disabled:b,children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-500 to-blue-500 rounded-full flex items-center justify-center shadow-lg shadow-purple-500/25",children:e.jsx(ke,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-semibold text-white",children:t(b?"profile.upload.uploading":"profile.upload.addStory")}),e.jsx("div",{className:"text-sm text-white/60",children:t("profile.upload.addStoryDesc")})]})]}),e.jsxs(n.button,{whileTap:{scale:.98,backgroundColor:"#f3f4f6"},onClick:D,className:"w-full flex items-center gap-4 px-4 py-4 active:bg-white/5 transition-colors",disabled:b,children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-green-500 to-teal-400 rounded-full flex items-center justify-center shadow-lg shadow-green-500/20",children:e.jsx(te,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-semibold text-white",children:t(b?"profile.upload.uploading":"profile.upload.storyImage")}),e.jsx("div",{className:"text-sm text-white/60",children:t("profile.upload.storyImageDesc")})]})]}),e.jsxs(n.button,{whileTap:{scale:.98,backgroundColor:"#f3f4f6"},onClick:D,className:"w-full flex items-center gap-4 px-4 py-4 active:bg-white/5 transition-colors",disabled:b,children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-red-500 to-pink-500 rounded-full flex items-center justify-center shadow-lg shadow-red-500/20",children:e.jsx(se,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-semibold text-white",children:t(b?"profile.upload.uploading":"profile.upload.storyVideo")}),e.jsx("div",{className:"text-sm text-white/60",children:t("profile.upload.storyVideoDesc")})]})]})]}),e.jsx("div",{className:"px-4 pb-4 pt-2",children:e.jsx(n.button,{whileTap:{scale:.98},onClick:()=>v(!1),className:"w-full py-3 bg-white/10 rounded-xl font-semibold text-white",children:t("profile.upload.cancel")})})]})]})}),e.jsx(Re,{isOpen:re,onClose:()=>C(!1),userId:s.telegram_id,currentUserId:s.telegram_id,type:oe,onUserClick:i})]})}const Xe=/\.(mp4|webm|mov|m4v)(\?|$)/i;function Qe(s){return s.media_url?s.media_type&&s.media_type.toLowerCase().includes("video")?!0:Xe.test(s.media_url):!1}function ee({post:s}){const d=l.useRef(null),[c,x]=l.useState(!1),[i,t]=l.useState(!1),[r,m]=l.useState(!1),f=Ue(d,{minimumRatio:.25}),u=s.media_thumbnail||s.media_url,{isDataSaver:w}=He();return Ge(w?null:u),l.useEffect(()=>{f&&x(!0)},[f]),s.media_url?i?e.jsx("div",{ref:d,className:"w-full h-full flex items-center justify-center bg-white/5",children:e.jsxs("div",{className:"text-center",children:[e.jsx(te,{className:"w-6 h-6 text-white/30 mx-auto mb-1"}),e.jsx("p",{className:"text-[9px] text-white/30",children:"Failed to load"})]})}):e.jsxs("div",{ref:d,className:"w-full h-full relative",children:[(!c||!r)&&e.jsx("div",{className:"absolute inset-0 bg-white/5 animate-pulse"}),c&&e.jsxs(e.Fragment,{children:[Qe(s)?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:u||s.media_url,alt:"",className:`w-full h-full object-cover transition-opacity duration-200 ${r?"opacity-100":"opacity-0"}`,loading:"lazy",onLoad:()=>m(!0),onError:()=>t(!0)}),r&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute inset-0 pointer-events-none bg-gradient-to-t from-black/20 to-transparent"}),e.jsx("div",{className:"absolute top-1 right-1 bg-black/60 rounded-full p-1",children:e.jsx(se,{className:"w-3.5 h-3.5 text-white"})})]})]}):e.jsx("img",{src:u||s.media_url,alt:"",className:`w-full h-full object-cover transition-opacity duration-200 ${r?"opacity-100":"opacity-0"}`,loading:"lazy",onLoad:()=>m(!0),onError:()=>t(!0)}),r&&s.media_urls&&s.media_urls.length>1&&e.jsx("div",{className:"absolute top-1 right-1 bg-black/60 rounded-full px-1.5 py-0.5",children:e.jsx("span",{className:"text-[9px] text-white font-medium",children:s.media_urls.length})})]})]}):e.jsx("div",{ref:d,className:"w-full h-full flex items-center justify-center bg-white/5 p-3",children:e.jsx("p",{className:"text-[11px] text-white/70 text-center line-clamp-4",children:s.content})})}export{jt as default};
