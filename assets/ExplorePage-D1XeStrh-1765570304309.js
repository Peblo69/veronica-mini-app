const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ExploreReelsViewer-ULYWQQIE-1765570304309.js","assets/index-BJiOEdd2-1765570304309.js","assets/index-CsnARv6j-1765570304309.css","assets/PixelIcons-CzMJ4xcW-1765570304309.js","assets/CommentsSheet-3-t0mQKI-1765570304309.js","assets/loader-circle-5PlvWZlx-1765570304309.js","assets/x-BDHshRI--1765570304309.js","assets/heart-Cax_kdmn-1765570304309.js","assets/trash-2-C9UABq1q-1765570304309.js","assets/flag-VWpgqc1L-1765570304309.js","assets/play-DCHMmPLf-1765570304309.js","assets/arrow-left-Sp0xn_Hx-1765570304309.js","assets/send-CJVdPmKT-1765570304309.js","assets/volume-2-kXI0kc4o-1765570304309.js"])))=>i.map(i=>d[i]);
import{r as s,w as D,j as e,m as g,S as H,A as E,s as Q,u as $,l as B,_ as W}from"./index-BJiOEdd2-1765570304309.js";import{X}from"./x-BDHshRI--1765570304309.js";import{P as C}from"./play-DCHMmPLf-1765570304309.js";const Y=s.lazy(()=>W(()=>import("./ExploreReelsViewer-ULYWQQIE-1765570304309.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13])));function G({video:r,onClick:f}){const[n,o]=s.useState(!1),[i,a]=s.useState(!1),c=s.useRef(null),d=!!r.media_thumbnail;return e.jsxs(g.div,{ref:c,className:"relative aspect-[9/16] bg-[#1a1a1a] cursor-pointer overflow-hidden",whileTap:{scale:.98},onClick:f,children:[d&&!i&&e.jsx("img",{src:r.media_thumbnail,alt:"",className:`w-full h-full object-cover transition-opacity duration-200 ${n?"opacity-100":"opacity-0"}`,onLoad:()=>o(!0),onError:()=>a(!0),loading:"lazy"}),(!d||i)&&r.media_url&&e.jsx(J,{videoUrl:r.media_url}),!d&&!n&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-[#1a1a1a]",children:e.jsx("div",{className:"w-6 h-6 border-2 border-white/20 border-t-white/60 rounded-full animate-spin"})}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/20",children:e.jsx(C,{className:"w-8 h-8 text-white/80 fill-white/80"})}),e.jsxs("div",{className:"absolute bottom-2 left-2 flex items-center gap-1",children:[e.jsx(C,{className:"w-3 h-3 text-white fill-white"}),e.jsx("span",{className:"text-xs text-white font-medium",children:r.likes_count||0})]})]})}function J({videoUrl:r}){const[f,n]=s.useState(null),[o,i]=s.useState(!0);return s.useEffect(()=>{const a=document.createElement("video");a.crossOrigin="anonymous",a.preload="metadata",a.muted=!0,a.playsInline=!0;const c=document.createElement("canvas"),d=c.getContext("2d"),x=()=>{if(!d)return;c.width=a.videoWidth||320,c.height=a.videoHeight||568,d.drawImage(a,0,0,c.width,c.height);const u=c.toDataURL("image/jpeg",.7);n(u),i(!1),URL.revokeObjectURL(a.src)};a.onloadeddata=()=>{const u=Math.min(.5,a.duration*.1);a.currentTime=u},a.onseeked=x,a.onerror=()=>{i(!1),URL.revokeObjectURL(a.src)};const y=setTimeout(()=>{o&&i(!1)},5e3);return a.src=r,()=>{clearTimeout(y),a.src=""}},[r]),f?e.jsx("img",{src:f,alt:"",className:"w-full h-full object-cover"}):o?e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-[#1a1a1a]",children:e.jsx("div",{className:"w-6 h-6 border-2 border-white/20 border-t-white/60 rounded-full animate-spin"})}):e.jsx("div",{className:"w-full h-full bg-gradient-to-b from-gray-800 to-gray-900"})}function ee({user:r,onCreatorClick:f}){const[n,o]=s.useState([]),[i,a]=s.useState(!0),[c,d]=s.useState(null),[x,y]=s.useState(!0),u=s.useRef(null),N=s.useRef(null),[k,U]=s.useState(!1),[p,_]=s.useState(""),[S,j]=s.useState([]),[w,R]=s.useState(!1),L=s.useRef(null),T=s.useRef(null);s.useEffect(()=>{V()},[r.telegram_id]);const V=async(t=0)=>{t===0&&a(!0);const l=await D(r.telegram_id,30,t);o(t===0?l:m=>[...m,...l]),y(l.length===30),a(!1)},P=s.useCallback(()=>{!i&&x&&V(n.length)},[i,x,n.length]),F=t=>{_(t),T.current&&clearTimeout(T.current),t.trim().length>0?(R(!0),T.current=setTimeout(async()=>{const l=await Q(t.trim());j(l),R(!1)},300)):(j([]),R(!1))},O=()=>{U(!1),_(""),j([]),L.current?.blur()},I=t=>{O(),f(t)};s.useEffect(()=>(u.current&&u.current.disconnect(),u.current=new IntersectionObserver(t=>{t[0].isIntersecting&&x&&!i&&P()},{threshold:.1}),N.current&&u.current.observe(N.current),()=>u.current?.disconnect()),[P,x,i]);const z=t=>{d(t)},M=()=>{d(null)},A=async t=>{const l=n.find(b=>b.id===t);if(!l)return;const m=l.liked;o(b=>b.map(h=>h.id===t?{...h,liked:!m,likes_count:(h.likes_count||0)+(m?-1:1)}:h)),(m?await $(r.telegram_id,t):await B(r.telegram_id,t))||o(b=>b.map(h=>h.id===t?{...h,liked:m,likes_count:(h.likes_count||0)+(m?1:-1)}:h))};return i&&n.length===0?e.jsx("div",{className:"min-h-full bg-black flex items-center justify-center",children:e.jsx("div",{className:"w-10 h-10 border-3 border-white border-t-transparent rounded-full animate-spin"})}):e.jsxs("div",{className:"min-h-full bg-black pb-20",children:[e.jsxs("div",{className:"relative z-40 bg-black px-4 pt-2 pb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(g.div,{className:"flex-1 relative",animate:{marginRight:0},transition:{duration:.2,ease:"easeOut"},children:e.jsxs("div",{className:"relative flex items-center",children:[e.jsx(H,{className:"absolute left-3 w-4 h-4 text-gray-400 pointer-events-none"}),e.jsx("input",{ref:L,type:"text",placeholder:"Search",value:p,onChange:t=>F(t.target.value),onFocus:()=>U(!0),className:"w-full bg-[#262626] rounded-lg py-2 pl-10 pr-8 text-white placeholder-gray-500 text-sm outline-none border-0 focus:ring-0"}),p&&e.jsx("button",{onClick:()=>{_(""),j([]),L.current?.focus()},className:"absolute right-3 p-0.5 bg-gray-500 rounded-full",children:e.jsx(X,{className:"w-3 h-3 text-black"})})]})}),e.jsx(E,{children:k&&e.jsx(g.button,{initial:{opacity:0,x:20,width:0},animate:{opacity:1,x:0,width:"auto"},exit:{opacity:0,x:20,width:0},transition:{duration:.2,ease:"easeOut"},onClick:O,className:"text-white text-sm font-medium whitespace-nowrap overflow-hidden",children:"Cancel"})})]}),e.jsx(E,{children:k&&e.jsxs(g.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.15},className:"absolute left-0 right-0 top-full bg-black border-t border-gray-800/50 max-h-[60vh] overflow-y-auto",children:[w&&e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"w-6 h-6 border-2 border-white/30 border-t-white rounded-full animate-spin"})}),!w&&p&&S.length===0&&e.jsx("div",{className:"py-8 text-center text-gray-500 text-sm",children:"No results found"}),!w&&S.length>0&&e.jsx("div",{className:"py-2",children:S.map(t=>e.jsxs(g.button,{whileTap:{backgroundColor:"rgba(255,255,255,0.1)"},onClick:()=>I(t),className:"w-full flex items-center gap-3 px-4 py-2 hover:bg-white/5 transition-colors",children:[e.jsx("img",{src:t.avatar_url||"/default-avatar.png",alt:t.first_name||t.username||"User",className:"w-11 h-11 rounded-full object-cover bg-gray-800"}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"text-white font-medium text-sm",children:t.username||"user"}),e.jsxs("div",{className:"text-gray-400 text-xs",children:[t.first_name,t.last_name?` ${t.last_name}`:""]})]})]},t.telegram_id))}),!w&&!p&&e.jsx("div",{className:"py-8 text-center text-gray-500 text-sm",children:"Search for people"})]})})]}),e.jsx("div",{className:"grid grid-cols-3 gap-0.5 p-0.5",children:n.map((t,l)=>e.jsx("div",{ref:l===n.length-1?N:null,children:e.jsx(G,{video:t,onClick:()=>z(l)})},t.id))}),i&&n.length>0&&e.jsx("div",{className:"py-6 flex justify-center",children:e.jsx("div",{className:"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"})}),!i&&n.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 px-4",children:[e.jsx(C,{className:"w-16 h-16 text-gray-600 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"No Videos Yet"}),e.jsx("p",{className:"text-gray-400 text-center",children:"Be the first to upload a video!"})]}),e.jsx(E,{children:c!==null&&e.jsx(s.Suspense,{fallback:e.jsx("div",{className:"fixed inset-0 bg-black/90 flex items-center justify-center z-50",children:e.jsx("div",{className:"w-10 h-10 border-3 border-white border-t-transparent rounded-full animate-spin"})}),children:e.jsx(Y,{videos:n,initialIndex:c,onClose:M,onLike:A,onCreatorClick:f,user:r,onCommentCountUpdate:(t,l)=>{o(m=>m.map(v=>v.id===t?{...v,comments_count:l}:v))}})})})]})}export{ee as default};
