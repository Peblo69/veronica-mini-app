import{c as T,r as i,j as e,T as A,S,X as N,A as ae,m as te}from"./index-C8MCx-dO-1765319159791.js";import{S as le}from"./shield-Dot8o8-2-1765319159791.js";import{A as ne}from"./arrow-left-fMhltqcY-1765319159791.js";import{C as re}from"./chart-column-C0SHUV5a-1765319159791.js";import{U as C}from"./users-BSnT3MDI-1765319159791.js";import{F as b}from"./file-text-LXgxqSQN-1765319159791.js";import{S as ie}from"./settings-D24QdZHz-1765319159791.js";import{C as ce}from"./chevron-right-DahuTuGz-1765319159791.js";import{E as de}from"./eye-DibikbnV-1765319159791.js";import{C as P}from"./check-CACswgI--1765319159791.js";import{L as oe}from"./lock-DmKdr_kY-1765319159791.js";import{T as xe}from"./trash-2-Bs5OT2MO-1765319159791.js";import{B as me}from"./ban-D_ihRhHY-1765319159791.js";const he=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],pe=T("refresh-cw",he);const ge=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],U=T("user-check",ge),ue="https://eigfbxjheuwxmtdfnvqc.supabase.co/functions/v1/admin-api",je="10326296114e8840474f677a04a7f275347e4f44f7d0ed51b539049d28f51925";async function c(t){const l=await fetch(ue,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${je}`},body:JSON.stringify(t),credentials:"include"});if(l.status===204)return null;if(!l.ok){const a=await l.text();throw new Error(`Admin API (${l.status}): ${a||"Unknown error"}`)}return await l.json()}async function fe(t){return c({action:"check_admin",data:{telegramId:t}})}async function ye(t=1,l=20,a){return c({action:"list_users",data:{page:t,limit:l,search:a}})}async function Ne(t){return c({action:"user_details",data:{telegramId:t}})}async function be(t,l){return await c({action:"update_user",data:{telegramId:t,updates:l}}),!0}async function ve(t,l,a){return await c({action:"ban_user",data:{telegramId:t,reason:l,adminId:a}}),!0}async function we(t=1,l=20,a){return c({action:"list_posts",data:{page:t,limit:l,filters:a}})}async function _e(t,l,a){return await c({action:"hide_post",data:{postId:t,reason:l,adminId:a}}),!0}async function ke(t){return await c({action:"delete_post",data:{postId:t}}),!0}async function Ae(t){return c({action:"list_applications",data:{status:t}})}async function Se(t,l){return await c({action:"approve_application",data:{applicationId:t,userId:l}}),!0}async function Ce(t,l,a){return await c({action:"reject_application",data:{applicationId:t,userId:l,reason:a}}),!0}async function Pe(){return c({action:"platform_stats"})}function Ye({telegramId:t,onExit:l}){const[a,D]=i.useState(null),[L,$]=i.useState(!0),[d,v]=i.useState("dashboard"),[o,I]=i.useState(null),[E,R]=i.useState([]),[j,B]=i.useState(0),[x,F]=i.useState(1),[m,M]=i.useState(""),[r,g]=i.useState(null),[w,q]=i.useState([]),[p,O]=i.useState("pending"),[Y,H]=i.useState([]),[V,z]=i.useState(0),[_,K]=i.useState(1);i.useEffect(()=>{G()},[]);const G=async()=>{const s=await fe(t);s&&(D(s),k()),$(!1)},k=async()=>{const s=await Pe();I(s)},h=async(s=1,n)=>{const{users:y,total:se}=await ye(s,20,n);R(y),B(se),F(s)},u=async s=>{const n=await Ae(s);q(n)},f=async(s=1)=>{const{posts:n,total:y}=await we(s);H(n),z(y),K(s)},J=async s=>{const n=await Ne(s.telegram_id);g(n)},W=async(s,n)=>{a&&(await ve(s,n,a.id),h(x,m),g(null))},X=async s=>{await Se(s.id,s.user_id),u(p)},Q=async(s,n)=>{await Ce(s.id,s.user_id,n),u(p)},Z=async(s,n)=>{a&&(await _e(s,n,a.id),f(_))},ee=async s=>{confirm("Permanently delete this post? This cannot be undone.")&&(await ke(s),f(_))};return i.useEffect(()=>{a&&(d==="users"&&h(),d==="applications"&&u(p),d==="posts"&&f())},[d,a]),L?e.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:e.jsxs("div",{className:"text-white text-center",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{children:"Verifying admin access..."})]})}):a?e.jsxs("div",{className:"min-h-screen bg-gray-900 text-white",children:[e.jsxs("header",{className:"bg-gray-800 border-b border-gray-700 px-4 py-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:l,className:"p-2 hover:bg-gray-700 rounded-lg",children:e.jsx(ne,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"font-bold text-lg",children:"Admin Panel"}),e.jsxs("p",{className:"text-xs text-gray-400",children:["Logged in as ",a.username," (",a.role,")"]})]})]}),e.jsx("button",{onClick:k,className:"p-2 hover:bg-gray-700 rounded-lg",children:e.jsx(pe,{className:"w-5 h-5"})})]}),e.jsx("nav",{className:"bg-gray-800 px-2 py-2 flex gap-1 overflow-x-auto border-b border-gray-700",children:[{id:"dashboard",label:"Dashboard",icon:re},{id:"users",label:"Users",icon:C},{id:"applications",label:"Applications",icon:b},{id:"posts",label:"Posts",icon:b},{id:"settings",label:"Settings",icon:ie}].map(s=>e.jsxs("button",{onClick:()=>v(s.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium whitespace-nowrap transition-colors ${d===s.id?"bg-blue-600 text-white":"text-gray-400 hover:bg-gray-700"}`,children:[e.jsx(s.icon,{className:"w-4 h-4"}),s.label]},s.id))}),e.jsxs("main",{className:"p-4",children:[d==="dashboard"&&o&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Platform Overview"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-gray-800 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-400 text-sm mb-1",children:[e.jsx(C,{className:"w-4 h-4"}),"Total Users"]}),e.jsx("div",{className:"text-2xl font-bold",children:o.total_users}),e.jsxs("div",{className:"text-xs text-green-400",children:["+",o.new_users_today," today"]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-400 text-sm mb-1",children:[e.jsx(U,{className:"w-4 h-4"}),"Creators"]}),e.jsx("div",{className:"text-2xl font-bold",children:o.total_creators})]}),e.jsxs("div",{className:"bg-gray-800 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-400 text-sm mb-1",children:[e.jsx(b,{className:"w-4 h-4"}),"Total Posts"]}),e.jsx("div",{className:"text-2xl font-bold",children:o.total_posts})]}),e.jsxs("div",{className:"bg-gray-800 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-400 text-sm mb-1",children:[e.jsx(A,{className:"w-4 h-4"}),"Pending"]}),e.jsx("div",{className:"text-2xl font-bold text-yellow-400",children:o.pending_applications}),e.jsx("div",{className:"text-xs text-gray-400",children:"applications"})]})]}),o.pending_applications>0&&e.jsxs("button",{onClick:()=>v("applications"),className:"w-full p-4 bg-yellow-500/20 border border-yellow-500/30 rounded-xl flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(A,{className:"w-5 h-5 text-yellow-400"}),e.jsxs("span",{children:[o.pending_applications," pending application(s) need review"]})]}),e.jsx(ce,{className:"w-5 h-5"})]})]}),d==="users"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(S,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",value:m,onChange:s=>M(s.target.value),onKeyDown:s=>s.key==="Enter"&&h(1,m),placeholder:"Search users...",className:"w-full pl-10 pr-4 py-3 bg-gray-800 rounded-xl border border-gray-700 focus:border-blue-500 outline-none"})]}),e.jsx("button",{onClick:()=>h(1,m),className:"px-4 py-3 bg-blue-600 rounded-xl",children:e.jsx(S,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"text-sm text-gray-400",children:[j," users total"]}),e.jsx("div",{className:"space-y-2",children:E.map(s=>e.jsxs("div",{className:"bg-gray-800 rounded-xl p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:s.avatar_url||`https://i.pravatar.cc/150?u=${s.telegram_id}`,alt:"",className:"w-10 h-10 rounded-full object-cover"}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold flex items-center gap-2",children:[s.first_name,s.is_creator&&e.jsx("span",{className:"text-xs bg-purple-500 px-2 py-0.5 rounded",children:"Creator"}),s.is_verified&&e.jsx("span",{className:"text-xs bg-blue-500 px-2 py-0.5 rounded",children:"Verified"})]}),e.jsxs("div",{className:"text-sm text-gray-400",children:["@",s.username||s.telegram_id]})]})]}),e.jsx("button",{onClick:()=>J(s),className:"p-2 hover:bg-gray-700 rounded-lg",children:e.jsx(de,{className:"w-5 h-5"})})]},s.telegram_id))}),j>20&&e.jsxs("div",{className:"flex justify-center gap-2",children:[e.jsx("button",{onClick:()=>h(x-1,m),disabled:x===1,className:"px-4 py-2 bg-gray-800 rounded-lg disabled:opacity-50",children:"Previous"}),e.jsxs("span",{className:"px-4 py-2",children:["Page ",x]}),e.jsx("button",{onClick:()=>h(x+1,m),disabled:x*20>=j,className:"px-4 py-2 bg-gray-800 rounded-lg disabled:opacity-50",children:"Next"})]})]}),d==="applications"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex gap-2 overflow-x-auto",children:["pending","approved","rejected","all"].map(s=>e.jsx("button",{onClick:()=>{O(s==="all"?"":s),u(s==="all"?void 0:s)},className:`px-4 py-2 rounded-lg text-sm font-medium whitespace-nowrap ${p===s||p===""&&s==="all"?"bg-blue-600 text-white":"bg-gray-800 text-gray-400"}`,children:s.charAt(0).toUpperCase()+s.slice(1)},s))}),e.jsxs("div",{className:"space-y-3",children:[w.map(s=>e.jsxs("div",{className:"bg-gray-800 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:s.user?.avatar_url||`https://i.pravatar.cc/150?u=${s.user_id}`,alt:"",className:"w-10 h-10 rounded-full object-cover"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:s.legal_name}),e.jsxs("div",{className:"text-sm text-gray-400",children:["@",s.user?.username||s.user_id]})]})]}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${s.status==="pending"?"bg-yellow-500/20 text-yellow-400":s.status==="approved"?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:s.status})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm mb-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Type:"})," ",e.jsx("span",{className:s.content_type==="nsfw"?"text-red-400":"",children:s.content_type.toUpperCase()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"AI:"})," ",e.jsx("span",{children:s.is_ai_generated?"Yes":"No"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Country:"})," ",s.country]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Email:"})," ",s.email]})]}),e.jsxs("div",{className:"text-sm text-gray-400 mb-3",children:["Categories: ",s.content_categories?.join(", ")||"None"]}),s.status==="pending"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>X(s),className:"flex-1 py-2 bg-green-600 rounded-lg font-semibold flex items-center justify-center gap-2",children:[e.jsx(P,{className:"w-4 h-4"}),"Approve"]}),e.jsxs("button",{onClick:()=>{const n=prompt("Rejection reason:");n&&Q(s,n)},className:"flex-1 py-2 bg-red-600 rounded-lg font-semibold flex items-center justify-center gap-2",children:[e.jsx(N,{className:"w-4 h-4"}),"Reject"]})]})]},s.id)),w.length===0&&e.jsx("div",{className:"text-center text-gray-400 py-8",children:"No applications found"})]})]}),d==="posts"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-sm text-gray-400",children:[V," posts total"]}),e.jsx("div",{className:"space-y-3",children:Y.map(s=>e.jsxs("div",{className:"bg-gray-800 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:s.creator?.avatar_url||`https://i.pravatar.cc/150?u=${s.creator_id}`,alt:"",className:"w-8 h-8 rounded-full object-cover"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-sm",children:s.creator?.first_name||"Unknown"}),e.jsx("div",{className:"text-xs text-gray-400",children:new Date(s.created_at).toLocaleDateString()})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.is_nsfw&&e.jsx("span",{className:"text-xs bg-red-500 px-2 py-0.5 rounded",children:"NSFW"}),s.visibility!=="public"&&e.jsx("span",{className:"text-xs bg-purple-500 px-2 py-0.5 rounded",children:s.visibility})]})]}),s.content&&e.jsx("p",{className:"text-sm mb-3 line-clamp-3",children:s.content}),s.media_url&&e.jsx("img",{src:s.media_url,alt:"",className:"w-full h-32 object-cover rounded-lg mb-3"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>{const n=prompt("Reason for hiding:");n&&Z(s.id,n)},className:"flex-1 py-2 bg-yellow-600 rounded-lg text-sm font-medium flex items-center justify-center gap-2",children:[e.jsx(oe,{className:"w-4 h-4"}),"Hide"]}),e.jsxs("button",{onClick:()=>ee(s.id),className:"flex-1 py-2 bg-red-600 rounded-lg text-sm font-medium flex items-center justify-center gap-2",children:[e.jsx(xe,{className:"w-4 h-4"}),"Delete"]})]})]},s.id))})]}),d==="settings"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Admin Settings"}),e.jsxs("div",{className:"bg-gray-800 rounded-xl p-4",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Your Permissions"}),e.jsx("div",{className:"grid grid-cols-2 gap-2 text-sm",children:Object.entries(a.permissions).map(([s,n])=>e.jsxs("div",{className:"flex items-center gap-2",children:[n?e.jsx(P,{className:"w-4 h-4 text-green-400"}):e.jsx(N,{className:"w-4 h-4 text-red-400"}),e.jsx("span",{className:"text-gray-400",children:s.replace(/_/g," ")})]},s))})]}),e.jsxs("div",{className:"bg-gray-800 rounded-xl p-4",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Session Info"}),e.jsxs("div",{className:"text-sm text-gray-400 space-y-1",children:[e.jsxs("p",{children:["Telegram ID: ",a.telegram_id]}),e.jsxs("p",{children:["Role: ",a.role]}),e.jsxs("p",{children:["Last Login: ",a.last_login?new Date(a.last_login).toLocaleString():"First login"]})]})]})]})]}),e.jsx(ae,{children:r&&e.jsx(te.div,{className:"fixed inset-0 bg-black/80 z-50 overflow-y-auto",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:e.jsx("div",{className:"min-h-screen p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-2xl max-w-lg mx-auto",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[e.jsx("h3",{className:"font-bold text-lg",children:"User Details"}),e.jsx("button",{onClick:()=>g(null),className:"p-2 hover:bg-gray-700 rounded-lg",children:e.jsx(N,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("img",{src:r.user.avatar_url||`https://i.pravatar.cc/150?u=${r.user.telegram_id}`,alt:"",className:"w-16 h-16 rounded-full object-cover"}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-bold text-lg",children:[r.user.first_name," ",r.user.last_name]}),e.jsxs("p",{className:"text-gray-400",children:["@",r.user.username||r.user.telegram_id]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["ID: ",r.user.telegram_id]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[e.jsxs("div",{className:"bg-gray-700 rounded-lg p-3",children:[e.jsx("div",{className:"text-xl font-bold",children:r.posts?.length||0}),e.jsx("div",{className:"text-xs text-gray-400",children:"Posts"})]}),e.jsxs("div",{className:"bg-gray-700 rounded-lg p-3",children:[e.jsx("div",{className:"text-xl font-bold",children:r.followers?.length||0}),e.jsx("div",{className:"text-xs text-gray-400",children:"Followers"})]}),e.jsxs("div",{className:"bg-gray-700 rounded-lg p-3",children:[e.jsx("div",{className:"text-xl font-bold",children:r.following?.length||0}),e.jsx("div",{className:"text-xs text-gray-400",children:"Following"})]})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Balance"}),e.jsxs("span",{children:[r.user.balance," tokens"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Creator"}),e.jsx("span",{children:r.user.is_creator?"Yes":"No"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Verified"}),e.jsx("span",{children:r.user.is_verified?"Yes":"No"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Subscription Price"}),e.jsxs("span",{children:["$",r.user.subscription_price||0,"/mo"]})]})]}),e.jsxs("div",{className:"flex gap-2 pt-4 border-t border-gray-700",children:[e.jsxs("button",{onClick:()=>{const s=prompt("Ban reason:");s&&W(r.user.telegram_id,s)},className:"flex-1 py-3 bg-red-600 rounded-xl font-semibold flex items-center justify-center gap-2",children:[e.jsx(me,{className:"w-4 h-4"}),"Ban User"]}),e.jsxs("button",{onClick:()=>{be(r.user.telegram_id,{is_creator:!0,is_verified:!0}),alert("User is now a verified creator"),g(null),h(x,m)},className:"flex-1 py-3 bg-green-600 rounded-xl font-semibold flex items-center justify-center gap-2",children:[e.jsx(U,{className:"w-4 h-4"}),"Make Creator"]})]})]})]})})})})]}):e.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-2xl p-8 max-w-md w-full text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-500/20 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(le,{className:"w-8 h-8 text-red-500"})}),e.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:"Access Denied"}),e.jsx("p",{className:"text-gray-400 mb-6",children:"You don't have admin privileges."}),e.jsx("button",{onClick:l,className:"px-6 py-3 bg-gray-700 text-white rounded-xl font-semibold",children:"Go Back"})]})})}export{Ye as default};
