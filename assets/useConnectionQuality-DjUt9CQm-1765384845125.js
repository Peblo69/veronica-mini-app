import{c as v,r as f,a8 as j,a9 as N,aa as _,j as t,A as F,m as p,X as C,C as M,a4 as T,a6 as L}from"./index-DLh4T2OH-1765384845125.js";const B=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],E=v("grid-3x3",B);const S=[["path",{d:"m2 9 3-3 3 3",key:"1ltn5i"}],["path",{d:"M13 18H7a2 2 0 0 1-2-2V6",key:"1r6tfw"}],["path",{d:"m22 15-3 3-3-3",key:"4rnwn2"}],["path",{d:"M11 6h6a2 2 0 0 1 2 2v10",key:"2f72bc"}]],z=v("repeat-2",S);function P({isOpen:l,onClose:s,userId:d,currentUserId:o,type:a,onUserClick:c}){const[h,r]=f.useState([]),[u,g]=f.useState(!0);f.useEffect(()=>{l&&b()},[l,d,a]);const b=async()=>{g(!0);const e=a==="followers"?await j(d,200):await N(d,200),m=await Promise.all(e.map(async n=>{if(n.telegram_id===o)return{...n,isFollowedByMe:!1};const i=await _(o,n.telegram_id);return{...n,isFollowedByMe:i}}));r(m),g(!1)},y=async(e,m)=>{m.stopPropagation(),r(n=>n.map(i=>i.telegram_id===e.telegram_id?{...i,followLoading:!0}:i));try{e.isFollowedByMe?(await T(o,e.telegram_id),r(n=>n.map(i=>i.telegram_id===e.telegram_id?{...i,isFollowedByMe:!1,followLoading:!1}:i))):(await L(o,e.telegram_id),r(n=>n.map(i=>i.telegram_id===e.telegram_id?{...i,isFollowedByMe:!0,followLoading:!1}:i)))}catch(n){console.error("Follow/unfollow error:",n),r(i=>i.map(x=>x.telegram_id===e.telegram_id?{...x,followLoading:!1}:x))}},k=e=>{c&&(c(e),s())};return t.jsx(F,{children:l&&t.jsxs(t.Fragment,{children:[t.jsx(p.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"fixed inset-0 bg-black/70 backdrop-blur-sm z-[100]",onClick:s}),t.jsx(p.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{type:"spring",damping:25,stiffness:350},className:"fixed inset-0 z-[101] flex items-center justify-center p-4",onClick:s,children:t.jsxs("div",{className:"bg-[#1a1a1f] rounded-2xl w-full max-w-md overflow-hidden shadow-2xl border border-white/10",onClick:e=>e.stopPropagation(),children:[t.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b border-white/10",children:[t.jsx("span",{className:"text-lg font-semibold text-white capitalize",children:a}),t.jsx(p.button,{whileTap:{scale:.9},onClick:s,className:"w-9 h-9 flex items-center justify-center rounded-full bg-white/10 hover:bg-white/15 transition-colors",children:t.jsx(C,{className:"w-5 h-5 text-white"})})]}),t.jsx("div",{className:"overflow-y-auto max-h-[70vh] min-h-[200px]",children:u?t.jsx("div",{className:"p-4 space-y-3",children:[1,2,3,4,5].map(e=>t.jsxs("div",{className:"flex items-center gap-3 animate-pulse",children:[t.jsx("div",{className:"w-12 h-12 bg-white/10 rounded-full shrink-0"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"h-4 bg-white/10 rounded w-28 mb-1.5"}),t.jsx("div",{className:"h-3 bg-white/10 rounded w-20"})]}),t.jsx("div",{className:"w-20 h-8 bg-white/10 rounded-lg"})]},e))}):h.length===0?t.jsx("div",{className:"py-20 text-center",children:t.jsx("p",{className:"text-white/40 text-sm",children:a==="followers"?"No followers yet":"Not following anyone"})}):t.jsx("div",{className:"p-3 space-y-1",children:h.map(e=>t.jsxs("div",{className:"w-full flex items-center gap-3 px-3 py-3 rounded-xl hover:bg-white/5 active:bg-white/10 transition-colors cursor-pointer",onClick:()=>k(e),children:[t.jsx("img",{src:e.avatar_url||`https://i.pravatar.cc/150?u=${e.telegram_id}`,alt:e.first_name||"User",className:"w-12 h-12 rounded-full object-cover border border-white/10 shrink-0"}),t.jsxs("div",{className:"flex-1 text-left min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsxs("span",{className:"font-semibold text-white text-[15px] truncate",children:[e.first_name," ",e.last_name]}),e.is_verified&&t.jsx(M,{className:"w-4 h-4 text-blue-400 fill-blue-400 shrink-0"})]}),t.jsx("div",{className:"text-sm text-white/50 truncate",children:e.username?`@${e.username}`:e.is_creator?"Creator":"User"})]}),e.telegram_id!==o&&t.jsx(p.button,{whileTap:{scale:.95},onClick:m=>y(e,m),disabled:e.followLoading,className:`px-4 py-1.5 rounded-lg text-sm font-semibold transition-colors shrink-0 min-w-[90px] ${e.followLoading?"bg-white/10 text-white/50":e.isFollowedByMe?"bg-white/10 text-white hover:bg-white/15":"bg-blue-500 text-white hover:bg-blue-600"}`,children:e.followLoading?t.jsx("span",{className:"inline-block w-4 h-4 border-2 border-white/30 border-t-white/70 rounded-full animate-spin"}):e.isFollowedByMe?"Following":"Follow"})]},e.telegram_id))})})]})})]})})}function q(l){f.useEffect(()=>{if(typeof window>"u"||!l)return;const s=typeof window.requestIdleCallback=="function"?window.requestIdleCallback.bind(window):void 0,d=typeof window.cancelIdleCallback=="function"?window.cancelIdleCallback.bind(window):void 0;let o=!1,a=null,c=null;const h=()=>{if(o)return;const r=new Image;r.src=l};return s?a=s(()=>h()):c=window.setTimeout(h,250),()=>{o=!0,a!==null&&d&&d(a),c!==null&&window.clearTimeout(c)}},[l])}const w={effectiveType:"4g",saveData:!1,downlink:10};function $(){const[l,s]=f.useState(()=>{if(typeof navigator>"u")return w;const a=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return a?{effectiveType:a.effectiveType||w.effectiveType,saveData:a.saveData||!1,downlink:a.downlink||w.downlink}:w});f.useEffect(()=>{const a=navigator?.connection||navigator?.mozConnection||navigator?.webkitConnection;if(!a)return;const c=()=>{s({effectiveType:a.effectiveType||w.effectiveType,saveData:!!a.saveData,downlink:a.downlink||w.downlink})};return a.addEventListener?.("change",c),()=>a.removeEventListener?.("change",c)},[]);const d=l.effectiveType==="slow-2g"||l.effectiveType==="2g",o=l.saveData;return{...l,isSlow:d,isDataSaver:o}}export{P as F,E as G,z as R,q as a,$ as u};
