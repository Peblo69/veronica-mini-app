import{c as Qe,j as e,A as U,m as M,r as i,s as Ye,g as Ge,S as Je,a as Ke,b as Ze,t as me,d as et,e as tt,f as st,h as at,i as lt,k as it,l as rt,n as nt,o as ct,u as ot,p as dt,q as mt,v as ut,w as xt,x as ue}from"./index-DTtZHuyx-1765649695064.js";import{P as ht,a as ft,b as pt,c as bt,d as wt,V as gt}from"./PixelIcons-CH5mbWRZ-1765649695064.js";import{P as vt,u as jt}from"./PostDetail-B9bEwLHx-1765649695064.js";import{X as ee}from"./x-BgZVXPdQ-1765649695064.js";import{C as q,u as yt}from"./useInViewport-CSxDLOwf-1765649695064.js";import{C as Nt,E as _t}from"./CommentsSheet-CgylB2sE-1765649695064.js";import{L as K}from"./loader-circle-CbfM5WVx-1765649695064.js";import{C as be}from"./check-KUfAuKh3-1765649695064.js";import{S as kt}from"./send-BCGqmUBG-1765649695064.js";import{B as St,s as xe,a as W}from"./dialogs-wvpXHPwH-1765649695064.js";import{g as Ct,S as Pt}from"./storyApi-DyHBrUTz-1765649695064.js";import{u as Et}from"./useTranslation-D0LRfX5l-1765649695064.js";import{U as Mt}from"./users-DCylvxpL-1765649695064.js";import{S as X}from"./star-CbFeI7Yc-1765649695064.js";import{P as Tt}from"./pen-line-0Q1dR0T--1765649695064.js";import{T as Lt}from"./trash-2-C8LD09cd-1765649695064.js";import{C as Rt}from"./copy-BSsTZHmG-1765649695064.js";import{U as It}from"./user-x-gp4Xso6V-1765649695064.js";import{F as Ft}from"./flag-B__rPX3d-1765649695064.js";import{L as Dt}from"./lock-Dp-xblat-1765649695064.js";import{E as Vt}from"./eye-z1z7p-ip-1765649695064.js";import{C as Ot}from"./chart-column-ym1P6eJn-1765649695064.js";import{M as At}from"./message-circle-question-mark-BdPcMmFV-1765649695064.js";import{H as Ht}from"./heart-mQMPoB4H-1765649695064.js";import{P as $t}from"./play-kUPpxn-t-1765649695064.js";import{V as Ut}from"./volume-2-BMzPjquf-1765649695064.js";import{I as zt}from"./image-CLn6ZNnx-1765649695064.js";import"./arrow-left-D6OlJais-1765649695064.js";import"./chevron-left-XBwCUPPe-1765649695064.js";const Bt=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Wt=Qe("eye-off",Bt);function Xt({isOpen:r,onClose:x,title:p,users:s,loading:u,onUserClick:d}){return e.jsx(U,{mode:"sync",children:r&&e.jsxs(e.Fragment,{children:[e.jsx(M.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2,ease:"easeOut"},className:"fixed inset-0 bg-black/70 z-[9998]",onClick:x}),e.jsx(M.div,{initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"tween",duration:.3,ease:[.32,.72,0,1]},className:"fixed bottom-0 left-0 right-0 z-[9999] will-change-transform",style:{height:"55%"},children:e.jsxs("div",{className:"h-full bg-[#262626] rounded-t-[12px] overflow-hidden flex flex-col",children:[e.jsx("div",{className:"flex justify-center pt-3 pb-2",children:e.jsx("div",{className:"w-9 h-1 bg-[#555] rounded-full"})}),e.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-b border-[#363636]",children:[e.jsx("h3",{className:"text-base font-semibold text-white",children:p}),e.jsx("button",{onClick:x,className:"p-1.5 rounded-full bg-[#363636] active:bg-[#444]",children:e.jsx(ee,{className:"w-4 h-4 text-gray-400"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto bg-[#262626]",children:u?e.jsx("div",{className:"flex items-center justify-center py-10",children:e.jsx("div",{className:"w-6 h-6 border-2 border-gray-600 border-t-white rounded-full animate-spin"})}):s.length===0?e.jsx("div",{className:"flex flex-col items-center justify-center py-10 text-gray-500",children:e.jsx("p",{className:"text-sm",children:"No one yet"})}):e.jsx("div",{className:"py-1",children:s.map(m=>e.jsxs("button",{onClick:()=>d?.(m),className:"w-full flex items-center gap-3 px-4 py-3 active:bg-white/5",children:[e.jsxs("div",{className:"relative flex-shrink-0",children:[e.jsx("img",{src:m.avatar_url||`https://i.pravatar.cc/150?u=${m.telegram_id}`,alt:"",className:"w-11 h-11 rounded-full object-cover bg-[#333]"}),m.is_verified&&e.jsx("div",{className:"absolute -bottom-0.5 -right-0.5 bg-[#262626] rounded-full p-0.5",children:e.jsx(q,{className:"w-3.5 h-3.5 text-[#0095f6] fill-[#0095f6]"})})]}),e.jsxs("div",{className:"flex-1 text-left min-w-0",children:[e.jsx("span",{className:"font-semibold text-[15px] text-white truncate block",children:m.username||m.first_name||"User"}),m.first_name&&m.username&&e.jsxs("p",{className:"text-[13px] text-gray-500 truncate",children:[m.first_name," ",m.last_name||""]})]}),m.is_creator&&e.jsx("span",{className:"text-[11px] font-semibold text-[#0095f6] bg-[#0095f6]/10 px-2.5 py-1 rounded-full",children:"Creator"})]},m.telegram_id))})})]})})]})})}function qt({isOpen:r,onClose:x,post:p,currentUserId:s}){const[u,d]=i.useState([]),[m,j]=i.useState(""),[y,T]=i.useState([]),[R,C]=i.useState(!1),[P,_]=i.useState(!1),[f,w]=i.useState(null),[k,F]=i.useState(new Set),c=i.useRef(null),b=i.useRef(null);i.useEffect(()=>{r&&s&&E()},[r,s]),i.useEffect(()=>{r||(j(""),T([]),F(new Set))},[r]),i.useEffect(()=>{if(c.current&&clearTimeout(c.current),!m.trim()){T([]),C(!1);return}return C(!0),c.current=setTimeout(async()=>{const h=await Ye(m.trim(),20);T(h.filter(D=>D.telegram_id!==s)),C(!1)},300),()=>{c.current&&clearTimeout(c.current)}},[m,s]);const E=async()=>{_(!0);const h=await Ge(s);d(h),_(!1)},g=async h=>{if(!p||f!==null)return;const D=h.telegram_id;w(D);try{const I=await Ke(s,D,s);if(!I)throw new Error("Could not create conversation");const O=p.media_type==="video"?"video":"image";if(await Ze(I.id,s,p.media_url||"",O,p.media_thumbnail||void 0))F(A=>new Set([...A,D])),me.success(`Sent to ${h.first_name||h.username||"User"}`);else throw new Error("Failed to send")}catch(I){console.error("Share error:",I),me.error("Failed to share")}finally{w(null)}};if(!r)return null;const N=m.trim().length>0;return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-end justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:x}),e.jsxs("div",{ref:b,className:"relative w-full max-w-lg bg-[#1a1a1a] rounded-t-2xl max-h-[80vh] flex flex-col animate-slide-up",children:[e.jsx("div",{className:"flex justify-center pt-3 pb-2",children:e.jsx("div",{className:"w-10 h-1 bg-white/20 rounded-full"})}),e.jsxs("div",{className:"flex items-center justify-between px-4 pb-3 border-b border-white/10",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Share to"}),e.jsx("button",{onClick:x,className:"p-1.5 hover:bg-white/10 rounded-full transition-colors",children:e.jsx(ee,{className:"w-5 h-5 text-white/70"})})]}),e.jsx("div",{className:"px-4 py-3 border-b border-white/10",children:e.jsxs("div",{className:"relative",children:[e.jsx(Je,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-white/40"}),e.jsx("input",{type:"text",placeholder:"Search users...",value:m,onChange:h=>j(h.target.value),className:"w-full bg-white/10 text-white placeholder-white/40 rounded-full py-2.5 pl-10 pr-4 text-sm focus:outline-none focus:ring-2 focus:ring-sky-500/50"}),R&&e.jsx(K,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-white/40 animate-spin"})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto overscroll-contain",children:P&&!N?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(K,{className:"w-6 h-6 text-white/40 animate-spin"})}):N?e.jsx("div",{className:"py-2",children:y.length===0&&!R?e.jsx("p",{className:"text-center text-white/40 py-8 text-sm",children:"No users found"}):y.map(h=>e.jsx(he,{user:h,isSending:f===h.telegram_id,isSent:k.has(h.telegram_id),onShare:()=>g(h)},h.telegram_id))}):e.jsx("div",{className:"py-2",children:u.length===0?e.jsx("p",{className:"text-center text-white/40 py-8 text-sm",children:"No recent chats"}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"px-4 py-2 text-xs text-white/40 font-medium uppercase",children:"Recent"}),u.map(h=>h.other_user&&e.jsx(he,{user:h.other_user,isSending:f===h.other_user.telegram_id,isSent:k.has(h.other_user.telegram_id),onShare:()=>g(h.other_user)},h.id))]})})}),e.jsx("div",{className:"h-6"})]})]})}function he({user:r,isSending:x,isSent:p,onShare:s}){const u=r.first_name||r.username||"User";return e.jsxs("button",{onClick:s,disabled:x||p,className:"w-full flex items-center gap-3 px-4 py-3 hover:bg-white/5 active:bg-white/10 transition-colors disabled:opacity-50",children:[e.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden bg-gradient-to-br from-sky-400 to-purple-500 flex-shrink-0",children:r.avatar_url?e.jsx("img",{src:r.avatar_url,alt:"",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-white font-semibold text-lg",children:u.charAt(0).toUpperCase()})}),e.jsxs("div",{className:"flex-1 text-left min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"font-medium text-white truncate",children:u}),r.is_verified&&e.jsx("svg",{className:"w-4 h-4 text-sky-400 flex-shrink-0",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})]}),r.username&&e.jsxs("p",{className:"text-sm text-white/50 truncate",children:["@",r.username]})]}),e.jsx("div",{className:"flex-shrink-0",children:x?e.jsx(K,{className:"w-5 h-5 text-sky-400 animate-spin"}):p?e.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500/20 flex items-center justify-center",children:e.jsx(be,{className:"w-4 h-4 text-green-500"})}):e.jsx("div",{className:"w-8 h-8 rounded-full bg-sky-500/20 flex items-center justify-center",children:e.jsx(kt,{className:"w-4 h-4 text-sky-400"})})})]})}async function Qt(r){const{reporterId:x,reportedId:p,reportedType:s,reason:u,description:d}=r,{error:m}=await et.from("reports").insert({reporter_id:x,reported_id:p,reported_type:s,reason:u,description:d,status:"pending"});return m?(console.error("Failed to submit report:",m),{success:!1,error:m.message}):{success:!0}}async function Yt(r,x,p,s){return Qt({reporterId:r,reportedId:x.toString(),reportedType:"post",reason:p,description:s})}const fe=5,Gt=3,pe={midnight:"linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%)",ember:"linear-gradient(135deg, #2d1f1f 0%, #4a2020 50%, #6b2020 100%)",aurora:"linear-gradient(135deg, #1a2f1a 0%, #1a3a2a 50%, #0f4a3a 100%)",twilight:"linear-gradient(135deg, #2d1f3d 0%, #3d2050 50%, #4a1f6a 100%)",ocean:"linear-gradient(135deg, #0d1b2a 0%, #1b263b 50%, #274060 100%)",sunset:"linear-gradient(135deg, #3d2c29 0%, #5c3d31 50%, #7a4a3a 100%)"},Z=new Set;function J(r){Z.forEach(x=>{x!==r&&!x.paused&&x.pause()})}function Jt({url:r}){const[x,p]=i.useState(!1),[s,u]=i.useState(!1);return x?e.jsx("div",{className:"w-full flex items-center justify-center bg-white/5",style:{aspectRatio:"4/5"},children:e.jsxs("div",{className:"text-center",children:[e.jsx(zt,{className:"w-10 h-10 text-white/30 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-white/40",children:"Failed to load image"})]})}):e.jsxs("div",{className:"relative w-full",style:{aspectRatio:"4/5"},children:[!s&&e.jsx("div",{className:"absolute inset-0 bg-white/5 animate-pulse"}),e.jsx("img",{src:r,alt:"",loading:"lazy",className:`w-full h-full object-contain bg-black select-none transition-opacity duration-200 ${s?"opacity-100":"opacity-0"}`,onLoad:()=>u(!0),onError:()=>p(!0)})]})}function Kt({src:r,muted:x=!0,shouldPlay:p=!1,onMuteChange:s}){const u=i.useRef(null),d=i.useRef(null),m=yt(u,{minimumRatio:.5}),j=i.useRef(null),[y,T]=i.useState(!0),[R,C]=i.useState(!1),[P,_]=i.useState(!1);i.useEffect(()=>{const c=d.current;if(c)return Z.add(c),()=>{Z.delete(c)}},[]),i.useEffect(()=>{T(x)},[x]),i.useEffect(()=>{const c=d.current;if(!c)return;const b=p&&m;b&&c.paused?(J(c),c.play().catch(()=>{})):!b&&!c.paused&&c.pause()},[p,m]),i.useEffect(()=>{const c=d.current;if(!c)return;const b=()=>{C(!0),J(c)},E=()=>C(!1),g=()=>_(!0),N=()=>_(!1),h=()=>_(!1);return c.addEventListener("play",b),c.addEventListener("pause",E),c.addEventListener("waiting",g),c.addEventListener("playing",N),c.addEventListener("canplay",h),()=>{c.removeEventListener("play",b),c.removeEventListener("pause",E),c.removeEventListener("waiting",g),c.removeEventListener("playing",N),c.removeEventListener("canplay",h)}},[]);const f=()=>{const c=d.current;c&&(c.paused?(J(c),c.play().catch(()=>{})):c.pause())},w=c=>{const b=c.touches[0];j.current={x:b.clientX,y:b.clientY,time:Date.now()}},k=c=>{if(!j.current)return;const b=c.changedTouches[0],E=Math.abs(b.clientX-j.current.x),g=Math.abs(b.clientY-j.current.y),N=Date.now()-j.current.time;E<15&&g<15&&N<300&&(c.preventDefault(),f()),j.current=null},F=c=>{c.stopPropagation(),c.preventDefault();const b=!y;T(b),s?.(b),d.current&&(d.current.muted=b)};return e.jsxs("div",{ref:u,className:"relative w-full bg-gray-900 overflow-hidden",style:{aspectRatio:"4/5"},onTouchStart:w,onTouchEnd:k,onClick:f,children:[e.jsx("video",{ref:d,src:r,className:"w-full h-full object-cover",playsInline:!0,loop:!0,muted:y,preload:"auto",poster:""}),P&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none z-10",children:e.jsx("div",{className:"w-10 h-10 border-2 border-white/40 border-t-white rounded-full animate-spin"})}),!R&&!P&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none z-10",children:e.jsx("div",{className:"w-14 h-14 bg-black/50 rounded-full flex items-center justify-center",children:e.jsx($t,{className:"w-7 h-7 text-white fill-white ml-0.5"})})}),e.jsx("button",{onClick:F,onTouchEnd:c=>{c.stopPropagation(),j.current=null},className:"absolute bottom-4 left-4 w-9 h-9 bg-black/70 rounded-full flex items-center justify-center z-[999] active:scale-90 transition-transform backdrop-blur-sm",style:{touchAction:"manipulation"},children:y?e.jsx(gt,{className:"w-4 h-4 text-white"}):e.jsx(Ut,{className:"w-4 h-4 text-white"})})]})}function Zt({urls:r,canView:x,muted:p,onMuteChange:s,shouldPlay:u,onDoubleTap:d}){const[m,j]=i.useState(0),y=i.useRef(null),[T,R]=i.useState(!1),C=i.useRef(0),P=()=>{if(!y.current)return;const f=y.current.scrollLeft,w=y.current.offsetWidth,k=Math.round(f/w);k!==m&&j(k)},_=()=>{const f=Date.now();f-C.current<300&&(d?.(),R(!0),setTimeout(()=>R(!1),650)),C.current=f};return!x||r.length===0?null:e.jsxs("div",{className:"relative w-full bg-black rounded-2xl overflow-hidden",children:[e.jsx("div",{ref:y,className:"flex w-full h-full overflow-x-auto snap-x snap-mandatory scrollbar-hide",onScroll:P,style:{scrollbarWidth:"none",msOverflowStyle:"none"},onClick:_,children:r.map((f,w)=>e.jsx("div",{className:"flex-none w-full snap-center",children:f.match(/\.(mp4|webm|mov|m4v)(\?|$)/i)?e.jsx(Kt,{src:f,muted:p,onMuteChange:s,shouldPlay:u&&m===w}):e.jsx(Jt,{url:f})},w))}),e.jsx(U,{children:T&&e.jsx(M.div,{className:"absolute inset-0 flex items-center justify-center pointer-events-none",initial:{scale:.6,opacity:0},animate:{scale:1.1,opacity:.9},exit:{scale:.8,opacity:0},transition:{duration:.4},children:e.jsx(Ht,{className:"w-24 h-24 text-white fill-white drop-shadow-[0_8px_24px_rgba(0,0,0,0.35)]"})})}),r.length>1&&e.jsx("div",{className:"absolute bottom-3 left-1/2 -translate-x-1/2 flex gap-1.5 z-10",children:r.map((f,w)=>e.jsx("div",{className:`w-1.5 h-1.5 rounded-full transition-all ${w===m?"bg-white w-2.5":"bg-white/50"}`},w))}),r.length>1&&e.jsxs("div",{className:"absolute top-3 right-3 bg-black/60 text-white text-xs px-2 py-1 rounded-full z-10",children:[m+1,"/",r.length]})]})}function Ms({user:r,onCreatorClick:x,onSheetStateChange:p}){const{t:s}=Et(),[u,d]=i.useState([]),[m,j]=i.useState([]),[y,T]=i.useState(!0),[R,C]=i.useState(!0),[P,_]=i.useState(null),[f,w]=i.useState(null),[k,F]=i.useState(!1),[c,b]=i.useState(null),[E,g]=i.useState(null),[N,h]=i.useState(fe),D=i.useRef(null),I=i.useRef(new Map),O=i.useRef(null),[z,A]=i.useState(!1),[we,ge]=i.useState([]),[ve,te]=i.useState(!1),[se,ae]=i.useState(null),[Q,le]=i.useState(!1),[je,ye]=i.useState(null),[Ne,_e]=i.useState(void 0),[B,ke]=i.useState([]),[Se,ie]=i.useState(!1),[Ce,Pe]=i.useState(0),[Y,re]=i.useState(!1),[Ee,ne]=i.useState(null);i.useEffect(()=>{p?.(Q||z||Y||!!f||E!==null||!!c)},[Q,z,Y,f,E,c,p]),i.useEffect(()=>{Me(),Te()},[]),i.useEffect(()=>{const t=tt({onNewPost:a=>{d(l=>[{...a,liked:!1,saved:!1,can_view:!0},...l]),h(l=>l+1)},onPostUpdated:a=>{d(l=>l.map(o=>o.id===a.id?{...o,...a}:o))},onPostDeleted:a=>{d(l=>l.filter(o=>o.id!==a))},onLikeAdded:(a,l)=>{l!==r.telegram_id&&d(o=>o.map(n=>n.id===a?{...n,likes_count:(n.likes_count||0)+1}:n))},onLikeRemoved:(a,l)=>{l!==r.telegram_id&&d(o=>o.map(n=>n.id===a?{...n,likes_count:Math.max(0,(n.likes_count||0)-1)}:n))},onCommentAdded:(a,l)=>{d(o=>o.map(n=>n.id===a?{...n,comments_count:l}:n))}});return()=>t()},[r.telegram_id]);const Me=async()=>{try{const[t,a,l]=await Promise.all([st(r.telegram_id),at(6,r.telegram_id),lt(r.telegram_id)]),o=new Set(l),n=t.filter(v=>!o.has(v.id));d(n),h(Math.min(n.length,fe)),j(a)}catch(t){console.error("[Home] loadData failed",t)}finally{T(!1)}},Te=async()=>{try{const{stories:t}=await Ct();ke(t||[])}catch(t){console.error("[Home] loadStories failed",t)}},Le=async(t,a)=>{if(se!==t.id&&t.poll_user_vote===void 0){ae(t.id);try{const l=await xt(t.id,a,r.telegram_id);l.data&&!l.error&&d(o=>o.map(n=>n.id===t.id?{...n,poll_votes:l.data.poll_votes,poll_total_votes:l.data.poll_total_votes,poll_user_vote:l.data.poll_user_vote}:n))}catch(l){console.error("Poll vote failed:",l)}finally{ae(null)}}},ce=async t=>{if(!t.can_view)return;const a=!t.liked,l=a?1:-1;d(o=>o.map(n=>n.id===t.id?{...n,liked:a,likes_count:Math.max(0,(n.likes_count||0)+l)}:n));try{a?await ct(r.telegram_id,t.id):await ot(r.telegram_id,t.id)}catch(o){d(n=>n.map(v=>v.id===t.id?{...v,liked:!a,likes_count:Math.max(0,(v.likes_count||0)-l)}:v)),console.warn("Like action failed",o)}},Re=async t=>{const a=!t.saved;d(l=>l.map(o=>o.id===t.id?{...o,saved:a}:o));try{a?await dt(r.telegram_id,t.id):await mt(r.telegram_id,t.id)}catch(l){d(o=>o.map(n=>n.id===t.id?{...n,saved:!a}:n)),console.warn("Save action failed",l)}},Ie=async t=>{if((t.likes_count||0)===0)return;A(!0),te(!0);const a=await ut(t.id);ge(a),te(!1)},G=async t=>{ye(t.id),_e(t.creator_id),le(!0)},Fe=async t=>{F(!0),await jt(r.telegram_id,t.id,async()=>{try{const a={id:t.id,unlock_price:t.unlock_price,is_purchased:!0,creator_id:t.creator_id};let l=t.media_url,o=t.media_urls;t.media_url&&(l=await ue(t.media_url,a,r.telegram_id)),t.media_urls&&t.media_urls.length>0&&(o=await Promise.all(t.media_urls.map(n=>ue(n,a,r.telegram_id)))),d(u.map(n=>n.id===t.id?{...n,can_view:!0,is_purchased:!0,media_url:l,media_urls:o}:n))}catch(a){console.error("Failed to fetch signed URL after purchase:",a),d(u.map(l=>l.id===t.id?{...l,can_view:!0,is_purchased:!0}:l))}w(null),F(!1)},a=>{console.error("Payment failed:",a),F(!1)})},De=()=>{c&&(d(u.filter(t=>t.id!==c.id)),b(null))},Ve=t=>{d(u.map(a=>a.id===t.id?t:a))},Oe=async t=>{if(!await xe(s("feed.confirm.deletePost")))return;(await it(t.id,t.creator_id)).success?d(u.filter(o=>o.id!==t.id)):await W(s("feed.errors.deleteFailed")),g(null)},Ae=async t=>{d(u.filter(l=>l.id!==t.id)),g(null),await rt(r.telegram_id,t.id)||console.error("[HomePage] Failed to persist hidden post to Supabase")},He=async t=>{const l=window.prompt(s("feed.report.promptReason"),s("feed.report.defaultReason"))?.trim();if(!l){g(null);return}const o=window.prompt(s("feed.report.promptDescription"))?.trim(),n=await Yt(r.telegram_id,t.id,l,o||void 0);n.success?alert(s("feed.report.success")):alert(s("feed.report.error",{error:n.error||s("feed.errors.tryAgain")})),g(null)},$e=async t=>{const l=`Post by @${t.creator?.username||t.creator?.first_name||"creator"} #${t.id}`;navigator.clipboard.writeText(l),await W(s("feed.linkCopied")),g(null)},Ue=async t=>{if(!await xe(s("feed.confirm.blockUser",{user:t.creator?.username||s("feed.userFallback")})))return;await nt(r.telegram_id,t.creator_id)?(d(o=>o.filter(n=>n.creator_id!==t.creator_id)),j(o=>o.filter(n=>n.telegram_id!==t.creator_id)),await W(s("feed.blockedSuccess"))):await W(s("feed.errors.blockFailed")),g(null)};i.useEffect(()=>{const t=D.current;if(!t||N>=u.length)return;const a=new IntersectionObserver(l=>{l[0]?.isIntersecting&&h(o=>o>=u.length?o:Math.min(u.length,o+Gt))},{rootMargin:"240px 0px"});return a.observe(t),()=>a.disconnect()},[N,u.length]);const H=i.useMemo(()=>u.slice(0,N),[u,N]);i.useEffect(()=>{if(O.current&&O.current.disconnect(),P===null&&H.length>0){const o=H.find(n=>n.media_url?.match(/\.(mp4|webm|mov|m4v)(\?|$)/i)||n.media_urls?.some(v=>v.match(/\.(mp4|webm|mov|m4v)(\?|$)/i)));_(o?o.id:H[0].id)}const t=document.querySelector("main"),a=[0,.1,.2,.3,.4,.5,.6,.7,.8,.9,1],l=new IntersectionObserver(o=>{let n=null,v=0;I.current.forEach((S,V)=>{const L=S.getBoundingClientRect(),qe=window.innerHeight,de=Math.max(0,Math.min(L.bottom,qe)-Math.max(L.top,0))/L.height;de>v&&(v=de,n=V)});for(const S of o){const V=S.target.dataset.postId,L=V?Number(V):null;L&&S.isIntersecting&&S.intersectionRatio>v&&(v=S.intersectionRatio,n=L)}n!==null&&n!==P&&_(n)},{root:t||void 0,threshold:a,rootMargin:"-10% 0px -10% 0px"});return I.current.forEach(o=>l.observe(o)),O.current=l,()=>{l.disconnect()}},[H,P]);const ze=t=>{const a=Date.now()-new Date(t).getTime(),l=Math.floor(a/36e5);return l<1?s("feed.time.justNow"):l<24?s("feed.time.hours",{count:l}):s("feed.time.days",{count:Math.floor(l/24)})},Be=t=>e.jsxs("div",{className:"bg-black pb-2 border-b border-gray-800/50",children:[e.jsxs("div",{className:"flex items-center justify-between px-3 py-1.5",children:[e.jsxs("button",{className:"flex items-center gap-3",onClick:()=>t.creator&&x(t.creator),children:[e.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden border border-gray-700",children:e.jsx("img",{src:t.creator?.avatar_url||"https://i.pravatar.cc/150?u="+t.creator_id,alt:"",className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-semibold text-sm text-white",children:t.creator?.username||s("feed.userFallback")}),t.creator?.is_verified&&e.jsx(q,{className:"w-3.5 h-3.5 text-blue-500 fill-blue-500"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:a=>{a.stopPropagation(),g(E===t.id?null:t.id)},className:"p-2 text-white",children:e.jsx(_t,{className:"w-5 h-5"})}),e.jsx(U,{children:E===t.id&&e.jsxs(e.Fragment,{children:[e.jsx(M.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-40",onClick:()=>g(null)}),e.jsxs(M.div,{initial:{opacity:0,scale:.9,y:-10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:-10},className:"absolute right-0 top-full mt-2 z-50 min-w-[180px] rounded-2xl overflow-hidden shadow-2xl py-2",style:{background:"rgba(30, 30, 30, 0.85)",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)",border:"1px solid rgba(255, 255, 255, 0.1)"},onClick:a=>a.stopPropagation(),children:[Number(t.creator_id)===Number(r.telegram_id)&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>{b(t),g(null)},className:"w-full px-4 py-3 text-left text-sm text-white hover:bg-white/10 flex items-center gap-3 transition-colors",children:[e.jsx(Tt,{className:"w-4 h-4 text-white/70"})," ",s("feed.actions.edit")]}),e.jsxs("button",{onClick:()=>Oe(t),className:"w-full px-4 py-3 text-left text-sm text-red-400 hover:bg-white/10 flex items-center gap-3 transition-colors",children:[e.jsx(Lt,{className:"w-4 h-4"})," ",s("feed.actions.delete")]}),e.jsx("div",{className:"h-px bg-white/10 mx-3 my-1"})]}),e.jsxs("button",{onClick:()=>$e(t),className:"w-full px-4 py-3 text-left text-sm text-white hover:bg-white/10 flex items-center gap-3 transition-colors",children:[e.jsx(Rt,{className:"w-4 h-4 text-white/70"})," ",s("feed.actions.copyLink")]}),e.jsxs("button",{onClick:()=>Ae(t),className:"w-full px-4 py-3 text-left text-sm text-white hover:bg-white/10 flex items-center gap-3 transition-colors",children:[e.jsx(Wt,{className:"w-4 h-4 text-white/70"})," ",s("feed.actions.notInterested")]}),Number(t.creator_id)!==Number(r.telegram_id)&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-px bg-white/10 mx-3 my-1"}),e.jsxs("button",{onClick:()=>Ue(t),className:"w-full px-4 py-3 text-left text-sm text-white hover:bg-white/10 flex items-center gap-3 transition-colors",children:[e.jsx(It,{className:"w-4 h-4 text-white/70"})," ",s("feed.actions.block")]}),e.jsxs("button",{onClick:()=>He(t),className:"w-full px-4 py-3 text-left text-sm text-red-400 hover:bg-white/10 flex items-center gap-3 transition-colors",children:[e.jsx(Ft,{className:"w-4 h-4"})," ",s("feed.actions.report")]})]})]})]})})]})]}),t.media_url&&t.can_view?e.jsx("div",{className:"w-full bg-black rounded-2xl overflow-hidden border border-white/5","data-post-id":t.id,ref:a=>{a?I.current.set(t.id,a):I.current.delete(t.id)},children:e.jsx(Zt,{urls:t.media_urls&&t.media_urls.length>0?t.media_urls:[t.media_url],canView:t.can_view,muted:R,onMuteChange:C,shouldPlay:P===t.id,onDoubleTap:()=>ce(t)})}):t.media_url?e.jsxs("div",{className:"relative bg-gray-900 text-white aspect-[4/5] flex flex-col items-center justify-center text-center overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-20"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-900/40 via-gray-900 to-gray-900"}),e.jsxs("div",{className:"relative z-10 p-8 w-full max-w-md mx-auto",children:[e.jsx("div",{className:"w-20 h-20 mx-auto rounded-3xl bg-white/5 border border-white/10 flex items-center justify-center mb-6 backdrop-blur-xl shadow-2xl shadow-purple-500/10 rotate-3 hover:rotate-0 transition-transform duration-500",children:e.jsx(Dt,{className:"w-8 h-8 text-white/90 drop-shadow-lg"})}),e.jsx("h3",{className:"text-2xl font-bold mb-3 tracking-tight",children:We(t)}),e.jsx("p",{className:"text-white/60 mb-8 leading-relaxed",children:s("feed.lock.subtitle",{name:t.creator?.first_name})}),t.unlock_price>0?e.jsxs(M.button,{className:"w-full py-4 bg-gradient-to-r from-yellow-400 to-orange-500 text-black rounded-2xl font-bold text-[15px] shadow-[0_0_30px_-5px_rgba(251,191,36,0.4)] flex items-center justify-center gap-2 hover:opacity-90 transition-opacity relative overflow-hidden group",whileTap:{scale:.98},onClick:()=>w(t),children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"}),e.jsx(X,{className:"w-5 h-5 fill-current"}),s("feed.lock.unlockFor",{amount:Math.ceil(t.unlock_price)})]}):e.jsx(M.button,{className:"w-full py-4 bg-white text-white rounded-2xl font-bold text-[15px] shadow-[0_0_30px_-5px_rgba(255,255,255,0.3)] flex items-center justify-center gap-2 hover:bg-gray-900 transition-colors",whileTap:{scale:.98},onClick:()=>t.creator&&x(t.creator),children:t.visibility==="followers"?e.jsxs(e.Fragment,{children:[e.jsx(Vt,{className:"w-5 h-5"})," ",s("feed.lock.followToView")]}):e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"w-5 h-5"})," ",s("feed.lock.subscribeToView")]})})]})]}):null,e.jsxs("div",{className:"px-3 py-1.5",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{className:"active:scale-90 transition-transform",onClick:()=>ce(t),children:e.jsx(ht,{className:`w-6 h-6 ${t.liked?"text-red-500":"text-white"}`,filled:t.liked})}),e.jsx("button",{className:"active:scale-90 transition-transform",onClick:()=>G(t),children:e.jsx(ft,{className:"w-6 h-6 text-white"})}),e.jsx("button",{className:"active:scale-90 transition-transform",onClick:()=>{ne(t),re(!0)},children:e.jsx(pt,{className:"w-6 h-6 text-white"})})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>Re(t),className:"active:scale-90 transition-transform",children:e.jsx(bt,{className:"w-6 h-6 text-white",filled:t.saved})}),e.jsxs("button",{className:"flex flex-col items-center active:scale-90 transition-transform",onClick:()=>{},children:[e.jsx(wt,{className:`w-6 h-6 ${(t.gifts_count||0)>0?"text-sky-400":"text-yellow-400"}`,filled:(t.gifts_count||0)>0}),(t.gifts_count||0)>0&&e.jsx("span",{className:"text-[9px] font-bold text-sky-400 -mt-0.5",children:t.gifts_count})]})]})]}),(t.likes_count||0)>0&&e.jsx("button",{className:"block mt-2",onClick:()=>Ie(t),children:e.jsx("span",{className:"text-sm font-semibold text-white",children:s("feed.likesCount",{count:t.likes_count||0})})}),t.post_type==="poll"&&t.poll_options?e.jsxs("div",{className:"mt-3",children:[t.content&&e.jsx("div",{className:"mb-3",children:e.jsxs("span",{className:"text-sm text-white",children:[e.jsx("span",{className:"font-semibold mr-1",children:t.creator?.username||s("feed.userFallback")}),t.content]})}),e.jsx("div",{className:"space-y-2",children:t.poll_options.map((a,l)=>{const o=t.poll_votes?.[l]||0,n=t.poll_total_votes||0,v=n>0?Math.round(o/n*100):0,S=t.poll_user_vote!==void 0,V=t.poll_user_vote===l,L=t.poll_ends_at&&new Date(t.poll_ends_at)<new Date;return e.jsxs("button",{onClick:()=>!S&&!L&&Le(t,l),disabled:S||L||se===t.id,className:`w-full relative overflow-hidden rounded-xl transition-all ${S||L?"cursor-default":"hover:bg-white/10 active:scale-[0.98]"}`,style:{background:"rgba(255, 255, 255, 0.05)",border:V?"2px solid rgba(255, 255, 255, 0.3)":"1px solid rgba(255, 255, 255, 0.1)"},children:[S&&e.jsx(M.div,{initial:{width:0},animate:{width:`${v}%`},transition:{duration:.5,ease:"easeOut"},className:"absolute inset-y-0 left-0 bg-white/10"}),e.jsxs("div",{className:"relative px-4 py-3 flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-white flex items-center gap-2",children:[V&&e.jsx(be,{className:"w-4 h-4 text-green-400"}),a]}),S&&e.jsxs("span",{className:"text-sm font-semibold text-white/70",children:[v,"%"]})]})]},l)})}),e.jsxs("div",{className:"mt-2 flex items-center gap-3 text-xs text-white/40",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ot,{className:"w-3 h-3"}),t.poll_total_votes||0," votes"]}),t.poll_ends_at&&e.jsx("span",{children:new Date(t.poll_ends_at)<new Date?"Poll ended":`Ends ${new Date(t.poll_ends_at).toLocaleDateString()}`})]})]}):t.background_gradient&&pe[t.background_gradient]?e.jsx("div",{className:"mt-3 rounded-2xl p-6 min-h-[120px] flex items-center justify-center",style:{background:pe[t.background_gradient]},children:e.jsxs("div",{className:"text-center",children:[t.post_type==="question"&&e.jsx(At,{className:"w-6 h-6 text-white/60 mx-auto mb-2"}),e.jsx("p",{className:"text-white text-lg font-medium leading-relaxed",children:t.content}),e.jsxs("p",{className:"text-white/50 text-xs mt-3",children:["â€” ",t.creator?.username||s("feed.userFallback")]})]})}):t.content&&e.jsx("div",{className:"mt-2",children:e.jsxs("span",{className:"text-sm text-white",children:[e.jsx("span",{className:"font-semibold mr-1",children:t.creator?.username||s("feed.userFallback")}),t.content]})}),t.comments_count>0&&e.jsx("button",{className:"block mt-2",onClick:()=>G(t),children:e.jsx("span",{className:"text-sm text-gray-400",children:s("feed.viewComments",{count:t.comments_count})})}),e.jsxs("button",{className:"flex items-center gap-2 mt-2 w-full",onClick:()=>G(t),children:[e.jsx("img",{src:r.avatar_url||"https://i.pravatar.cc/150?u="+r.telegram_id,className:"w-6 h-6 rounded-full object-cover",alt:""}),e.jsx("span",{className:"text-sm text-gray-500",children:s("feed.addComment")})]}),e.jsx("div",{className:"mt-0.5",children:e.jsx("span",{className:"text-[10px] text-gray-500 uppercase",children:ze(t.created_at)})})]})]},t.id),We=t=>t.unlock_price>0&&!t.is_purchased?s("feed.lock.unlockFor",{amount:Math.ceil(t.unlock_price)}):t.is_nsfw&&!t.is_subscribed?s("feed.lock.nsfw"):t.visibility==="subscribers"&&!t.is_subscribed?s("feed.lock.subscribers"):t.visibility==="followers"&&!t.is_following&&!t.is_subscribed?s("feed.lock.followers"):s("feed.lock.default");if(y)return e.jsx("div",{className:"bg-black min-h-screen p-4 space-y-4",children:[1,2,3].map(t=>e.jsxs("div",{className:"rounded-2xl border border-white/5 bg-[#0a0b0f] p-4 animate-pulse shadow-[0_14px_40px_rgba(0,0,0,0.35)]",children:[e.jsxs("div",{className:"flex gap-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 bg-white/10 rounded-full"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-4 bg-white/10 rounded w-24 mb-2"}),e.jsx("div",{className:"h-3 bg-white/10 rounded w-16"})]})]}),e.jsx("div",{className:"h-48 bg-white/10 rounded-xl"})]},t))});const[Xe,oe]=i.useState(!0),$=i.useRef(null);return i.useEffect(()=>{const t=document.querySelector("main");if(!t)return;const a=()=>{oe(!1),$.current&&clearTimeout($.current),$.current=setTimeout(()=>oe(!0),150)};return t.addEventListener("scroll",a,{passive:!0}),()=>{t.removeEventListener("scroll",a),$.current&&clearTimeout($.current)}},[]),e.jsxs("div",{className:"bg-black max-w-lg mx-auto relative pb-16",children:[e.jsx("div",{className:`fixed top-0 left-0 right-0 z-50 transition-opacity duration-200 ${Xe?"opacity-100":"opacity-0 pointer-events-none"}`,style:{paddingTop:"max(50px, env(safe-area-inset-top, 0px))"},children:e.jsxs("div",{className:"flex items-center justify-between px-4 py-2 max-w-lg mx-auto",children:[e.jsx("h1",{className:"text-xl font-bold bg-gradient-to-r from-[#00D4FF] to-purple-500 bg-clip-text text-transparent drop-shadow-lg",children:"Veronica"}),e.jsx("div",{className:"flex items-center gap-1",children:e.jsx("button",{className:"p-2 rounded-full bg-black/30 backdrop-blur-sm active:bg-white/10 transition-colors relative",children:e.jsx(St,{className:"w-5 h-5 text-white drop-shadow-lg"})})})]})}),B.length>0&&e.jsxs("div",{className:"border-b border-gray-800 py-3 px-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-[13px] font-semibold text-white",children:s("feed.stories.title")}),e.jsx("span",{className:"text-[12px] text-white/60",children:B.length})]}),e.jsx("div",{className:"flex gap-3 overflow-x-auto pb-1",children:B.map((t,a)=>e.jsxs("button",{onClick:()=>{Pe(a),ie(!0)},className:"flex flex-col items-center min-w-[64px] gap-1 focus:outline-none",children:[e.jsx("div",{className:"w-[62px] h-[62px] rounded-full p-[2px] bg-gradient-to-tr from-blue-500 via-purple-500 to-pink-500",children:e.jsx("div",{className:"w-full h-full rounded-full p-[2px] bg-black",children:e.jsx("img",{src:t.user?.avatar_url||`https://i.pravatar.cc/150?u=${t.user_id}`,alt:"",className:"w-full h-full rounded-full object-cover"})})}),e.jsx("span",{className:"text-[11px] text-white/80 truncate max-w-[68px]",children:t.user?.first_name||t.user?.username||`@user${t.user_id}`})]},t.id))})]}),m.length>0&&e.jsxs("div",{className:"border-b border-gray-800 py-4 px-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("span",{className:"text-[14px] font-semibold text-gray-500",children:s("feed.suggested.title")}),e.jsx("button",{className:"text-[13px] font-semibold text-white",children:s("feed.suggested.seeAll")})]}),e.jsx("div",{className:"flex gap-4 overflow-x-auto no-scrollbar pb-1",children:m.map(t=>e.jsxs("div",{className:"min-w-[100px] flex flex-col items-center",children:[e.jsxs("button",{onClick:()=>x(t),className:"flex flex-col items-center",children:[e.jsxs("div",{className:"relative mb-2",children:[e.jsx("img",{src:t.avatar_url||`https://i.pravatar.cc/150?u=${t.telegram_id}`,className:"w-16 h-16 rounded-full object-cover border-2 border-white/10",alt:t.first_name}),t.is_verified&&e.jsx("div",{className:"absolute bottom-0 right-0 bg-black rounded-full p-[2px]",children:e.jsx(q,{className:"w-3.5 h-3.5 text-blue-500 fill-blue-500"})})]}),e.jsx("span",{className:"text-[12px] font-medium text-white truncate w-full text-center max-w-[90px]",children:t.username||t.first_name})]}),e.jsx("button",{onClick:()=>x(t),className:"mt-2 px-4 py-1 bg-blue-500 text-white text-[11px] font-semibold rounded-md",children:s("feed.actions.follow")})]},t.telegram_id))})]}),e.jsx("div",{className:"bg-black",children:u.length===0?e.jsxs("div",{className:"px-4 py-16 text-center",children:[e.jsx("div",{className:"w-16 h-16 border-2 border-white rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Mt,{className:"w-8 h-8 text-white"})}),e.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:s("feed.empty.title")}),e.jsx("p",{className:"text-sm text-gray-400",children:s("feed.empty.subtitle")})]}):e.jsxs("div",{children:[H.map(t=>Be(t)),N<u.length&&e.jsx("div",{ref:D,className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"})})]})}),e.jsx(U,{children:f&&e.jsx(M.div,{className:"fixed inset-0 bg-black/80 backdrop-blur-md flex items-center justify-center z-[60] p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>!k&&w(null),children:e.jsxs(M.div,{className:"bg-[#1c1c1e] rounded-[2rem] p-6 max-w-sm w-full shadow-2xl border border-white/10",initial:{scale:.9,y:30,opacity:0},animate:{scale:1,y:0,opacity:1},exit:{scale:.9,y:30,opacity:0},transition:{type:"spring",duration:.5},onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:s("feed.purchase.title")}),e.jsx("button",{onClick:()=>!k&&w(null),className:"p-1 rounded-full hover:bg-white/10 transition-colors",children:e.jsx(ee,{className:"w-6 h-6 text-gray-400"})})]}),e.jsxs("div",{className:"text-center mb-8 relative",children:[e.jsx("div",{className:"absolute inset-0 bg-yellow-500/20 blur-3xl rounded-full"}),e.jsx("div",{className:"relative w-20 h-20 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg",children:e.jsx(X,{className:"w-10 h-10 text-white fill-white"})}),e.jsx("p",{className:"text-gray-400 text-sm font-medium mb-2",children:s("feed.purchase.payWithStars")}),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(X,{className:"w-6 h-6 text-yellow-400 fill-yellow-400"}),e.jsx("span",{className:"text-4xl font-bold text-white tracking-tight",children:Math.ceil(f.unlock_price)})]})]}),e.jsx("div",{className:"bg-white/5 rounded-2xl p-4 mb-6 border border-white/10",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:f.creator?.avatar_url||`https://i.pravatar.cc/150?u=${f.creator_id}`,className:"w-10 h-10 rounded-full object-cover",alt:""}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-white font-medium",children:f.creator?.first_name||f.creator?.username}),e.jsx("p",{className:"text-gray-500 text-sm",children:s("feed.purchase.creatorShare")})]})]})}),e.jsx(M.button,{className:"w-full py-4 rounded-2xl font-bold text-[15px] flex items-center justify-center gap-2 shadow-lg transition-all bg-gradient-to-r from-yellow-400 to-orange-500 text-black",whileHover:{scale:1.02,y:-1},whileTap:{scale:.98},onClick:()=>Fe(f),disabled:k,children:k?e.jsx("div",{className:"w-5 h-5 border-2 border-black/30 border-t-black rounded-full animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(X,{className:"w-5 h-5 fill-current"}),s("feed.purchase.payAmount",{amount:Math.ceil(f.unlock_price)})]})}),e.jsx("p",{className:"text-center text-gray-500 text-xs mt-4",children:s("feed.purchase.poweredBy")})]})})}),e.jsx(U,{children:c&&e.jsx(vt,{post:c,user:r,onBack:()=>b(null),onDeleted:De,onUpdated:Ve})}),Se&&e.jsx(Pt,{stories:B,startIndex:Ce,onClose:()=>ie(!1)}),e.jsx(Xt,{isOpen:z,onClose:()=>A(!1),title:s("feed.likesTitle"),users:we,loading:ve,onUserClick:t=>{A(!1),x(t)}}),e.jsx(Nt,{isOpen:Q,onClose:()=>le(!1),postId:je,postCreatorId:Ne,user:r}),e.jsx(qt,{isOpen:Y,onClose:()=>{re(!1),ne(null)},post:Ee,currentUserId:r.telegram_id})]})}export{Ms as default};
